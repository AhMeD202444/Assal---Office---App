<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Phone Parts Pro</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">


    <style>



/* تنسيق الدائرة العائمة */
.floating-new-btn {
    position: fixed;
    bottom: 50px; /* تقليل الارتفاع ليكون أقرب إلى الفوتر */
    left: 20px; /* الجهة اليمنى كما هي */
    width: 50px;
    height: 50px;
    background: linear-gradient(45deg, #43cea2, #185a9d);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    font-family: 'Cairo', sans-serif;
    font-size: 16px;
    font-weight: bold;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    cursor: pointer;
    z-index: 1000;
    user-select: none;
}

/* شارة عدد العناصر الجديدة */
.new-items-count {
    position: absolute;
    top: -5px;
    right: -5px;
    background: #FF416C;
    color: #fff;
    font-size: 12px;
    font-weight: bold;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
}

/* تنسيق النافذة المنبثقة للعناصر الجديدة */
/* تنسيق النافذة المنبثقة للعناصر الجديدة */
#newItemsModal {
    position: fixed;
    top: 50px; /* أسفل الهيدر (40px + 10px مسافة) */
    bottom: 60px; /* أعلى الفوتر (~50px + 10px مسافة) */
    left: 50%;
    transform: translateX(-50%);
    width: calc(100% - 20px); /* عرض الواجهة مع 10px مسافة من اليمين واليسار */
    max-width: 800px; /* الحد الأقصى للعرض للشاشات الكبيرة */
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(30, 30, 30, 0.8));
    backdrop-filter: blur(15px);
    border-radius: 5px;
    padding: 25px;
    z-index: 10000;
    display: none;
    flex-direction: column;
    align-items: center;
}

#newItemsModal h2 {
    font-size: 28px;
    font-family: 'Cairo', sans-serif;
    color: #fff;
    background: linear-gradient(45deg, #43cea2, #185a9d);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 25px;
    text-align: center;
    text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
}

#newItemsModal .modal-content {
    width: 100%;
    height: 100%; /* شغل كل الارتفاع المتاح */
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

/* إخفاء مسطرة السكرول مع السماح بالتمرير */
#newItemsModal .modal-content::-webkit-scrollbar {
    display: none; /* إخفاء المسطرة على متصفحات Webkit (مثل Chrome وSafari) */
}

/* إخفاء المسطرة على متصفحات أخرى (مثل Firefox) */
#newItemsModal .modal-content {
    -ms-overflow-style: none; /* لـ Internet Explorer و Edge */
    scrollbar-width: none; /* لـ Firefox */
}

#newItemsModal .modal-content .new-item-card {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(0, 0, 0, 0.5));
    border-radius: 12px;
    padding: 12px;
    display: flex;
    align-items: center;
    gap: 12px;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
    position: relative;
    border: 1px solid rgba(67, 206, 162, 0.3);
}

/* تنسيق الدائرة التي تحل محل الصورة */
#newItemsModal .modal-content .new-item-card .category-circle {
    width: 60px;
    height: 60px;
    background: linear-gradient(45deg, #8B0000, #B22222); /* أحمر غامق متدرج */
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: none; /* إزالة الحدود الملونة */
    font-family: 'Cairo', sans-serif;
    font-size: 12px;
    font-weight: bold;
    color: #fff;
    text-align: center;
    line-height: 1.2;
    padding: 5px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
}

#newItemsModal .modal-content .new-item-card .item-details {
    flex: 1;
    text-align: left;
    color: #fff;
    font-family: 'Cairo', sans-serif;
    position: relative;
    padding-top: 22px; /* زيادة الحشوة لخفض النص أكثر وتجنب التداخل */
    overflow-wrap: break-word; /* السماح بالتفاف النصوص الطويلة */
}

#newItemsModal .modal-content .new-item-card .item-details .new-badge {
    position: absolute;
    top: -5px;
    right: -5px;
    background: linear-gradient(45deg, #8B0000, #B22222); /* أحمر غامق */
    color: #fff;
    font-size: 12px; /* حجم نص أكبر للوضوح */
    font-weight: bold;
    padding: 5px 10px; /* حشوة أكبر لمظهر أوضح */
    border-radius: 10px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
}

#newItemsModal .modal-content .new-item-card .item-details h4 {
    font-size: 16px;
    margin: 0 0 6px 0;
    color: #fff;
    display: flex;
    align-items: center;
    gap: 8px;
    white-space: normal; /* السماح بالانتقال إلى سطر جديد */
    overflow-wrap: break-word; /* التفاف النصوص الطويلة */
    max-width: 100%; /* ضمان عدم التجاوز */
}

#newItemsModal .modal-content .new-item-card .item-details h4 i {
    font-size: 14px;
    color: #43cea2;
}

#newItemsModal .modal-content .new-item-card .item-details p {
    font-size: 14px;
    margin: 0;
    color: #dcdcdc;
    background: linear-gradient(45deg, #4682B4, #20B2AA);
    padding: 4px 8px;
    border-radius: 6px;
    display: inline-block;
}


#newItemsModal .close-modal-btn {
    position: absolute;
    top: 15px;
    right: 15px;
    background: linear-gradient(45deg, #FF416C, #FF4B2B);
    border: none;
    border-radius: 50%;
    width: 35px;
    height: 35px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    font-size: 18px;
    cursor: pointer;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
}

/* تأثيرات الدخول والخروج */
@keyframes slideDownModal {
    0% {
        transform: translate(-50%, -100%);
        opacity: 0;
    }
    100% {
        transform: translate(-50%, 0);
        opacity: 1;
    }
}

@keyframes slideUpModal {
    0% {
        transform: translate(-50%, 0);
        opacity: 1;
    }
    100% {
        transform: translate(-50%, -100%);
        opacity: 0;
    }
}



/* Media Queries للتوافق مع الشاشات الصغيرة */
@media (max-width: 480px) {
    #newItemsModal {
        top: 45px;
        bottom: 55px;
        width: calc(100% - 10px);
        padding: 15px;
        border-radius: 5; /* أو القيمة المطلوبة مثل 5px */
    }
    #newItemsModal h2 {
        font-size: 24px;
        margin-bottom: 15px;
    }
    #newItemsModal .modal-content .new-item-card {
        padding: 10px;
        gap: 10px;
    }
    #newItemsModal .modal-content .new-item-card .category-circle {
        width: 50px;
        height: 50px;
        font-size: 10px;
    }
    #newItemsModal .modal-content .new-item-card .item-details {
        padding-top: 18px; /* زيادة الحشوة لخفض النص وتجنب التداخل */
    }
    #newItemsModal .modal-content .new-item-card .item-details .new-badge {
        font-size: 10px; /* حجم نص أكبر للشاشات الصغيرة */
        padding: 4px 8px; /* حشوة أكبر للوضوح */
    }
    #newItemsModal .modal-content .new-item-card .item-details h4 {
        font-size: 14px;
        line-height: 1.4;
    }
    #newItemsModal .modal-content .new-item-card .item-details p {
        font-size: 12px;
        padding: 3px 6px;
    }
    #newItemsModal .close-modal-btn {
        width: 30px;
        height: 30px;
        font-size: 16px;
    }
}

/* Media Queries للشاشات المتوسطة (تابلت) */
@media (min-width: 481px) and (max-width: 768px) {
    #newItemsModal {
        top: 48px;
        bottom: 58px;
        width: calc(100% - 15px);
        padding: 20px;
        border-radius: 5; /* أو القيمة المطلوبة مثل 5px */
    }
    #newItemsModal h2 {
        font-size: 26px;
        margin-bottom: 20px;
    }
    #newItemsModal .modal-content .new-item-card {
        padding: 11px;
        gap: 11px;
    }
    #newItemsModal .modal-content .new-item-card .category-circle {
        width: 55px;
        height: 55px;
        font-size: 11px;
    }
    #newItemsModal .modal-content .new-item-card .item-details {
        padding-top: 19px; /* زيادة الحشوة لتجنب التداخل */
    }
    #newItemsModal .modal-content .new-item-card .item-details .new-badge {
        font-size: 11px; /* حجم وسطي */
        padding: 4px 9px;
    }
    #newItemsModal .modal-content .new-item-card .item-details h4 {
        font-size: 15px;
        line-height: 1.3;
    }
}


    /* تخصيص نافذة التفعيل */
/* تخصيص نافذة التفعيل */
.swal2-popup.activation-popup {
    background: rgba(0, 0, 0, 0.9);
    backdrop-filter: blur(20px);
    border-radius: clamp(15px, 3vw, 25px);
    width: clamp(80%, 90vw, 90%);
    max-width: 600px;
    padding: clamp(20px, 5vw, 40px);
    box-shadow: 0 0 60px rgba(70, 130, 180, 0.8), 0 0 20px rgba(255, 255, 255, 0.3);
    font-family: 'Cairo', sans-serif !important;
    color: #fff;
    text-align: center;
    z-index: 10000 !important;
    position: relative;
    animation: glow 2s infinite alternate;
}

@keyframes glow {
    0% { box-shadow: 0 0 20px rgba(70, 130, 180, 0.6), 0 0 40px rgba(255, 255, 255, 0.2); }
    100% { box-shadow: 0 0 30px rgba(70, 130, 180, 1), 0 0 60px rgba(255, 255, 255, 0.4); }
}

.swal2-popup.activation-popup .swal2-title {
    font-size: clamp(24px, 6vw, 32px);
    font-weight: bold;
    color: #fff;
    text-shadow: 0 2px 6px rgba(0, 0, 0, 0.8);
    margin-bottom: clamp(10px, 3vw, 20px);
    background: linear-gradient(135deg, #43cea2, #185a9d);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.swal2-popup.activation-popup .swal2-html-container {
    font-size: clamp(16px, 4vw, 20px);
    color: #dcdcdc;
    line-height: 1.6;
    margin: clamp(10px, 3vw, 20px) 0;
}

.swal2-popup.activation-popup .swal2-input {
    width: clamp(75%, 85vw, 85%);
    padding: clamp(10px, 3vw, 15px) clamp(15px, 4vw, 20px);
    font-size: clamp(14px, 4vw, 18px);
    color: #fff;
    background: rgba(255, 255, 255, 0.15);
    border: 2px solid rgba(255, 255, 255, 0.4);
    border-radius: clamp(8px, 2vw, 12px);
    box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.5);
    margin: clamp(10px, 3vw, 20px) auto;
    font-family: 'Cairo', sans-serif !important;
    transition: all 0.3s ease;
}

.swal2-popup.activation-popup .swal2-input:focus {
    border: 2px solid #43cea2;
    box-shadow: 0 0 12px #43cea2;
    background: rgba(255, 255, 255, 0.2);
}

.swal2-popup.activation-popup .swal2-confirm {
    background: linear-gradient(135deg, #43cea2, #185a9d);
    padding: clamp(8px, 2vw, 12px) clamp(20px, 5vw, 30px);
    font-size: clamp(14px, 4vw, 18px);
    border-radius: clamp(15px, 3vw, 25px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
    transition: all 0.3s ease;
}

.swal2-popup.activation-popup .swal2-cancel {
    background: linear-gradient(135deg, #FF416C, #FF4B2B);
    padding: clamp(8px, 2vw, 12px) clamp(20px, 5vw, 30px);
    font-size: clamp(14px, 4vw, 18px);
    border-radius: clamp(15px, 3vw, 25px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
    transition: all 0.3s ease;
}

.swal2-popup.activation-popup .swal2-confirm:hover,
.swal2-popup.activation-popup .swal2-cancel:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 16px rgba(255, 255, 255, 0.4);
}

.swal2-popup.activation-popup .swal2-confirm:active,
.swal2-popup.activation-popup .swal2-cancel:active {
    transform: scale(0.95);
    box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.6);
}

/* Media Queries للتوافق مع الأجهزة الصغيرة */
@media (max-width: 480px) {
    .swal2-popup.activation-popup {
        width: 95%;
        padding: 15px;
    }
    .swal2-popup.activation-popup .swal2-title {
        font-size: 20px;
    }
    .swal2-popup.activation-popup .swal2-html-container {
        font-size: 14px;
    }
    .swal2-popup.activation-popup .swal2-input {
        padding: 8px 12px;
        font-size: 14px;
    }
    .swal2-popup.activation-popup .swal2-confirm,
    .swal2-popup.activation-popup .swal2-cancel {
        padding: 8px 20px;
        font-size: 14px;
    }
}

/* Media Queries للأجهزة المتوسطة (تابلت) */
@media (min-width: 481px) and (max-width: 768px) {
    .swal2-popup.activation-popup {
        width: 90%;
        padding: 25px;
    }
    .swal2-popup.activation-popup .swal2-title {
        font-size: 26px;
    }
    .swal2-popup.activation-popup .swal2-html-container {
        font-size: 16px;
    }
    .swal2-popup.activation-popup .swal2-input {
        padding: 10px 15px;
        font-size: 16px;
    }
    .swal2-popup.activation-popup .swal2-confirm,
    .swal2-popup.activation-popup .swal2-cancel {
        padding: 10px 25px;
        font-size: 16px;
    }
}
    
     @keyframes shake {
    0%, 100% { transform: translate(0, 0); }
    25% { transform: translate(-4px, 4px) rotate(-3deg); }
    50% { transform: translate(4px, -4px) rotate(3deg); }
    75% { transform: translate(-4px, 4px) rotate(-3deg); }
}

@keyframes explode {
    0% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.6); opacity: 0.7; filter: blur(3px); }
    100% { transform: scale(2); opacity: 0; filter: blur(6px); }
}

@keyframes screenPop {
    0% { transform: scale(0) rotate(0deg); opacity: 0; box-shadow: none; }
    50% { transform: scale(1.1) rotate(360deg); opacity: 1; box-shadow: 0 0 20px rgba(70, 130, 180, 0.8), 0 0 40px rgba(70, 130, 180, 0.4); }
    100% { transform: scale(1) rotate(720deg); opacity: 1; box-shadow: 0 0 15px rgba(70, 130, 180, 0.6); }
}

@keyframes pulseGlow {
    0% { box-shadow: 0 0 15px rgba(70, 130, 180, 0.6); }
    50% { box-shadow: 0 0 25px rgba(70, 130, 180, 1), 0 0 40px rgba(70, 130, 180, 0.5); }
    100% { box-shadow: 0 0 15px rgba(70, 130, 180, 0.6); }
}

@keyframes textFadeIn {
    0% { opacity: 0; transform: translateY(10px); }
    100% { opacity: 1; transform: translateY(0); }
}

/* تعديل المسافات بين الشعار والهيدر وشريط الأخبار */
.notification-container {
    position: relative;
    width: 160px;
    height: 160px;
    margin: 0 auto 2px;
}



.notification {
    position: absolute;
    top: 0;
    left: 0;
    width: 160px; /* مطابقة حجم الشعار */
    height: 160px; /* مطابقة حجم الشعار */
    background: linear-gradient(45deg, #4682B4, #20B2AA);
    border: 3px solid #4682B4;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    opacity: 0;
    transform: scale(0);
    z-index: 2;
}

.notification.show {
    animation: screenPop 0.7s ease-out forwards, pulseGlow 1.5s infinite;
}

.notification-text {
    font-family: 'Tajawal', sans-serif;
    font-size: 18px; /* يمكنك زيادته إلى 20px إذا كان النص صغيرًا جدًا */
    font-weight: 700;
    color: #ffffff;
    text-shadow: 0 0 5px rgba(255, 255, 255, 0.8);
    padding: 10px;
    text-align: center;
    max-width: 140px; /* زيادة لتناسب الحجم الجديد */
    opacity: 0;
    letter-spacing: 1px;
}

.notification.show .notification-text {
    animation: textFadeIn 0.5s ease-out forwards;
    animation-delay: 0.7s;
}

.notification::before {
    content: '';
    position: absolute;
    top: -5px;
    left: -5px;
    right: -5px;
    bottom: -5px;
    background: linear-gradient(45deg, #4682B4, #20B2AA);
    filter: blur(10px);
    opacity: 0.7;
    z-index: -1;
    border-radius: 50%;
}

  

 @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-circle {
            width: 80px;
            height: 80px;
            border: 8px solid rgba(255, 255, 255, 0.2);
            border-top: 8px solid #43cea2;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
  

/* ✅ طبقة الـ Overlay مع تأثير شفافية */
#overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(10px);
    z-index: 9998;
    display: none;
    transition: opacity 0.3s ease-in-out;
}



@keyframes slideDown {
    0% {
        transform: translate(-50%, -100%);
        opacity: 0;
    }
    100% {
        transform: translate(-50%, -50%);
        opacity: 1;
    }
}

@keyframes slideUp {
    0% {
        transform: translate(-50%, -50%);
        opacity: 1;
    }
    100% {
        transform: translate(-50%, -120%);
        opacity: 0;
    }
}

/* ✅ نافذة إعلان مودرن */
#promoPopup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -100%); /* مهم حتى يشتغل slideDown/slideUp */
    width: min(420px, 92vw);
    background:
        radial-gradient(circle at top left, rgba(67, 206, 162, 0.15), transparent),
        rgba(15, 23, 42, 0.97); /* dark glassy */
    backdrop-filter: blur(18px);
    padding: 20px 18px 16px;
    border-radius: 18px;
    text-align: center;
    color: #e5e7eb;
    box-shadow: 0 18px 40px rgba(0, 0, 0, 0.85);
    display: none;
    flex-direction: column;
    gap: 12px;
    z-index: 9999;
}


#promoImage {
    width: 100%;
    max-width: 250px;
    border-radius: 15px;
    transition: transform 0.3s ease;
    cursor: pointer;
    overflow: hidden !important;
    clip-path: inset(0 0 0 0 round 15px) !important;
    object-fit: cover;
}

#promoImage:hover {
    transform: scale(1.05);
}

/* ✅ تحسين عنوان النافذة */
.popup-title {
    font-size: 26px;
    font-weight: bold;
    text-shadow: 0 0 30px rgba(255, 255, 255, 0.8);
    background: linear-gradient(135deg, #ffcc00, #ff0066);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

/* ✅ تحسين زر الإغلاق */
#closeBtn {
    padding: 12px 30px;
    font-size: 18px;
    font-weight: bold;
    color: white;
    background: linear-gradient(135deg, #ff0066, #ffcc00);
    border: none;
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 0 30px rgba(255, 0, 255, 0.7);
    animation: pulseEffect 2s infinite alternate;
    margin-top: 15px;
    overflow: hidden !important; /* قص أي محتوى أو تأثير خارج الحدود */
    clip-path: inset(0 0 0 0 round 25px) !important; /* قص صارم يطابق border-radius */
    font-family: 'Cairo', sans-serif !important; /* تغيير الخط إلى كايرو */
}

#closeBtn:hover {
    transform: scale(1.1);
    background: linear-gradient(45deg, #43cea2, #185a9d);
}

#closeBtn:active {
    transform: scale(0.95);
    background: linear-gradient(45deg, #43cea2, #185a9d);
    box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.5) !important; /* ظل داخلي فقط */
    clip-path: inset(0 0 0 0 round 25px) !important; /* تأكيد القص الدائري عند الضغط */
}



        /* Reset and basics */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

     body {
    font-family: 'Tajawal', sans-serif;
    background: linear-gradient(135deg, #3A6073, #16222A);
    color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    min-height: 100vh;
    padding: 40px 0 50px 0; /* علوية 40px للهيدر، سفلية 50px للفوتر */
    margin: 0;
    background-size: 400% 400%;
    animation: gradientAnimation 10s ease infinite;
}
        @keyframes gradientAnimation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        

     /* تعديل المسافات داخل container */
.container {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(0, 0, 0, 0.1));
    background-size: 400% 400%;
    animation: gradientAnimation 10s ease infinite;
    border-radius: 20px;
    padding: 20px 10px;
    text-align: center;
    width: 90%;
    max-width: 800px;
    margin: 10px auto 20px auto; /* زيادة المسافة السفلية إلى 30px */
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(10px);
    display: flex;
    flex-direction: column;
    gap: 8px;
}


@media (max-width: 768px) {
   .container {
        width: 95%;
        padding: 16px 8px; /* تقليل padding-top إلى 16px للشاشات المتوسطة */
        margin: 8px auto;
    }
    .search-container {
        margin: 8px 0 16px 0; /* تقليل margin-bottom إلى 16px للشاشات المتوسطة */
    }
    
}
    .results-container {
        max-width: 95%; /* ضبط العرض */
        padding: 8px; /* تقليل الحشوة */
        gap: 10px; /* تقليل المسافة بين العناصر */
    }

    .result-card {
        padding: 10px; /* تقليل الحشوة الداخلية */
    }
}

/* شاشات صغيرة (أقل من 480px) */
@media (max-width: 480px) {
  
      .container {
        width: 100%;
        padding: 12px 6px; /* تقليل padding-top إلى 12px للشاشات الصغيرة */
        margin: 6px auto;
    }
    .notification-container {
        width: 140px;
        height: 140px;
    }
    .search-container {
        margin: 8px 0 12px 0; /* تقليل margin-bottom إلى 12px للشاشات الصغيرة */
    }
    
}
    .categories {
        grid-template-columns: 1fr; /* تحويل الأعمدة إلى صف واحد */
        gap: 5px; /* تقليل المسافة بين الأزرار */
    }

    .result-card img {
        width: 50px; /* تقليل حجم الصور */
        height: 50px;
    }

    .search-container input {
        padding: 10px 40px 10px 10px; /* تعديل الحشوة لتناسب الشاشات الصغيرة */
    }

    .search-container button {
        width: 35px; /* تقليل حجم زر البحث */
        height: 35px;
        font-size: 14px;
    }
}



/* الشعار (Logo) */


.logo-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 160px;
    height: 160px;
    border-radius: 50%;
    overflow: hidden !important; /* قص التأثيرات */
    box-shadow: 0 4px 10px rgba(255, 255, 255, 0.2);
    cursor: pointer;
    z-index: 1;
    opacity: 1;
    transition: transform 0.3s ease;
    clip-path: circle(80px at center) !important; /* قص دائري يطابق نصف القطر */
}

.logo-container img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
    border-radius: 50%;
}

.logo-container:active {
    transform: scale(0.95) !important;
    box-shadow: inset 0 8px 16px rgba(0, 0, 0, 0.5) !important; /* ظل داخلي فقط */
    clip-path: circle(80px at center) !important; /* قص صارم */
}

.logo-container img:active {
    transform: scale(1) !important; /* منع الصورة من التأثر */
}
        
h1 {
    font-size: 36px;
    margin-bottom: 5px;
    color: white;
    text-shadow: 0 4px 10px rgba(255, 255, 255, 0.4);
    margin-top: 5px; /* أضف هذه الخاصية لتحديد المسافة من الشعار */
}


/* تقليل المسافة بين أزرار الفئات (أسعار بنمط الكروب، عدد الصيانة، التوافقات) */
.categories {
    display: flex;
    flex-direction: column;
    gap: 8px; /* تقليل المسافة من 15px إلى 10px لتقريب الأزرار */
    align-items: center;
    width: 100%;
}
    .category-btn {
        position: relative;
        overflow: hidden;
        height: 40px; /* تقليل ارتفاع الزر 
        padding-top: 4px; /* رفع النص قليلاً للأعلى */*/
        padding: 8px 16px;
        border-radius: 25px;
        background: rgba(0, 0, 0, 0.3);
        color: white;
        line-height: 40px; /* نفس ارتفاع الزر لتوسيط النص عموديًا */
        font-size: 16px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        transition: all 0.3s ease;
         gap: 10px; /* مسافة بين الأيقونة والنص */
         font-family: 'Cairo', sans-serif !important;
     
    }

    .category-btn:hover {
        transform: scale(1.1);
        background: linear-gradient(45deg, #43cea2, #185a9d);
    }

   .category-btn:active {
    transform: scale(0.95); /* تصغير خفيف بدون تمدد */
    background: linear-gradient(45deg, #43cea2, #185a9d);
    box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3); /* ظل داخلي بدلًا من خارجي */
}

   .new-category-btn, 
.category-btn, 
.tools-btn {
    width: 85%; /* جعل العرض موحد */
    max-width: 250px; /* نفس عرض زر أسعار بنمط الكروب

    
}


    
    .new-category-btn {
            grid-column: span 2; /* يجعل الزر يمتد على عمودين */
            position: relative;
            overflow: hidden;
            height: 40px; /* تقليل ارتفاع الزر 
            padding-top: 20px; /* رفع النص قليلاً للأعلى */*/
            padding: 8px 16px;
            border-radius: 25px;
            background: rgba(0, 0, 0, 0.3);
            color: white;
            line-height: 40px; /* نفس ارتفاع الزر لتوسيط النص عموديًا */
            font-size: 16px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            text-align: center;
             gap: 10px; /* مسافة بين الأيقونة والنص */
             font-family: 'Cairo', sans-serif !important;
        }

        .new-category-btn:hover {
            transform: scale(1.1);
            background: linear-gradient(45deg, #43cea2, #185a9d);
        }

      .new-category-btn:active {
    transform: scale(0.95);
    background: linear-gradient(45deg, #43cea2, #185a9d);
    box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3);
}
    
       .category-btn,
       .new-category-btn {
       display: flex;
       align-items: center;
       justify-content: center;
       margin-top: -2px; /* رفع النص قليلاً */
}



.slider-container {
    position: relative;
    width: 100%; /* ✅ نفس عرض شريط الأخبار */
    max-width: none; /* ✅ إزالة الحد الأقصى للعرض */
    overflow: hidden;
    background: rgba(255, 255, 255, 0.1);
    padding: 5px;
    border-radius: 15px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    display: flex;
    align-items: center;
     gap: 8px; /* تقليل المسافة بين الأزرار والسلايدر */
}

.slider {
    display: flex;
    gap: 8px;
    overflow-x: auto;
    scroll-behavior: smooth;
    padding: 5px;
    flex-grow: 1;
}

.slider::-webkit-scrollbar {
    display: none;
}



.category {
    flex: 0 0 auto;
    width: 70px; /* جعل العرض يساوي الارتفاع لتصبح دائرية */
    height: 70px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 50%; /* دائري بدلًا من بيضوي */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    text-align: center;
    padding: 6px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    position: relative;
    overflow: hidden !important; /* قص التأثيرات */
    clip-path: circle(35px at center) !important; /* قص دائري يطابق نصف القطر */
    font-weight: bold;
    color: white;
}

/* تأثير الأيقونة */
.category i {
    font-size: 24px;
    margin-bottom: 5px;
    transition: transform 0.3s ease;
}

/* تأثير الأيقونة عند التمرير */
.category:hover i {
    transform: rotate(10deg) scale(1.2);
}

/* النص داخل الزر */
.category span {
    font-size: 12px; /* تقليل حجم النص ليناسب الدائرة */
    white-space: nowrap;
    font-weight: bold;
}

/* تأثير عند التمرير */
.category:hover {
    transform: scale(1.1);
    background: linear-gradient(45deg, #43cea2, #185a9d);
    box-shadow: 0 4px 15px rgba(67, 206, 162, 0.5);
}

/* تأثير عند الضغط */
.category:active {
    transform: scale(0.95) !important;
    background: linear-gradient(45deg, #43cea2, #185a9d) !important;
    box-shadow: inset 0 6px 12px rgba(0, 0, 0, 0.7) !important; /* ظل داخلي فقط */
    clip-path: circle(35px at center) !important; /* قص دائري */
}

/* تأثير عند التحديد */
.category.active {
    background: linear-gradient(135deg, #004D40, #00796B);
    color: white;
    transform: scale(1.15);
    box-shadow: 0 6px 18px rgba(67, 206, 162, 0.7);
}



/* ✅ تأثير نبض عند التحديد */
@keyframes pulseEffect {
    0% { transform: scale(1.15); box-shadow: 0 0 10px rgba(67, 206, 162, 0.5); }
    50% { transform: scale(1.2); box-shadow: 0 0 20px rgba(67, 206, 162, 0.8); }
    100% { transform: scale(1.15); box-shadow: 0 0 10px rgba(67, 206, 162, 0.5); }
}







.slider-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(243, 156, 18, 0.4);
    border: none;
    color: white;
    padding: 8px;
    cursor: pointer;
    border-radius: 50%;
    font-size: 16px;
    width: 38px;
    height: 38px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    transition: transform 0.2s ease, background 0.2s ease, box-shadow 0.2s ease;
    z-index: 10;
    overflow: hidden !important; /* قص صارم */
    clip-path: circle(18px at center); /* دائرة أصغر قليلاً من نصف القطر (19px -> 18px) */
}

.slider-btn:hover {
    background: rgba(243, 156, 18, 0.8);
    transform: translateY(-50%) scale(1.2);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
}

.slider-btn:active {
    transform: translateY(-50%) scale(0.9) !important; /* تصغير قوي */
    background: rgba(243, 156, 18, 1) !important;
    box-shadow: none !important; /* إلغاء الظل الخارجي تمامًا */
    box-shadow: inset 0 6px 12px rgba(0, 0, 0, 0.7) !important; /* ظل داخلي قوي */
    clip-path: circle(18px at center) !important; /* قص دائري صارم */
}

.prev-btn {
    left: 5px;
}

.next-btn {
    right: 5px;
}


.search-container {
    position: relative;
    width: 100%;
    margin: 8px 0 20px 0; /* زيادة margin-bottom إلى 20px لتتساوى مع padding-top للـ container */
}

.search-container input {
    width: 100%;
    height: 40px; /* ارتفاع الشريط */
    padding: 8px 16px;
    font-size: 16px;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 25px;
    background: rgba(0, 0, 0, 0.3);
    color: white;
    outline: none;
    transition: all 0.3s ease;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

.search-container button {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    background: linear-gradient(45deg, #43cea2, #185a9d);
    border: none;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    color: white;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden !important; /* قص التأثيرات */
    clip-path: circle(15px at center) !important; /* قص دائري يطابق نصف القطر */
}

.search-container button:hover {
    transform: translateY(-50%) scale(1.1);
}

.search-container button:active {
    transform: translateY(-50%) scale(0.95) !important;
    box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.5) !important; /* ظل داخلي فقط */
    clip-path: circle(15px at center) !important; /* قص صارم */
}




/* تنسيق زر المسح */
.search-container .clear-btn {
    position: absolute;
    right: 50px; /* وضعه بجانب زر البحث (10px لزر البحث + 30px عرضه + 10px مسافة) */
    top: 50%;
    transform: translateY(-50%);
    background: linear-gradient(45deg, #FF416C, #FF4B2B); /* لون مغاير لتمييزه، يمكنك استخدام نفس لون زر البحث */
    border: none;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    color: white;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden !important;
    clip-path: circle(15px at center) !important; /* قص دائري مطابق لزر البحث */
}

.search-container .clear-btn:hover {
    transform: translateY(-50%) scale(1.1);
}

.search-container .clear-btn:active {
    transform: translateY(-50%) scale(0.95) !important;
    box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.5) !important;
    clip-path: circle(15px at center) !important;
}

/* تعديل padding حقل الإدخال لتجنب التداخل مع الأزرار */
.search-container input {
    padding-right: 90px; /* زيادة المسافة لاستيعاب زر المسح + زر البحث */
}

/* Media Queries للشاشات الصغيرة */
@media (max-width: 480px) {
    .search-container .clear-btn {
        right: 45px; /* تعديل الموقع */
        width: 35px; /* نفس حجم زر البحث */
        height: 35px;
        font-size: 14px;
    }
    .search-container input {
        padding-right: 85px; /* تعديل المسافة */
    }
}

/* Media Queries للشاشات المتوسطة */
@media (min-width: 481px) and (max-width: 768px) {
    .search-container .clear-btn {
        right: 48px;
        width: 32px;
        height: 32px;
        font-size: 15px;
    }
    .search-container input {
        padding-right: 88px;
    }
}







        /* تصميم الهيدر المستقيم */
/* تصميم الهيدر المستقيم */
.header {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 40px; /* تغيير من 35px إلى 40px ليطابق الفوتر */
    background: rgba(0, 0, 0, 0.8);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 12px;
    z-index: 2000;
}

/* نص مكتب عسل - في اليمين */
.header-title {
    font-family: 'Cairo', sans-serif;
    font-size: 18px;
    font-weight: 700;
    color: #A3BFFA; /* اللون الأصلي محتفظ به */
    text-shadow: 0 1px 2px rgba(163, 191, 250, 0.4);
    letter-spacing: 0.5px;
    order: 1; /* جعله في اليمين */
}

/* حاوية الأزرار - في اليسار */
.header-buttons {
    display: flex;
    gap: 6px;
    order: 0; /* جعل الأزرار في اليسار */
}

/* تصميم الأزرار */
.header-btn {
    padding: 3px 10px;
    border-radius: 8px;
    border: none;
    background: linear-gradient(135deg, #5A6388, #4A5275); /* لون افتراضي للأزرار */
    color: #fff;
    font-family: 'Cairo', sans-serif;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    overflow: hidden; /* قص التأثيرات الخارجة عن الحدود */
}

/* تأثيرات الضغط */
.header-btn:hover {
    transform: scale(1.1) rotate(5deg);
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.5);
}

.header-btn:active {
    transform: scale(0.95);
    box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.3);
}

/* زر تحديث */
.header-btn.refresh-btn {
    background: linear-gradient(135deg, #6B7280, #4B5563);
}

.header-btn.refresh-btn:hover {
    background: linear-gradient(135deg, #9CA3AF, #6B7280);
}

/* زر خروج - أحمر غامق */
.header-btn.exit-btn {
    background: linear-gradient(135deg, #8B0000, #B22222); /* أحمر غامق */
}

.header-btn.exit-btn:hover {
    background: linear-gradient(135deg, #CD5C5C, #8B0000); /* تفتيح عند التمرير */
}
        
        
.results {
    display: none;
    flex-direction: column;
    gap: 20px;
    margin-top: 10px;
    padding: 15px;
    background: rgba(0, 0, 0, 0.1);
    border-radius: 15px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    width: 100%;
    transform: translateZ(0); /* تسريع عتادي */
    will-change: display; /* تحسين تغيير الـ display */
}


.no-results {
    color: #ffffff;
    background: rgba(255, 255, 255, 0.1);
    padding: 10px 15px;
    border-radius: 10px;
    text-align: center;
    font-size: 16px;
    font-weight: 500;
    margin-top: 10px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
    width: 80%;
    margin-left: auto;
    margin-right: auto;
    animation: fadeIn 0.3s ease-in-out;
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
    overflow: hidden !important; /* قص التأثيرات */
    clip-path: inset(0 0 0 0 round 10px) !important; /* قص يطابق border-radius */
}

.no-results:active {
    transform: scale(0.95) !important;
    box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.5) !important; /* ظل داخلي فقط */
    background: rgba(255, 255, 255, 0.2) !important;
    clip-path: inset(0 0 0 0 round 10px) !important; /* قص صارم */
}


.result-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.5), rgba(50, 50, 50, 0.3));
    border-radius: 15px;
    padding: 20px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4), 0 0 10px rgba(255, 255, 255, 0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
    cursor: pointer;
    width: 90%;
    max-width: 450px;
    min-width: 250px;
    margin: 0 auto;
    position: relative;
    overflow: hidden !important; /* قص التأثيرات */
    clip-path: inset(0 0 0 0 round 15px) !important; /* قص يطابق border-radius */
    min-height: 200px;
}

.result-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5), 0 0 15px rgba(70, 130, 180, 0.5);
    background: linear-gradient(135deg, rgba(20, 20, 20, 0.6), rgba(70, 130, 180, 0.2));
}

.result-card:active {
    transform: scale(0.97) !important;
    box-shadow: inset 0 6px 12px rgba(0, 0, 0, 0.6) !important; /* ظل داخلي فقط */
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.7), rgba(50, 50, 50, 0.4)) !important;
    clip-path: inset(0 0 0 0 round 15px) !important; /* قص صارم عند الضغط */
}

.result-card img {
    width: clamp(80px, 20vw, 140px); /* زيادة حجم الصورة */
    height: clamp(80px, 20vw, 140px);
    border-radius: 50%;
    margin-bottom: 20px; /* زيادة المسافة تحت الصورة */
    object-fit: cover;
    border: 2px solid rgba(255, 255, 255, 0.2);
    transition: transform 0.3s ease;
}

.result-card:hover img {
    transform: rotate(10deg) scale(1.1);
}

.result-card h4 {
    font-size: clamp(18px, 5vw, 24px); /* زيادة حجم النص */
    font-weight: bold;
    color: white;
    margin: 0 0 20px 0; /* زيادة المسافة تحت الاسم */
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
    text-align: center;
    white-space: normal;
    word-wrap: break-word;
    max-width: 90%;
}

.result-card p {
    font-size: clamp(16px, 4.5vw, 22px); /* زيادة حجم السعر */
    color: #fff;
    margin: 0;
    padding: 8px 18px; /* زيادة حشوة المستطيل لتناسب الحجم الجديد */
    background: linear-gradient(45deg, #4682B4, #20B2AA);
    border-radius: 8px;
    font-weight: 600;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    text-align: center;
}

.result-card:hover p {
    transform: scale(1.05);
    box-shadow: 0 4px 10px rgba(70, 130, 180, 0.6);
}


/* السعر القديم (ينشطب بالأحمر) */
.old-price {
    color: #ffb3b3;
    text-decoration: line-through;
    opacity: 0.9;
    margin-inline-start: 5px;
}

/* السعر الجديد (عرض خاص) */
.new-price {
    font-weight: 700;
    margin-inline-end: 5px;
}


/* Media Queries */
@media (max-width: 480px) { /* موبايل صغير */
    .result-card {
        padding: 15px;
        width: 95%;
        min-height: 180px; /* ارتفاع أدنى للموبايل */
    }

    .result-card img {
        width: clamp(70px, 18vw, 120px); /* حجم أكبر للموبايل */
        height: clamp(70px, 18vw, 120px);
        margin-bottom: 15px;
    }

    .result-card h4 {
        font-size: clamp(16px, 4.5vw, 22px); /* نص أكبر للموبايل */
        margin-bottom: 15px;
    }

    .result-card p {
        font-size: clamp(14px, 4vw, 20px); /* سعر أكبر للموبايل */
        padding: 6px 15px;
    }
}

@media (min-width: 481px) and (max-width: 768px) { /* تابلت */
    .result-card {
        width: 90%;
        min-height: 190px;
    }

    .result-card img {
        width: clamp(80px, 15vw, 130px);
        height: clamp(80px, 15vw, 130px);
    }

    .result-card h4 {
        font-size: clamp(18px, 4.5vw, 24px);
    }

    .result-card p {
        font-size: clamp(16px, 4vw, 22px);
    }
}

@media (min-width: 769px) { /* كمبيوتر */
    .result-card {
        width: 85%;
        max-width: 450px;
        min-height: 200px;
    }

    .result-card img {
        width: 120px; /* حجم ثابت للكمبيوتر */
        height: 120px;
    }

    .result-card h4 {
        font-size: 24px; /* نص أكبر للكمبيوتر */
    }

    .result-card p {
        font-size: 22px; /* سعر أكبر للكمبيوتر */
    }
}

.results-container {
    display: flex;
    flex-direction: column;
    gap: 10px;
    max-height: 600px;
    overflow-y: auto;
    scroll-behavior: smooth;
    border-radius: 10px;
    padding: 10px;
    background: rgba(0, 0, 0, 0.2);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    transform: translateZ(0); /* تسريع عتادي */
}



/* تأثير ظهور تدريجي */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: scale(0.95);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

     


@keyframes shake {
    0%, 100% {
        transform: translateX(0);
    }
    25% {
        transform: translateX(-10px);
    }
    50% {
        transform: translateX(10px);
    }
    75% {
        transform: translateX(-10px);
    }
}


.news-bar {
    display: flex;
    align-items: center;
    justify-content: row-reverse;
    background: rgba(0, 0, 0, 0.3);
    padding: 8px 16px;
    border-radius: 25px;
    width: 100%;
    height: 40px;
    border: 2px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
    margin-bottom: 2px; /* تقليل المسافة السفلية من 8px إلى 4px */
    box-sizing: border-box;
}

/* زر "عاجل" في اليمين */
.breaking-news {
    background: linear-gradient(135deg, #0082B5, #0070A0);
    color: white;
    font-weight: bold;
    padding: 6px 14px;
    border-radius: 20px;
    text-align: center;
    font-size: 14px;
    box-shadow: 0px 0px 10px rgba(0, 130, 181, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    height: 28px;
    margin-left: auto;
    order: 2;
    /* animation: none; */ /* أو احذف السطر ده نهائي */
}

@keyframes pulse {
    0% { transform: scale(1); opacity: 1; }
    100% { transform: scale(1.1); opacity: 0.9; }
}

/* تحسين حاوية الأخبار لجعلها بدون لون إضافي */
.news-ticker-container {
    flex: 1;
    height: 28px;
    overflow: hidden;
    position: relative;
    display: flex;
    align-items: center;
    background: transparent !important; /* ✅ اجعل الخلفية شفافة */
    border-radius: 15px;
    padding: 4px 8px; /* ✅ ضبط الحواف لتكون متساوية */
}

/* تحسين شريط الأخبار ليكون متناسقًا بدون خلفية منفصلة */
.news-ticker {
    display: flex;
    align-items: center;
    white-space: nowrap;
    position: absolute;
    animation: scrollText 60s linear infinite;
    color: white;
    font-weight: bold;
    font-size: 14px;
    gap: 25px;
    direction: rtl;
    unicode-bidi: plaintext;
    background: transparent !important; /* ✅ إزالة لون الخلفية */
}


/* ضبط كل جزء من الخبر لمنع تغيير ترتيب النصوص المختلطة */
.news-ticker span {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-right: 20px;
    direction: rtl; /* ✅ التأكد أن النصوص المختلطة تبقى متناسقة */
    unicode-bidi: embed; /* ✅ يضمن بقاء النصوص الإنجليزية ضمن مكانها الصحيح */
}

    
/* تحسين مظهر الأيقونة مع النص */
.news-ticker img {
    width: 16px;
    height: 16px;
    flex-shrink: 0; /* ✅ منع الأيقونات من التمدد أو التقلص */
}

/* تحسين الروابط داخل الأخبار */
.news-ticker a {
    color: white !important;
    text-decoration: none !important;
    direction: rtl; /* ✅ إجبار النص على البقاء في الاتجاه الصحيح */
}
.news-ticker a:hover {
    text-decoration: underline;
}

@keyframes scrollText {
    from { transform: translateX(-100%); }
    to { transform: translateX(100%); }
}
        


swal2-popup {
    background: rgba(255, 255, 255, 0.1); /* لون شفاف */
    border-radius: 15px;
    color: #fff;
    text-align: center;
    backdrop-filter: blur(10px);
    width: 300px; /* تقليل حجم النافذة */
    padding: 20px;
    font-family: 'Cairo', sans-serif !important;
}

.swal2-title {
    color: white;
    font-size: 24px !important;
    font-weight: bold !important;
    text-shadow: 0 2px 5px rgba(0, 0, 0, 0.7);
    margin-bottom: 15px;
}

.swal2-html-container {
    font-size: 16px !important;
    color: #dcdcdc !important;
    margin: 10px 0;
}

.swal2-actions {
    display: flex !important;
    flex-direction: row !important; /* جعل الأزرار جنب بعض */
    justify-content: center !important;
    gap: 10px !important; /* مسافة بين الأزرار */
    margin-top: 15px;
}


.swal2-confirm, .swal2-cancel {
    padding: 6px 16px !important; /* تقليل الحشوة لتصغير الأزرار */
    font-size: 14px !important; /* تقليل حجم النص */
    border-radius: 20px !important; /* زوايا مستديرة */
    font-weight: 600 !important;
    transition: all 0.3s ease !important;
    color: white !important;
    border: none !important;
    min-width: 60px !important; /* عرض أدنى للأزرار */
    overflow: hidden !important; /* قص التأثيرات */
    clip-path: inset(0 0 0 0 round 20px) !important; /* قص يطابق border-radius */
}

.swal2-confirm {
    background: linear-gradient(135deg, #43cea2, #185a9d) !important;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
}

.swal2-cancel {
    background: linear-gradient(135deg, #FF416C, #FF4B2B) !important;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
}

.swal2-confirm:hover, .swal2-cancel:hover {
    transform: scale(1.1);
    box-shadow: 0 8px 16px rgba(255, 255, 255, 0.3);
}

.swal2-confirm:active, .swal2-cancel:active {
    transform: scale(0.95) !important;
    box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.5) !important; /* ظل داخلي فقط */
    clip-path: inset(0 0 0 0 round 20px) !important; /* قص صارم */
}


.swal2-input {
    width: 90%;
    padding: 12px 15px;
    font-size: 16px;
    color: #ffffff;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 10px;
    box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.5);
    outline: none;
    transition: all 0.3s ease;
    margin: 10px auto;
    display: block;
    font-family: 'Cairo', sans-serif !important;
}

.swal2-input:focus {
    background: rgba(255, 255, 255, 0.2);
    border: 1px solid #43cea2;
    box-shadow: 0 0 10px #43cea2;
}



/* تنسيق زر الرجوع لأعلى */
.scroll-to-top {
    position: fixed;
    bottom: 60px;
    right: 20px;
    background: linear-gradient(45deg, #8B0000, #DC143C);
    color: #fff;
    border: none;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease, opacity 0.3s ease;
    opacity: 0;
    visibility: hidden;
    z-index: 1000;
    overflow: hidden !important; /* قص صارم */
    clip-path: circle(25px at center); /* قص دائري صارم */
}

.scroll-to-top:hover {
    transform: translateY(-5px) scale(1.1);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
}

.scroll-to-top:active {
    transform: scale(0.9) !important; /* تصغير قوي */
    background: linear-gradient(45deg, #7A0000, #C01234) !important;
    box-shadow: none !important; /* إلغاء الظل الخارجي */
    box-shadow: inset 0 6px 12px rgba(0, 0, 0, 0.7) !important; /* ظل داخلي فقط */
    clip-path: circle(25px at center) !important; /* تأكيد القص الدائري */
}

/* إظهار الزر */
.show-scroll-btn {
    opacity: 1;
    visibility: visible;
}

footer p {
    margin: 0; /* إزالة الهوامش */
    padding: 3px 0; /* تصغير الحشوة العلوية والسفلية */
    font-size: 14px; /* تصغير حجم النص */
    color: white; /* تأكيد اللون الأبيض */
    text-align: center;
}





footer {
    background-color: rgba(0, 0, 0, 0.8); /* جعل الخلفية أكثر وضوحًا */
    color: white;
    text-align: center;
    padding: 10px 0; /* تقليل التباعد لجعله أنيقًا */
    width: 100%;
    font-family: 'Montserrat', sans-serif;
    font-size: 14px;
    box-shadow: 0 -3px 10px rgba(0, 0, 0, 0.4); /* تحسين الظل لجعله أكثر بروزًا */
    position: fixed; /* تثبيت الفوتر أسفل الصفحة */
    bottom: 0; /* تثبيته في الأسفل */
    left: 0;
    z-index: 1000; /* جعله فوق جميع العناصر */
}

/* التأكد من عدم اختفاء المحتوى خلف الفوتر */
body {
    padding-bottom: 50px; /* يضمن عدم تغطية المحتوى بالفوتر */
}



/* ✅ نافذة إعلان مودرن */
#promoPopup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -100%); /* مهم حتى يشتغل slideDown/slideUp */
    width: min(420px, 92vw);
    background:
        radial-gradient(circle at top left, rgba(67, 206, 162, 0.15), transparent),
        rgba(15, 23, 42, 0.97); /* dark glassy */
    backdrop-filter: blur(18px);
    padding: 20px 18px 16px;
    border-radius: 18px;
    text-align: center;
    color: #e5e7eb;
    box-shadow: 0 18px 40px rgba(0, 0, 0, 0.85);
    display: none;
    flex-direction: column;
    gap: 12px;
    z-index: 9999;
}

/* محتوى البوب أب */
#promoPopup .promo-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
}

/* ✅ البادج الصغير فوق العنوان */
.promo-badge {
    font-size: 12px;
    font-weight: 600;
    letter-spacing: .04em;
    text-transform: uppercase;
    padding: 4px 10px;
    border-radius: 999px;
    background: rgba(34, 197, 94, 0.07);
    border: 1px solid rgba(34, 197, 94, 0.6);
    color: #bbf7d0;
}

/* صورة العرض (تصير كرت نظيف) */
#promoImage {
    width: 80px;
    height: 80px;
    border-radius: 20px;
    object-fit: cover;
    border: 1px solid rgba(148, 163, 184, 0.5);
    box-shadow: 0 8px 18px rgba(15, 23, 42, 0.9);
    transition: transform 0.25s ease;
    cursor: pointer;
}

#promoImage:hover {
    transform: translateY(-2px) scale(1.03);
}

/* عنوان الإعلان – بدون ألوان فاقعة */
.popup-title {
    font-size: 20px;
    font-weight: 700;
    margin: 0;
    color: #f9fafb;
    text-shadow: none;
    background: none;
    -webkit-text-fill-color: currentColor;
}

/* نص الإعلان */
.promo-text {
    margin: 0;
    font-size: 14px;
    line-height: 1.7;
    color: #cbd5f5;
}

/* زر الدعوة للفعل (CTA) */
#closeBtn {
    width: 100%;
    padding: 10px 0;
    font-size: 15px;
    font-weight: 600;
    color: #0b1120;
    background: linear-gradient(135deg, #22c55e, #06b6d4);
    border: none;
    border-radius: 999px;
    cursor: pointer;
    box-shadow: 0 10px 22px rgba(8, 47, 73, 0.7);
    transition: transform 0.18s ease, box-shadow 0.18s ease, filter 0.18s ease;
    font-family: 'Cairo', sans-serif !important;
}

#closeBtn:hover {
    transform: translateY(-1px);
    filter: brightness(1.05);
    box-shadow: 0 14px 28px rgba(8, 47, 73, 0.8);
}

#closeBtn:active {
    transform: translateY(1px) scale(0.97);
    box-shadow: inset 0 4px 8px rgba(15, 23, 42, 0.8);
}

/* ملاحظة صغيرة تحت الزر (اختيارية، لو ضفت span.promo-hint بالـ HTML) */
.promo-hint {
    font-size: 11px;
    color: #9ca3af;
    margin-top: 4px;
}

/* موبايلات – تكبير النص شوي وتخفيف المسافات */
@media (max-width: 480px) {
    #promoPopup {
        padding: 16px 14px 12px;
        border-radius: 16px;
    }

    .popup-title {
        font-size: 18px;
    }

    .promo-text {
        font-size: 13px;
    }

    #promoImage {
        width: 70px;
        height: 70px;
        border-radius: 16px;
    }
}




/* ===== Alert Popup: قالب إشعار عام (تعديل العرض وتوسيط المحتوى) ===== */
#promoPopup.alert-shell {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -100%);  /* حتى تشتغل أنيميشن slideDown/slideUp */

    /* 🔹 عرض أضيق وأرتب */
    width: min(360px, 90vw);   /* كان 420px, هسه أصغر */
    padding: 18px 16px 16px;
    border-radius: 18px;

    display: none;
    flex-direction: column;
    align-items: center;       /* توسيط كل المحتوى أفقياً */
    gap: 14px;

    z-index: 9999;
    direction: rtl;

    /* نخلي كل النصوص بالنص */
    text-align: center;

    background:
        radial-gradient(circle at top left, var(--alert-color-soft, rgba(34, 197, 94, 0.14)), transparent),
        rgba(15, 23, 42, 0.98);
    color: #e5e7eb;
    backdrop-filter: blur(20px);
}


/* ثيم الخصم / العروض */
#promoPopup.alert-sale {
    --alert-color: #fb923c;
    --alert-color-soft: rgba(251, 146, 60, 0.16);
    --alert-color-strong: #f97316;
}

/* ثيم المناسبات / الأحداث */
#promoPopup.alert-event {
    --alert-color: #38bdf8;
    --alert-color-soft: rgba(56, 189, 248, 0.18);
    --alert-color-strong: #0ea5e9;
}

/* ثيم التنبيهات العامة */
#promoPopup.alert-info {
    --alert-color: #a855f7;
    --alert-color-soft: rgba(168, 85, 247, 0.18);
    --alert-color-strong: #7c3aed;
}

/* ===== البنية الداخلية ===== */

/* الهيدر مال الإعلان */
.alert-header {
    display: flex;
    flex-direction: column;   /* كان صف، هسه فوق/جوه */
    align-items: center;      /* أيقونة + نص بالنص */
    gap: 10px;
}

/* النص اللي ويا العنوان */
.alert-head-text {
    display: flex;
    flex-direction: column;
    gap: 4px;
    min-width: 0;
    align-items: center;      /* توسيط داخلي */
    text-align: center;
}

/* العنوان */
.alert-title {
    margin: 0;
    font-size: 18px;
    line-height: 1.6;
    font-weight: 700;
    color: #f9fafb;
}


.alert-icon {
    width: 42px;
    height: 42px;
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;

    background: rgba(15, 23, 42, 0.96);
    border: 1px solid var(--alert-color);
    box-shadow: 0 10px 22px rgba(15, 23, 42, 0.9);
}

.alert-icon i {
    font-size: 18px;
    color: var(--alert-color-strong);
}



.alert-kicker {
    font-size: 11px;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    color: #9ca3af;
}



/* ===== النص الرئيسي ===== */

.alert-body {
    margin-top: 6px;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.alert-text {
    margin: 0;
    font-size: 13px;
    line-height: 1.7;
    color: #d1d5db;
}

/* شريط معلومات / ميتا */
.alert-meta {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;   /* تصير بالنص */
    gap: 6px 8px;
}


.alert-pill {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 8px;
    font-size: 11px;
    border-radius: 999px;
    background: rgba(15, 23, 42, 0.9);
    border: 1px solid rgba(148, 163, 184, 0.5);
    color: #9ca3af;
}

.alert-pill i {
    font-size: 11px;
    color: var(--alert-color);
}

/* ===== الفوتر / الأزرار ===== */



.alert-footer {
    margin-top: 12px;
    display: flex;
    justify-content: center;   /* كان flex-end */
    gap: 10px;
    flex-wrap: wrap;           /* لو زرّين أو ثلاثة يبقون مرتبين */
    width: 100%;
}

/* نخلي الأزرار نفس الحجم تقريبا وتكون مرتبة بالنص */
.alert-secondary,
.alert-primary {
    border-radius: 999px;
    padding: 8px 16px;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    border: none;
    outline: none;
    transition:
        transform 0.18s ease,
        box-shadow 0.18s ease,
        background 0.18s ease,
        border-color 0.18s ease;
    font-family: inherit;
    text-align: center;
    flex: 1 1 auto;      /* يخلي الزرّين ياخذون مساحة حلوة متساوية */
    max-width: 140px;    /* حتى ما يطلعن عريضة كلش */
}


/* زر ثانوي */
.alert-secondary {
    background: transparent;
    color: #e5e7eb;
    border: 1px solid rgba(148, 163, 184, 0.7);
}

.alert-secondary:hover {
    background: rgba(15, 23, 42, 0.96);
    border-color: rgba(209, 213, 219, 0.9);
}

/* زر رئيسي */
.alert-primary {
    background: linear-gradient(135deg, var(--alert-color), var(--alert-color-strong));
    color: #0b1120;
    box-shadow: 0 10px 22px rgba(0, 0, 0, 0.55);
}

.alert-primary:hover {
    transform: translateY(-1px);
    box-shadow: 0 14px 28px rgba(0, 0, 0, 0.7);
}

.alert-primary:active {
    transform: scale(0.97);
    box-shadow: inset 0 5px 10px rgba(0, 0, 0, 0.65);
}

/* ===== موبايل ===== */

@media (max-width: 480px) {
    #promoPopup.alert-shell {
        width: min(92vw, 340px);   /* أضيق شوي للموبايل */
        padding: 14px 14px 12px;
        border-radius: 16px;
    }

    .alert-title {
        font-size: 16px;
    }

    .alert-text {
        font-size: 12px;
    }

    .alert-footer {
        justify-content: center;   /* حتى بالموبايل تبقى الأزرار بالنص */
    }
}


/* 🔥 تحديث شكل نافذة العناصر الجديدة – نفس الـ ID الموجود */
#newItemsModal {
    position: fixed;
    top: 50px;          /* نفس منطقك: تحت الهيدر */
    bottom: 60px;       /* فوق الفوتر */
    left: 50%;
    transform: translateX(-50%);
    width: min(820px, calc(100% - 24px));
    padding: 18px 18px 14px;
    border-radius: 18px;
    background:
        radial-gradient(circle at top left, rgba(67, 206, 162, 0.16), transparent),
        rgba(15, 23, 42, 0.97); /* نفس جو إعلان promoPopup */
    box-shadow: 0 24px 60px rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(18px);
    border: 1px solid rgba(148, 163, 184, 0.35);
    display: none;
    flex-direction: column;
    gap: 12px;
    color: #e5e7eb;
    overflow: hidden;
    z-index: 10000;
}

/* العنوان داخل نافذة العناصر الجديدة */
#newItemsModal h2 {
    margin: 0 0 8px;
    font-size: 22px;
    letter-spacing: 0.04em;
    text-align: start;
    font-weight: 800;
    background: linear-gradient(135deg, #facc15, #f97316);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

/* زر الإغلاق الموجود أصلاً .close-modal-btn */
#newItemsModal .close-modal-btn {
    position: absolute;
    top: 10px;
    inset-inline-end: 10px;
    width: 32px;
    height: 32px;
    border-radius: 999px;
    border: none;
    background: rgba(15, 23, 42, 0.95);
    color: #e5e7eb;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.85);
    transition: transform 0.2s ease, background 0.2s ease, box-shadow 0.2s ease;
}

#newItemsModal .close-modal-btn:hover {
    transform: scale(1.08);
    background: linear-gradient(135deg, #ef4444, #b91c1c);
    box-shadow: 0 12px 28px rgba(185, 28, 28, 0.6);
}

#newItemsModal .close-modal-btn:active {
    transform: scale(0.9);
    box-shadow: none;
}

/* جسم النافذة – نفس .modal-content بس مودرن أكثر */
#newItemsModal .modal-content {
    margin-top: 4px;
    padding: 6px;
    border-radius: 14px;
    background: rgba(15, 23, 42, 0.96);
    border: 1px solid rgba(31, 41, 55, 0.95);
    overflow-y: auto;
    max-height: 100%;
    display: flex;
    flex-direction: column;
    gap: 8px;
    scrollbar-width: none;          /* فيرفوكس */
    -ms-overflow-style: none;       /* Edge / IE */
}

#newItemsModal .modal-content::-webkit-scrollbar {
    display: none; /* كروم */
}

/* كارت العنصر – نفس .new-item-card */
#newItemsModal .modal-content .new-item-card {
    background:
        radial-gradient(circle at top left, rgba(96, 165, 250, 0.18), rgba(15, 23, 42, 0.95));
    border-radius: 14px;
    padding: 10px 12px;
    display: flex;
    align-items: center;
    gap: 12px;
    border: 1px solid rgba(55, 65, 81, 0.95);
    box-shadow: 0 10px 28px rgba(15, 23, 42, 0.85);
    position: relative;
    transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.18s ease, background 0.18s ease;
}

#newItemsModal .modal-content .new-item-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 18px 40px rgba(15, 23, 42, 0.95);
    border-color: rgba(96, 165, 250, 1);
}

/* الدائرة اللي فيها اسم الفئة – نفس .category-circle */
#newItemsModal .modal-content .category-circle {
    width: 58px;
    height: 58px;
    border-radius: 999px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Cairo', sans-serif;
    font-weight: 700;
    font-size: 11px;
    text-align: center;
    padding: 6px;
    background: conic-gradient(from 160deg, #22c55e, #0ea5e9, #6366f1, #22c55e);
    color: #0b1120;
    box-shadow: 0 10px 25px rgba(15, 23, 42, 0.9);
}

/* محتوى النص – نفس .item-details و .new-badge و h4 و p */
#newItemsModal .modal-content .item-details {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

#newItemsModal .modal-content .item-details .new-badge {
    align-self: flex-start;
    font-size: 11px;
    padding: 3px 9px;
    border-radius: 999px;
    background: rgba(34, 197, 94, 0.15);
    color: #bbf7d0;
    border: 1px solid rgba(34, 197, 94, 0.5);
    text-transform: uppercase;
    letter-spacing: .12em;
}

#newItemsModal .modal-content .item-details h4 {
    margin: 0;
    font-size: 15px;
    color: #f9fafb;
    display: flex;
    align-items: center;
    gap: 8px;
}

#newItemsModal .modal-content .item-details h4 i {
    font-size: 14px;
    color: #22c55e;
}

#newItemsModal .modal-content .item-details p {
    margin: 0;
    font-size: 13px;
    padding: 4px 8px;
    border-radius: 8px;
    display: inline-block;
    background: linear-gradient(135deg, #1d4ed8, #06b6d4);
    color: #e0f2fe;
}

/* موبايل */
@media (max-width: 480px) {
    #newItemsModal {
        top: 45px;
        bottom: 55px;
        width: calc(100% - 10px);
        padding: 14px 10px 10px;
        border-radius: 16px;
    }

    #newItemsModal h2 {
        font-size: 19px;
    }

    #newItemsModal .modal-content .new-item-card {
        padding: 8px 9px;
        gap: 9px;
    }

    #newItemsModal .modal-content .category-circle {
        width: 50px;
        height: 50px;
        font-size: 10px;
    }

    #newItemsModal .modal-content .item-details h4 {
        font-size: 13px;
    }

    #newItemsModal .modal-content .item-details p {
        font-size: 12px;
    }
}


/* 🎨 تصميم عالمي لنافذة تحديث البيانات + نافذة النجاح */

.swal2-popup.update-dialog,
.swal2-popup.update-success-dialog {
    border-radius: 24px;
    padding: 22px 22px 18px;
    width: min(420px, 92vw);
    background:
        radial-gradient(circle at top left, rgba(56, 189, 248, 0.20), transparent 55%),
        radial-gradient(circle at bottom right, rgba(34, 197, 94, 0.18), transparent 55%),
        rgba(15, 23, 42, 0.98);
    box-shadow:
        0 30px 80px rgba(15, 23, 42, 0.95),
        0 0 0 1px rgba(51, 65, 85, 0.85);
    backdrop-filter: blur(22px);
    color: #e5e7eb;
    font-family: 'Cairo', 'Tajawal', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    text-align: center;
}

/* نافذة النجاح أصغر شوي */
.swal2-popup.update-success-dialog {
    width: min(380px, 90vw);
}

/* نضبط الكونتينر الداخلي */
.update-shell,
.update-success-shell {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 14px;
}

/* شارة صغيرة فوق */
.update-chip {
    font-size: 11px;
    letter-spacing: 0.18em;
    text-transform: uppercase;
    padding: 4px 12px;
    border-radius: 999px;
    border: 1px solid rgba(148, 163, 184, 0.75);
    background: rgba(15, 23, 42, 0.9);
    color: #9ca3af;
}

/* حلقة التحميل (حلقة ملونة تدور) */
.update-ring {
    width: 96px;
    height: 96px;
    border-radius: 999px;
    padding: 3px;
    background: conic-gradient(
        from 220deg,
        #22c55e,
        #06b6d4,
        #a855f7,
        #22c55e
    );
    display: flex;
    align-items: center;
    justify-content: center;
    animation: spin 1.1s linear infinite;
    box-shadow: 0 0 32px rgba(56, 189, 248, 0.6);
}

.update-ring-inner {
    width: 100%;
    height: 100%;
    border-radius: inherit;
    background: radial-gradient(circle at top, #020617, #020617);
    display: flex;
    align-items: center;
    justify-content: center;
}

.update-ring-inner i {
    font-size: 30px;
    color: #bbf7d0;
}

/* عنوان وشرح التحديث */
.update-title {
    font-size: 19px;
    font-weight: 800;
    margin: 0;
    background: linear-gradient(135deg, #facc15, #22c55e);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.update-subtitle {
    margin: 0;
    margin-top: 4px;
    font-size: 13px;
    color: #9ca3af;
    max-width: 280px;
    line-height: 1.7;
}

/* أيقونة النجاح */
.update-success-icon {
    width: 78px;
    height: 78px;
    border-radius: 999px;
    background: radial-gradient(circle at top, #22c55e, #16a34a);
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow:
        0 0 22px rgba(34, 197, 94, 0.9),
        0 0 40px rgba(34, 197, 94, 0.6);
}

.update-success-icon i {
    font-size: 34px;
    color: #ecfeff;
}

.update-success-title {
    font-size: 18px;
    font-weight: 800;
    margin: 0;
    background: linear-gradient(135deg, #bbf7d0, #22c55e);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.update-success-text {
    margin: 0;
    margin-top: 4px;
    font-size: 13px;
    color: #d1d5db;
    max-width: 260px;
    line-height: 1.7;
}

/* موبايل */
@media (max-width: 480px) {
    .swal2-popup.update-dialog,
    .swal2-popup.update-success-dialog {
        padding: 18px 14px 14px;
        border-radius: 20px;
    }

    .update-title,
    .update-success-title {
        font-size: 16px;
    }

    .update-subtitle,
    .update-success-text {
        font-size: 12px;
        max-width: 100%;
    }

    .update-ring {
        width: 84px;
        height: 84px;
    }

    .update-success-icon {
        width: 68px;
        height: 68px;
    }
}

/* 🎨 نافذة الخروج – تصميم عالمي مع غلاس وجراديانت */

.swal2-popup.exit-popup {
    background:
        radial-gradient(circle at top left, rgba(67, 206, 162, 0.18), transparent 55%),
        radial-gradient(circle at bottom right, rgba(56, 189, 248, 0.20), transparent 55%),
        rgba(15, 23, 42, 0.98);  /* dark glassy مثل الإعلان */
    border-radius: 22px;
    width: min(420px, 92vw);
    padding: 22px 20px 18px;
    box-shadow: 0 26px 70px rgba(0, 0, 0, 0.9);
    color: #e5e7eb;
    font-family: 'Cairo', sans-serif !important;
    text-align: center;
}

/* هيكل المحتوى الداخلي */
.exit-shell {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 14px;
}

/* الأيقونة الدائرية في الأعلى */
.exit-icon {
    width: 78px;
    height: 78px;
    border-radius: 999px;
    background: radial-gradient(circle at top, #f97316, #b91c1c);
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow:
        0 0 24px rgba(248, 113, 113, 0.9),
        0 0 40px rgba(15, 23, 42, 1);
}

.exit-icon i {
    font-size: 34px;
    color: #fff7ed;
}

/* العنوان والنص */
.exit-title {
    margin: 6px 0 0 0;
    font-size: 20px;
    font-weight: 800;
    background: linear-gradient(135deg, #fee2e2, #fecaca);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.exit-text {
    margin: 4px 0 0 0;
    font-size: 13px;
    color: #e5e7eb;
    max-width: 290px;
    line-height: 1.7;
}

/* أزرار الخروج / الرجوع */
.exit-confirm,
.exit-cancel {
    border-radius: 999px !important;
    padding: 8px 24px !important;
    font-size: 14px !important;
    font-weight: 700 !important;
    box-shadow: 0 10px 24px rgba(15, 23, 42, 0.85);
    border: none !important;
}

/* زر الخروج */
.exit-confirm {
    background: linear-gradient(135deg, #ef4444, #b91c1c) !important;
    color: #fef2f2 !important;
}

.exit-confirm:hover {
    transform: translateY(-1px);
    box-shadow: 0 14px 30px rgba(185, 28, 28, 0.9);
}

/* زر الرجوع */
.exit-cancel {
    background: rgba(15, 23, 42, 0.94) !important;
    color: #e5e7eb !important;
    border: 1px solid rgba(148, 163, 184, 0.6) !important;
}

.exit-cancel:hover {
    background: rgba(30, 41, 59, 0.96) !important;
}

/* موبايل */
@media (max-width: 480px) {
    .swal2-popup.exit-popup {
        width: min(95vw, 380px);
        padding: 18px 14px 14px;
        border-radius: 20px;
    }

    .exit-title {
        font-size: 18px;
    }

    .exit-text {
        font-size: 12px;
        max-width: 100%;
    }
}



/* 🌌 طبقة تغطي الشاشة كلها – نفس جو إعلان البداية تقريباً */
.activation-overlay {
    position: fixed;
    inset: 0;
    background:
        radial-gradient(circle at top left, rgba(67, 206, 162, 0.22), transparent 55%),
        radial-gradient(circle at bottom right, rgba(56, 189, 248, 0.20), transparent 60%),
        rgba(15, 23, 42, 0.96);
    backdrop-filter: blur(18px);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.25s ease;
}

/* لما تنفتح النافذة */
.activation-overlay.is-open {
    opacity: 1;
    pointer-events: auto;
}

/* 🧊 صندوق المودال – تصميم ناعم وعالمي */
.activation-dialog {
    width: min(440px, 94vw);
    background: radial-gradient(circle at top, rgba(15, 23, 42, 0.95), #020617);
    border-radius: 24px;
    border: 1px solid rgba(148, 163, 184, 0.25);
    box-shadow:
        0 24px 80px rgba(15, 23, 42, 0.98),
        0 0 0 1px rgba(15, 23, 42, 0.9);
    padding: 22px 22px 18px;
    color: #e5e7eb;
    font-family: 'Cairo', sans-serif;
    transform: translateY(18px) scale(0.96);
    opacity: 0;
    transition: transform 0.28s ease, opacity 0.28s ease, box-shadow 0.28s ease;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    overflow: hidden;
}

/* لمعة خفيفة تتحرك داخل النافذة */
.activation-dialog::before {
    content: '';
    position: absolute;
    inset: -40%;
    background:
        radial-gradient(circle at top center, rgba(56, 189, 248, 0.18), transparent 65%);
    opacity: 0.85;
    mix-blend-mode: screen;
    animation: activation-light-move 9s ease-in-out infinite;
    pointer-events: none;
}

/* هالة ناعمة حوالين النافذة */
.activation-dialog::after {
    content: '';
    position: absolute;
    inset: -1px;
    border-radius: inherit;
    border: 1px solid rgba(148, 163, 184, 0.35);
    box-shadow:
        0 0 25px rgba(56, 189, 248, 0.35),
        0 0 60px rgba(67, 206, 162, 0.25);
    opacity: 0.7;
    pointer-events: none;
}

/* حركة دخول بسيطة */
.activation-overlay.is-open .activation-dialog {
    transform: translateY(0) scale(1);
    opacity: 1;
}

/* 🔄 حركة لمعة الخلفية */
@keyframes activation-light-move {
    0%   { transform: translate3d(-10%, -6%, 0) scale(1); }
    50%  { transform: translate3d(8%, 10%, 0) scale(1.1); }
    100% { transform: translate3d(-10%, -6%, 0) scale(1); }
}

/* لوغو متحرك فوق */
.activation-logo {
    margin-bottom: 14px;
    position: relative;
    z-index: 1;
}

.activation-logo-ring {
    width: 72px;
    height: 72px;
    border-radius: 999px;
    background:
        conic-gradient(from 0deg, #22c55e, #0ea5e9, #a855f7, #facc15, #22c55e);
    display: flex;
    align-items: center;
    justify-content: center;
    animation: activation-spin 7s linear infinite;
    position: relative;
    box-shadow: 0 0 26px rgba(34, 197, 94, 0.55);
}

.activation-logo-core {
    width: 56px;
    height: 56px;
    border-radius: 999px;
    background: radial-gradient(circle at 30% 0%, #22c55e, #0f172a);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #ecfdf5;
    font-size: 20px;
    font-weight: 700;
    text-shadow: 0 2px 8px rgba(0, 0, 0, 0.8);
}

/* دوران اللوجو */
@keyframes activation-spin {
    0%   { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* هيدر */
.activation-header {
    display: flex;
    flex-direction: column;
    gap: 4px;
    margin-bottom: 12px;
    align-items: center;
    position: relative;
    z-index: 1;
}

.activation-label {
    font-size: 11px;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: #9ca3af;
}

.activation-title {
    font-size: 21px;
    font-weight: 800;
    background: linear-gradient(135deg, #ffcc00, #22c55e);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.activation-subtitle {
    font-size: 13px;
    color: #9ca3af;
}

/* جسم المحتوى */
.activation-body {
    margin-top: 6px;
    margin-bottom: 10px;
    max-width: 360px;
    position: relative;
    z-index: 1;
}

.activation-text {
    font-size: 13px;
    color: #d1d5db;
    margin-bottom: 14px;
}

/* الحقل */
.activation-field-label {
    display: block;
    font-size: 12px;
    margin-bottom: 6px;
    color: #9ca3af;
}

.activation-input-row {
    position: relative;
    display: flex;
    align-items: center;
    border-radius: 999px;
    background: radial-gradient(circle at top, rgba(15, 23, 42, 0.4), #020617);
    border: 1px solid rgba(148, 163, 184, 0.45);
    padding-inline: 10px;
    box-shadow: 0 0 0 1px rgba(15, 23, 42, 0.9), 0 0 22px rgba(56, 189, 248, 0.18);
    transition: border 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
}

.activation-input-row input {
    flex: 1;
    border: none;
    outline: none;
    background: transparent;
    color: #f9fafb;
    font-size: 14px;
    padding: 9px 4px 9px 0;
    font-family: 'Cairo', sans-serif;
    text-align: center;
}

.activation-input-row input::placeholder {
    color: #6b7280;
}

/* تفاعل عند التركيز */
.activation-input-row:focus-within {
    border-color: #22c55e;
    box-shadow:
        0 0 0 1px rgba(34, 197, 94, 0.7),
        0 0 26px rgba(34, 197, 94, 0.35);
    background: radial-gradient(circle at top, rgba(22, 163, 74, 0.25), #020617);
}

/* زر إظهار/إخفاء كلمة المرور */
.activation-toggle-password {
    border: none;
    background: transparent;
    cursor: pointer;
    padding: 0;
    margin-left: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #9ca3af;
    font-size: 17px;
    transition: color 0.18s ease, transform 0.18s ease;
}

.activation-toggle-password:hover {
    color: #e5e7eb;
    transform: scale(1.05);
}

/* رسالة الخطأ تحت الحقل */
.activation-error {
    min-height: 20px;
    font-size: 12px;
    color: #f97373;
    margin-top: 6px;
}

/* الفوتر والأزرار */
.activation-footer {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-top: 12px;
    position: relative;
    z-index: 1;
}

.activation-btn {
    border-radius: 999px;
    border: none;
    padding: 8px 20px;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    font-family: 'Cairo', sans-serif;
    transition: transform 0.18s ease, box-shadow 0.18s ease, background 0.18s ease;
}

/* زر التأكيد – أخضر متدرّج أنيق */
.activation-btn.primary {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    color: #022c22;
    box-shadow:
        0 10px 25px rgba(34, 197, 94, 0.55);
}

.activation-btn.primary:hover {
    transform: translateY(-1px);
    box-shadow: 0 12px 30px rgba(34, 197, 94, 0.7);
}

/* زر الإغلاق – غامق أنيق */
.activation-btn.ghost {
    background: rgba(15, 23, 42, 0.9);
    color: #e5e7eb;
    border: 1px solid #374151;
}

.activation-btn.ghost:hover {
    background: #111827;
}

/* اهتزاز بسيط عند الخطأ */
@keyframes activation-shake {
    10%, 90% { transform: translateX(-2px); }
    20%, 80% { transform: translateX(4px); }
    30%, 50%, 70% { transform: translateX(-6px); }
    40%, 60% { transform: translateX(6px); }
}

.activation-dialog.is-shaking {
    animation: activation-shake 0.35s;
}

/* ------- حالة النجاح العالمية ------- */
.activation-dialog.is-success {
    border-color: #22c55e;
    box-shadow:
        0 0 0 1px rgba(34, 197, 94, 0.7),
        0 24px 80px rgba(34, 197, 94, 0.5);
    animation: activation-pop 0.45s ease-out;
}

@keyframes activation-pop {
    0%   { transform: scale(0.9); opacity: 0; }
    60%  { transform: scale(1.07); opacity: 1; }
    100% { transform: scale(1); }
}

.activation-success {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    padding-top: 4px;
    padding-bottom: 2px;
}


/* شعار نجاح ناعم وعالمي أكثر */
.activation-success-icon {
    position: relative;
    width: 90px;
    height: 90px;
    border-radius: 999px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: radial-gradient(circle at 30% 0%, #22c55e, #0f172a);
    box-shadow:
        0 0 28px rgba(34, 197, 94, 0.8),
        0 0 60px rgba(56, 189, 248, 0.45);
    overflow: hidden;
}

/* حلقة خارجية تمشي حوالين الشعار */
.activation-success-icon::before {
    content: "";
    position: absolute;
    inset: -4px;
    border-radius: inherit;
    border: 2px solid transparent;
    background:
        conic-gradient(from 0deg, #22c55e, #0ea5e9, #a855f7, #facc15, #22c55e);
    mask:
        radial-gradient(farthest-side, transparent 62%, #000 64%);
    -webkit-mask:
        radial-gradient(farthest-side, transparent 62%, #000 64%);
    animation: activation-success-ring 5s linear infinite;
    opacity: 0.9;
}

/* لمعة خفيفة تطلع وتروح */
.activation-success-icon::after {
    content: "";
    position: absolute;
    width: 120%;
    height: 120%;
    background: radial-gradient(circle at 10% 0%, rgba(248, 250, 252, 0.45), transparent 60%);
    opacity: 0;
    animation: activation-success-glow 2.4s ease-in-out infinite;
}

/* الدائرة الداخلية ويا علامة الصح (نفس الـ <i> اللي عندك) */
.activation-success-inner {
    position: relative;
    z-index: 1;
    width: 64px;
    height: 64px;
    border-radius: 999px;
    background: radial-gradient(circle at 30% 0%, #ecfdf5, #4ade80);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #064e3b;
    font-size: 30px;
    box-shadow:
        0 8px 20px rgba(22, 163, 74, 0.7),
        0 0 0 1px rgba(22, 163, 74, 0.9);
    animation: activation-success-pulse 1.1s ease-out;
}

/* نبض الشعار أول ما يطلع */
@keyframes activation-success-pulse {
    0%   { transform: scale(0.6); opacity: 0; }
    50%  { transform: scale(1.08); opacity: 1; }
    100% { transform: scale(1); }
}

/* دوران الحلقة الخارجية */
@keyframes activation-success-ring {
    0%   { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* لمعة ناعمة تدخل وتطلع */
@keyframes activation-success-glow {
    0%, 100% { opacity: 0; }
    40%      { opacity: 0.8; }
}


.activation-success-title {
    font-size: 18px;
    font-weight: 700;
    color: #bbf7d0;
}

.activation-success-text {
    font-size: 13px;
    color: #d1fae5;
    max-width: 320px;
}


/* جعل الواجهة بعرض الشاشة على الحاسوب (شاشات كبيرة) */
@media (min-width: 1024px) {
    .container {
        width: 90%;        /* تاخذ كل عرض الصفحة */
        max-width: 100%;    /* تلغي حد 800px */
        margin: 10px 0 20px 0; /* نشيل auto حتى ما تنضغط بالنص */
    }

    .results-container {
        max-width: 100%;    /* النتائج هم تستفاد من كل العرض */
    }
}

/* تكبير كارت النتيجة على الحاسوب */
@media (min-width: 1024px) {
    /* حاوية النتائج تاخذ 80% من عرض الشاشة وتتوسّط */
    .results-container {
        width: 80%;
        max-width: 80%;
        margin: 0 auto;
    }

    /* الكارت نفسه ياخذ كل عرض حاوية النتائج */
    .result-card {
        width: 80%;
        max-width: 100%;
    }
}

/* 🔹 على الحاسوب: أزرار (أسعار بنمط الكروب + المتجر + التوافقات) بصف واحد */
@media (min-width: 1024px) {
    .categories {
        display: flex;
        flex-direction: row;   /* نخليهم صف */
        flex-wrap: wrap;       /* يسمح للسلايدر ينزل سطر جديد */
        justify-content: center;
        align-items: center;
        gap: 10px;
    }

    /* الأزرار الثلاثة بس تصير يم بعض */
    .categories > .new-category-btn,
    .categories > .category-btn,
    .categories > .tools-btn {
        width: auto;       /* نلغي 85% */
        max-width: none;   /* نلغي 250px */
        min-width: 220px;  /* عرض حلو مرتب */
    }

    /* السلايدر يبقى تحتهم بعرض كامل */
    .categories > .slider-container {
        flex-basis: 100%;
        margin-top: 8px;
    }
}


/* 🖥️ تحسين عرض كل النوافذ المنبثقة على الحاسوب فقط */
@media (min-width: 1024px) {

    /* نافذة الإعلان */
    #promoPopup {
        width: min(600px, 70vw);   /* أعرض من الموبايل بس مو فل الشاشة */
    }

    /* نافذة الآيتمات الجديدة */
    #newItemsModal {
        width: min(1100px, 90vw);  /* تاخذ عرض أكبر على الحاسوب */
        max-width: 1100px;
        left: 50%;
        transform: translateX(-50%);
    }

    /* كل نوافذ SweetAlert2 العادية (تنبيهات/رسائل) */
    .swal2-popup {
        width: min(520px, 60vw) !important;
        max-width: 520px !important;
    }

    /* نافذة تفعيل كلمة المرور – نخليها أوسع شوي */
    .swal2-popup.activation-popup {
        width: min(580px, 65vw) !important;
        max-width: 580px !important;
    }
}


/* يخلي مستطيل السعر القديم والجديد بصف واحد */
.price-row {
    display: flex;
    justify-content: center;
    align-items: stretch;
    gap: 8px;
    flex-wrap: wrap;
}

/* مستطيل السعر القديم يستخدم نفس ستايل p تماماً */
.old-price-pill {
    margin: 0; /* لا نريد فراغ إضافي */
}

/* الشطب على السعر القديم – أحمر غامق وبازر */
.old-price-text {
    color: #ffe5e5;
    text-decoration: line-through;
    text-decoration-color: #8b0000;  /* أحمر غامق قوي */
    text-decoration-thickness: 3px;  /* سميك */
    text-underline-offset: 4px;
}


/* مستطيل السعر الجديد – نفس الأبعاد تقريباً لكن أحمر غامق وخط أبيض */
.new-price-pill {
    margin: 0;
    font-size: clamp(16px, 4.5vw, 22px);
    padding: 8px 18px;
    border-radius: 8px;
    font-weight: 700;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    background-color: #8b0000;  /* أحمر غامق */
    color: #ffffff;             /* خط أبيض قوي */
    min-width: 120px;
    text-align: center;

    position: relative;         /* ضروري للأنيميشن */
    overflow: hidden;
}

/* النصين داخل البادج الأحمر ("عرض خاص" / السعر) */
.new-price-pill .new-price-text {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    white-space: nowrap;
    opacity: 0;
}

/* "عرض خاص" – يرمش أكثر من مرة وبشكل سريع بالبداية */
.new-price-pill .new-price-label {
    animation: blinkOffer 3s infinite;
}

/* السعر – يظهر بعد الرمشات ويبقى باقي الفترة */
.new-price-pill .new-price-value {
    animation: showPrice 3s infinite;
}

/* يرَمّش "عرض خاص" أكثر من مرة بسرعة ثم يختفي */
@keyframes blinkOffer {
    0%   { opacity: 1; }
    10%  { opacity: 0; }
    20%  { opacity: 1; }
    30%  { opacity: 0; }
    40%  { opacity: 1; }
    50%  { opacity: 0; }  /* نهاية الرمشات السريعة */
    60%  { opacity: 0; }
    100% { opacity: 0; }  /* باقي الدورة مخفي */
}

/* السعر: مخفي بالبداية، يظهر بعد الرمشات ويبقى ظاهر */
@keyframes showPrice {
    0%   { opacity: 0; }
    55%  { opacity: 0; }
    65%  { opacity: 1; }
    100% { opacity: 1; }
}


.new-price-pill {
    margin: 0;
    font-size: clamp(16px, 4.5vw, 22px);
    padding: 8px 18px;
    border-radius: 8px;
    font-weight: 700;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);

    /* هنا التعديل المهم */
    background: #8b0000 !important;   /* أحمر غامق صريح، يقتل الغراديانت */
    color: #ffffff;

    min-width: 120px;
    text-align: center;

    position: relative;
    overflow: hidden;
}


/* تعديل خفيف لمحاذاة السعر عمودياً داخل البادجات على الموبايل فقط */
@media (max-width: 768px) {

    /* ⬇️ نزّل السعر القديم داخل صف التخفيض */
    .old-price-text {
        position: relative;
        top: 2px;   /* تقدر تخليها 2px إذا بعده عالي */
    }

    /* ⬇️ نزّل النص داخل البادج الأحمر (عرض خاص / السعر) */
    .new-price-pill .new-price-text {
        transform: translateY(2px); /* هم تقدر تخليها 2px */
    }

}

/* ✅ ضبط البادج اللي فيها "سعر واحد فقط" (بدون تخفيض) */

/* هذا يمسك أي p جوّه .result-card ومو هو البادج القديم ولا الجديد */
.result-card p:not(.old-price-pill):not(.new-price-pill) {
    display: flex !important;
    align-items: center !important;    /* سنترة عمودي */
    justify-content: center !important;/* سنترة أفقي */
    line-height: 1.2 !important;       /* يقلل إحساس إنه طالع لفوك */
}

/* لو تريده مضبوط أكثر على الموبايل */
@media (max-width: 768px) {
    .result-card p:not(.old-price-pill):not(.new-price-pill) {
        padding-top: 10px !important;
        padding-bottom: 8px !important;
    }
}


/* 🔁 توحيد أبعاد كل بادجات السعر (سعر واحد / قديم / جديد) */
.result-card p,
.price-row .old-price-pill,
.price-row .new-price-pill {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    line-height: 1.2;

    /* نفس الحشوة ونفس شكل المستطيل للجميع */
    padding: 8px 18px;
    border-radius: 8px;
    min-height: 40px;
    box-sizing: border-box;
}

/* 📴 موبايل – نفس الأبعاد بس مصغّرة للجميع همين */
@media (max-width: 480px) {
    .result-card p,
    .price-row .old-price-pill,
    .price-row .new-price-pill {
        padding: 6px 15px;
        min-height: 36px;
    }
}


/* زر العروض بالهيدر */
.header-buttons .offers-btn{
    background: linear-gradient(135deg, rgba(250,204,21,.95), rgba(249,115,22,.95));
    color:#111827;
}
.header-buttons .offers-btn:hover{
    transform: scale(1.06);
    filter: brightness(1.05);
}
.header-buttons .offers-btn:active{
    transform: scale(0.95);
}

/* نافذة العروض */
#offersModal{
    position: fixed;
    top: 50px;
    bottom: 60px;
    left: 50%;
    transform: translateX(-50%);
    width: calc(100% - 20px);
    max-width: 980px;
    background:
        radial-gradient(circle at top left, rgba(250,204,21,.12), transparent 45%),
        radial-gradient(circle at bottom right, rgba(249,115,22,.10), transparent 55%),
        rgba(15, 23, 42, 0.92);
    backdrop-filter: blur(18px);
    border: 1px solid rgba(55, 65, 81, 0.75);
    border-radius: 18px;
    padding: 14px;
    z-index: 10000;
    display: none;
    flex-direction: column;
    gap: 10px;
    box-shadow: 0 20px 60px rgba(0,0,0,.75);
}

/* زر الإغلاق (نسخة خاصة للعروض) */
#offersModal .close-modal-btn{
    position:absolute;
    top: 10px;
    inset-inline-end: 10px;
    width: 34px;
    height: 34px;
    border-radius: 999px;
    border: none;
    background: rgba(17,24,39,.85);
    color:#e5e7eb;
    display:flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
    box-shadow: 0 10px 25px rgba(0,0,0,.6);
    transition: transform .18s ease, background .18s ease;
}
#offersModal .close-modal-btn:hover{
    transform: scale(1.08);
    background: linear-gradient(135deg, #ef4444, #b91c1c);
}
#offersModal .close-modal-btn:active{ transform: scale(.92); }

/* رأس النافذة */
#offersModal .offers-head{
    display:flex;
    align-items:center;
    justify-content: space-between;
    gap: 10px;
    padding: 6px 4px 0;
}
#offersModal h2{
    margin:0;
    font-size: 22px;
    font-weight: 900;
    letter-spacing: .02em;
    background: linear-gradient(135deg, #facc15, #fb923c);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}
#offersModal .offers-chip{
    font-family: 'Cairo', sans-serif;
    font-size: 12px;
    color: #111827;
    background: rgba(250,204,21,.95);
    padding: 6px 10px;
    border-radius: 999px;
    box-shadow: 0 10px 24px rgba(0,0,0,.35);
    white-space: nowrap;
}

/* شريط البحث */
#offersModal .offers-toolbar{
    position: relative;
    width: 100%;
    padding: 0 4px;
}
#offersModal .offers-toolbar i{
    position:absolute;
    inset-inline-end: 18px;
    top: 50%;
    transform: translateY(-50%);
    color: rgba(229,231,235,.7);
    pointer-events:none;
}
#offersSearchInput{
    width: 100%;
    padding: 12px 44px 12px 12px;
    border-radius: 14px;
    background: rgba(17,24,39,.72);
    border: 1px solid rgba(55,65,81,.85);
    color: #fff;
    outline: none;
    font-family: 'Cairo', sans-serif;
    transition: box-shadow .2s ease, border-color .2s ease;
}
#offersSearchInput:focus{
    border-color: rgba(250,204,21,.85);
    box-shadow: 0 0 0 4px rgba(250,204,21,.12);
}

/* محتوى العروض (Grid) */
#offersModal .offers-content{
    width: 100%;
    flex: 1;
    overflow-y: auto;
    padding: 6px;
    border-radius: 16px;
    background: rgba(15,23,42,.55);
    border: 1px solid rgba(31,41,55,.75);
    display: grid;
    grid-template-columns: 1fr;
    gap: 10px;
    scrollbar-width: none;
    -ms-overflow-style: none;
}
#offersModal .offers-content::-webkit-scrollbar{ display:none; }

@media (min-width: 640px){
    #offersModal .offers-content{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
}
@media (min-width: 1024px){
    #offersModal{ width: min(1200px, 92vw); }
    #offersModal .offers-content{ grid-template-columns: repeat(3, minmax(0, 1fr)); }
}

/* كارت العرض */
.offer-card{
    border-radius: 16px;
    padding: 12px;
    background:
        radial-gradient(circle at top left, rgba(96,165,250,.16), rgba(15,23,42,.92));
    border: 1px solid rgba(55,65,81,.85);
    box-shadow: 0 14px 34px rgba(0,0,0,.55);
    transition: transform .18s ease, box-shadow .18s ease;
}
.offer-card:hover{
    transform: translateY(-2px);
    box-shadow: 0 18px 44px rgba(0,0,0,.65);
}

.offer-top{
    display:flex;
    align-items:flex-start;
    gap: 10px;
}
.offer-icon{
    width: 44px;
    height: 44px;
    border-radius: 14px;
    background: rgba(250,204,21,.08);
    border: 1px solid rgba(250,204,21,.20);
    display:flex;
    align-items:center;
    justify-content:center;
}
.offer-icon i{ font-size: 18px; color: #facc15; }

.offer-title{
    font-size: 15px;
    font-weight: 900;
    color: #fff;
    line-height: 1.35;
    margin: 0 0 6px 0;
}
.offer-meta{
    display:flex;
    align-items:center;
    justify-content: space-between;
    gap: 8px;
    flex-wrap: wrap;
}
.offer-tag{
    font-size: 12px;
    color: rgba(229,231,235,.9);
    background: rgba(31,41,55,.75);
    border: 1px solid rgba(55,65,81,.75);
    padding: 4px 8px;
    border-radius: 999px;
}
.offer-save{
    font-size: 12px;
    color: #111827;
    background: rgba(250,204,21,.95);
    padding: 4px 8px;
    border-radius: 999px;
    font-weight: 800;
}

/* جزء الأسعار داخل الكارت (يعتمد على price-row/old-price-pill/new-price-pill الموجودة عندك) */
.offer-prices{ margin-top: 10px; }
.offer-prices .price-row{ justify-content: flex-start; }


/* ✅ مستطيل السعر السابق فقط (بدون أي نص إضافي) */
.old-price-pill{
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  padding: 12px 14px !important;
  border-radius: 14px !important;

  background: rgba(255,255,255,.06) !important;
  border: 1px solid rgba(239,68,68,.22) !important;
  box-shadow: 0 10px 26px rgba(0,0,0,.30) !important;
}

/* تخلي الرقم مشطوب بشكل أنيق */
.old-price-text{
  font-weight: 1000 !important;
  color: rgba(255,255,255,.90) !important;
  text-decoration: line-through !important;
  text-decoration-color: rgba(239,68,68,.95) !important;
  text-decoration-thickness: 3px !important;
  text-underline-offset: 4px !important;
}

/* ==============================
   OFFER CARD - NEW CLEAN LAYOUT
   Desktop + Mobile (Override)
   Paste at END of CSS
============================== */

/* الكارت: مسافات وترتيب أوضح */
.offer-card{
  padding: 14px !important;
}

/* الجزء العلوي يصير “صف مرتب”: أيقونة + تفاصيل */
.offer-top{
  display: grid !important;
  grid-template-columns: 52px 1fr !important;
  gap: 12px !important;
  align-items: center !important;
}

/* الأيقونة تثبت */
.offer-icon{
  width: 52px !important;
  height: 52px !important;
  border-radius: 16px !important;
}

/* العنوان يصير أوضح وما يطوّل */
.offer-title{
  margin: 0 0 8px 0 !important;
  line-height: 1.35 !important;

  /* سطرين كحد أقصى (حتى يبقى الكارت مرتب) */
  display: -webkit-box !important;
  -webkit-line-clamp: 2 !important;
  -webkit-box-orient: vertical !important;
  overflow: hidden !important;
}

/* سطر الميتا (التصنيف + وفر) ترتيب ثابت */
.offer-meta{
  justify-content: flex-start !important;
  gap: 8px !important;
}
.offer-save{
  margin-inline-start: auto; /* يخلي “وفر” يروح للطرف بدون توسيط */
}

/* قسم الأسعار يصير مثل Footer داخل الكارت */
.offer-prices{
  margin-top: 12px !important;
  padding-top: 12px !important;
  border-top: 1px solid rgba(255,255,255,.08) !important;
}

/* صف السعرين: Grid ثابت */
.price-row{
  display: grid !important;
  grid-template-columns: 1fr 1fr !important;
  gap: 10px !important;
  align-items: stretch !important;
  justify-content: unset !important;
}

/* البادجات تاخذ عرضها بالكامل */
.old-price-pill,
.new-price-pill{
  width: 100% !important;
  min-width: 0 !important; /* يلغي min-width 120px إذا مأثر */
}

/* بالموبايل: نرتّبها عمودي حتى ما ينخنق المحتوى */
@media (max-width: 520px){
  .offer-top{
    grid-template-columns: 44px 1fr !important;
    align-items: start !important;
  }
  .offer-icon{
    width: 44px !important;
    height: 44px !important;
    border-radius: 14px !important;
  }

  .price-row{
    grid-template-columns: 1fr !important; /* السعرين تحت بعض */
    gap: 8px !important;
  }

  .offer-title{
    -webkit-line-clamp: 3 !important; /* نخليه 3 أسطر بالموبايل */
  }

  .offer-save{
    margin-inline-start: 0; /* لا يروح بعيد بالموبايل */
  }
}


/* داخل نافذة العروض فقط: نفس أبعاد مستطيل السعرين */
#offersModal .old-price-pill,
#offersModal .new-price-pill{
  width: 100% !important;
  min-width: 0 !important;
  padding: 12px 14px !important;
  border-radius: 14px !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  box-sizing: border-box !important;
  min-height: 44px !important; /* نفس الارتفاع دائماً */
}

/* X داخل نافذة العروض: أعلى اليمين + أحمر غامق */
#offersModal .close-modal-btn{
  top: 12px !important;
  right: 12px !important;
  left: auto !important;

  inset-inline-end: auto !important;   /* يلغي RTL اللي يوديه يسار */
  inset-inline-start: auto !important;

  background: #6b0000 !important;
  color: #fff !important;
}
#offersModal .close-modal-btn:hover{
  background: #8b0000 !important;
}

/* يزحف عنوان "العروض الجديدة" لليسار حتى ما يجي تحت زر الإغلاق */
#offersModal .offers-head h2{
  margin-right: 46px !important;  /* يزيد فراغ يمين ويزحف النص لليسار */
}


/* ✅ موبايل: طفي البلور والبلند واللمعة المتحركة */
@media (hover: none), (pointer: coarse), (max-width: 768px) {

  /* طفي blur لأنه أكثر سبب للومضة */
  #maintenance-overlay.activation-overlay {
    -webkit-backdrop-filter: none !important;
    backdrop-filter: none !important;
    background: rgba(0,0,0,0.75) !important; /* بديل أنيق بدون blur */
  }

  /* طفي اللمعة/البلند */
  #maintenance-overlay .activation-dialog::before {
    animation: none !important;
    mix-blend-mode: normal !important;
    opacity: 0.25 !important;
  }

  /* خفف تغييرات الفوكس اللي تسوي فلاش */
  #maintenance-overlay .activation-input-row,
  #maintenance-overlay .activation-input-row:focus-within {
    box-shadow: none !important;
    transition: border 0.15s ease, background 0.15s ease !important;
  }

  /* ✅ يمنع زوم iPhone (إذا الخط أقل من 16 يصير زوم وفلاش) */
  #maintenance-overlay input {
    font-size: 16px !important;
  }

  /* ✅ يمنع “الوميض الأزرق” مال اللمس */
  #maintenance-overlay, #maintenance-overlay * {
    -webkit-tap-highlight-color: transparent;
  }
}


/* ✅ ثبّت الأوفرلاي كطبقة كاملة فوق كلشي */
#maintenance-overlay.activation-overlay{
  position: fixed !important;
  inset: 0 !important;
  width: 100vw !important;
  height: 100dvh !important; /* مهم للموبايل */
  z-index: 999999 !important;
  background: rgba(0,0,0,0.78) !important;
  isolation: isolate; /* يمنع التداخل البصري */
  -webkit-backdrop-filter: none !important;
  backdrop-filter: none !important;
  overscroll-behavior: contain;
}

/* ✅ خَلّي نافذة الصيانة طبقة مستقرة وما تعيد رسم الواجهة تحت */
#maintenance-overlay .activation-dialog{
  transform: translate3d(0,0,0);
  will-change: transform;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  contain: layout paint; /* يمنع تسرب الرسم */
}

/* ✅ امنع قفزة التخطيط لما تظهر رسالة الخطأ */
#maintenance-overlay #maintenance-error-row{
  min-height: 18px;
}

/* ✅ اهتزاز ثلاثي الأبعاد (أقل مشاكل على الموبايل) */
#maintenance-overlay .activation-dialog.is-shaking{
  animation: maintenanceShake3d 0.35s ease;
}

@keyframes maintenanceShake3d{
  0%   { transform: translate3d(0,0,0); }
  20%  { transform: translate3d(-6px,0,0); }
  40%  { transform: translate3d(6px,0,0); }
  60%  { transform: translate3d(-4px,0,0); }
  80%  { transform: translate3d(4px,0,0); }
  100% { transform: translate3d(0,0,0); }
}


@media (hover: none), (pointer: coarse), (max-width: 768px) {

  /* ✅ ثبّت الأوفرلاي */
  #activation-overlay.activation-overlay{
    position: fixed !important;
    inset: 0 !important;
    width: 100vw !important;
    height: 100dvh !important;
    z-index: 999999 !important;
    background: rgba(0,0,0,0.78) !important;
    isolation: isolate;
    -webkit-backdrop-filter: none !important;
    backdrop-filter: none !important;
    overscroll-behavior: contain;
  }

  /* ✅ خَلّي النافذة طبقة مستقرة */
  #activation-overlay .activation-dialog{
    transform: translate3d(0,0,0);
    will-change: transform;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    contain: layout paint;
  }

  /* ✅ امنع قفزة التخطيط لما يظهر الخطأ */
  #activation-overlay #activation-error-row{
    min-height: 18px;
  }

  /* ✅ اهتزاز 3D يقلل الفلاش */
  #activation-overlay .activation-dialog.is-shaking{
    animation: activationShake3d 0.35s ease;
  }

  @keyframes activationShake3d{
    0%   { transform: translate3d(0,0,0); }
    20%  { transform: translate3d(-6px,0,0); }
    40%  { transform: translate3d(6px,0,0); }
    60%  { transform: translate3d(-4px,0,0); }
    80%  { transform: translate3d(4px,0,0); }
    100% { transform: translate3d(0,0,0); }
  }

  /* ✅ يمنع اللمعة/البلند إذا كانت موجودة بالـ ::before (نفس فكرة الصيانة) */
  #activation-overlay .activation-dialog::before{
    animation: none !important;
    mix-blend-mode: normal !important;
    opacity: 0.25 !important;
  }

  /* ✅ يمنع الوميض الأزرق */
  #activation-overlay, #activation-overlay * {
    -webkit-tap-highlight-color: transparent;
  }

  /* ✅ يمنع زوم iPhone اللي يسبب وميض */
  #activation-overlay input{
    font-size: 16px !important;
  }

  /* ✅ خفف الفوكس شادو */
  #activation-overlay .activation-input-row,
  #activation-overlay .activation-input-row:focus-within{
    box-shadow: none !important;
    transition: border 0.15s ease, background 0.15s ease !important;
  }
}


@media (hover: none), (pointer: coarse), (max-width: 768px) {
  /* يمنع المتصفح يسوي highlight/وميض وقت اللمس */
  #activation-overlay * { -webkit-tap-highlight-color: transparent; }

  /* يقفل أي سكرول داخل الأوفرلاي ويسوي طبقة ثابتة */
  #activation-overlay { touch-action: none; }

  /* يطفي أي outline افتراضي ممكن يسبب ومضة */
  #activation-overlay input:focus { outline: none !important; }
}

/* =========================
   TOAST فوق الهيدر (دارك)
========================= */
.swal2-container{
  z-index: 60000 !important;
}
.swal2-container.swal2-top,
.swal2-container.swal2-top-start,
.swal2-container.swal2-top-end{
  top: 8px !important;
}
.assal-toast{
  background: rgba(15, 23, 42, 0.96) !important;
  border: 1px solid rgba(255,255,255,0.10) !important;
  color: #e5e7eb !important;
  box-shadow: 0 14px 40px rgba(0,0,0,0.65) !important;
  border-radius: 14px !important;
  backdrop-filter: blur(14px) !important;
  font-family: 'Cairo', sans-serif !important;
}

/* =========================
   هيدر: أزرار أيقونات
========================= */
.header-btn.icon-btn{
  width: 34px;
  height: 34px;
  padding: 0;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius: 12px;
  font-size: 14px;
}
.header-btn.icon-btn i{ pointer-events:none; }

/* بادج السلة (أصغر وما يطلع برا) */
.cart-btn{ position: relative; }
.cart-badge{
  position: absolute;
  top: -5px;
  right: -5px;
  min-width: 16px;
  height: 16px;
  padding: 0 5px;
  border-radius: 999px;
  background: #ff3b6b;
  color: #fff;
  font-size: 10px;
  font-weight: 800;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow: 0 8px 18px rgba(0,0,0,0.5);
}

/* =========================
   زر "أضف للسلة" داخل الكارد
========================= */
.add-to-cart-btn{
  margin-top: 10px;
  width: 100%;
  border: none;
  border-radius: 12px;
  padding: 10px 12px;
  cursor: pointer;
  color: #e5e7eb;
  background: linear-gradient(135deg, rgba(67,206,162,0.9), rgba(24,90,157,0.9));
  box-shadow: 0 10px 25px rgba(0,0,0,0.35);
  font-family: 'Cairo', sans-serif;
  font-weight: 700;
  display:flex;
  align-items:center;
  justify-content:center;
  gap: 10px;
  transition: transform .15s ease;
}
.add-to-cart-btn:active{ transform: scale(0.97); }
.add-to-cart-btn:disabled{
  opacity: 0.45;
  cursor: not-allowed;
  filter: grayscale(0.4);
}

/* =========================
   نافذة السلة (دارك أنيقة)
========================= */
.swal2-popup.cart-popup{
  background: rgba(15, 23, 42, 0.96) !important;
  border: 1px solid rgba(255,255,255,0.10) !important;
  border-radius: 18px !important;
  box-shadow: 0 22px 70px rgba(0,0,0,0.75) !important;
  backdrop-filter: blur(18px) !important;
  color: #e5e7eb !important;
  font-family: 'Cairo', sans-serif !important;
}
.cart-wrap{ display:flex; flex-direction:column; gap:12px; }
.cart-head{
  display:flex; align-items:center; justify-content:space-between;
  gap:10px;
}
.cart-title{
  display:flex; align-items:center; gap:10px;
  font-size: 18px; font-weight: 800;
}
.cart-list{
  display:flex; flex-direction:column; gap:10px;
  max-height: 46vh; overflow:auto;
  padding-right: 2px;
}
.cart-item{
  display:flex; align-items:center; gap:10px;
  padding: 10px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,0.08);
  background: rgba(0,0,0,0.22);
}
.cart-item img{
  width: 46px; height: 46px; border-radius: 12px; object-fit: cover;
}
.cart-meta{ flex:1; text-align:right; }
.cart-name{ font-weight: 800; font-size: 14px; margin-bottom: 4px; }
.cart-sub{ font-size: 12px; opacity: 0.85; display:flex; gap:10px; justify-content:flex-end; flex-wrap:wrap; }
.qty-box{ display:flex; align-items:center; gap:8px; }
.qty-btn{
  width: 30px; height: 30px; border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.06);
  color:#e5e7eb;
  cursor:pointer;
}
.qty-num{ min-width: 18px; text-align:center; font-weight: 800; }
.cart-remove{
  border:none; background: transparent; color:#ff5a7a; cursor:pointer;
  font-size: 18px;
}
.cart-foot{
  display:flex; flex-direction:column; gap:10px;
  border-top: 1px solid rgba(255,255,255,0.10);
  padding-top: 10px;
}
.cart-total{
  display:flex; align-items:center; justify-content:space-between;
  font-weight: 900;
}
.cart-actions{
  display:flex; flex-wrap:wrap; gap:8px; justify-content:space-between;
}
.cart-action-btn{
  flex:1;
  border:none; border-radius: 12px;
  padding: 10px 12px;
  cursor:pointer;
  font-family:'Cairo', sans-serif;
  font-weight: 800;
  color:#e5e7eb;
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(255,255,255,0.10);
}
.cart-action-btn.primary{
  background: linear-gradient(135deg, rgba(67,206,162,0.9), rgba(24,90,157,0.9));
  border:none;
}
.cart-action-btn.danger{
  background: linear-gradient(135deg, rgba(255,65,108,0.9), rgba(255,75,43,0.9));
  border:none;
}

/* =========================
   قالب الفاتورة (Landscape) للحفظ كصورة
========================= */
.invoice-sheet{
  width: 1123px;   /* A4 landscape تقريباً على 96dpi */
  height: 794px;
  background: #0b1220;
  color: #e5e7eb;
  border: 1px solid rgba(255,255,255,0.10);
  border-radius: 18px;
  padding: 22px;
  font-family:'Cairo', sans-serif;
  box-shadow: 0 30px 90px rgba(0,0,0,0.75);
  position: relative;
  overflow: hidden;
}
.invoice-top{
  display:flex; justify-content:space-between; align-items:flex-start; gap:14px;
  margin-bottom: 16px;
}
.invoice-brand{
  display:flex; flex-direction:column; gap:6px;
}
.invoice-brand .name{
  font-size: 22px; font-weight: 900;
  background: linear-gradient(135deg, #43cea2, #185a9d);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}
.invoice-brand .meta{ font-size: 12px; opacity: 0.85; }
.invoice-badge{
  padding: 10px 14px;
  border-radius: 14px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.10);
  text-align:right;
  font-size: 12px;
}
.invoice-table{
  width: 100%;
  border-collapse: collapse;
  overflow:hidden;
  border-radius: 14px;
}
.invoice-table th, .invoice-table td{
  padding: 10px 10px;
  border-bottom: 1px solid rgba(255,255,255,0.10);
  font-size: 12px;
}
.invoice-table th{
  background: rgba(255,255,255,0.06);
  font-weight: 900;
}
.invoice-table td{ background: rgba(0,0,0,0.20); }
.invoice-bottom{
  margin-top: 14px;
  display:flex; justify-content:space-between; align-items:flex-end; gap:14px;
}
.invoice-note{
  font-size: 12px; opacity: 0.85;
  max-width: 60%;
}
.invoice-sum{
  min-width: 260px;
  padding: 12px 14px;
  border-radius: 14px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.10);
  text-align:right;
  font-weight: 900;
}










    </style>
</head>
<body>
  

<button id="scrollToTopBtn" class="scroll-to-top"><i class="fas fa-arrow-up"></i></button>

<!-- دائرة عائمة للعناصر الجديدة -->
<div id="newItemsFloatingBtn" class="floating-new-btn">
    <span>جديد</span>
    <div class="new-items-count"></div>
</div>

<!-- النافذة المنبثقة للعناصر الجديدة -->
<div id="newItemsModal">
    <button class="close-modal-btn" onclick="closeNewItemsModal()"><i class="fas fa-times"></i></button>
    <h2>العناصر الجديدة</h2>
    <div class="modal-content"></div>
</div>

<!-- نافذة العروض -->
<div id="offersModal" dir="rtl">
    <button class="close-modal-btn" onclick="closeOffersModal()"><i class="fas fa-times"></i></button>

    <div class="offers-head">
        <h2>العروض الجديدة</h2>
        <div class="offers-chip" id="offersCountChip">0 عرض</div>
    </div>

    <div class="offers-toolbar">
        <i class="fas fa-search"></i>
        <input id="offersSearchInput" type="text" placeholder="ابحث داخل العروض...">
    </div>

    <div class="offers-content"></div>
</div>


 
 <header class="header">
  <div class="header-title">مكتب عسل</div>

  <div class="header-buttons">
    <!-- سلة -->
    <button class="header-btn icon-btn cart-btn" onclick="openCart()" title="السلة">
      <i class="fas fa-shopping-cart"></i>
      <span id="cartBadge" class="cart-badge">0</span>
    </button>

    <!-- عروض -->
    <button class="header-btn icon-btn offers-btn" onclick="openOffersModal()" title="عروض">
      <i class="fas fa-tags"></i>
    </button>

    <!-- تحديث -->
    <button class="header-btn icon-btn refresh-btn" onclick="refreshData()" title="تحديث البيانات">
      <i class="fas fa-rotate"></i>
    </button>

    <!-- خروج -->
    <button class="header-btn icon-btn exit-btn" onclick="confirmExit()" title="خروج">
      <i class="fas fa-right-from-bracket"></i>
    </button>
  </div>
</header>

 
 
 <!-- ✅ الطبقة الضبابية Overlay -->


<!-- يبقى الـ overlay مثل ما هو -->
<div id="overlay"></div>

<!-- قالب إشعار عام -->
<div id="promoPopup" class="alert-shell alert-sale" dir="rtl">
    <div class="alert-header">
        <div class="alert-icon">
            <!-- غيّر الأيقونة حسب نوع الإشعار -->
            <i class="fas fa-tag"></i>
        </div>
        <div class="alert-head-text">
            <span class="alert-kicker">عرض خاص لزبائنا</span>
            <h1 class="alert-title">
                خصم ١٥٪ على شاشات سامسونج الأصلية
            </h1>
        </div>
    </div>

    <div class="alert-body">
        <p class="alert-text">
            العرض ساري لفترة محدودة على جميع الشاشات الأصلية
            المختارة، داخل التطبيق وعبر مكتب عسل حصرا ولكل الشركات.
        </p>

        <div class="alert-meta">
            <span class="alert-pill">
                <i class="fas fa-clock"></i>
                ينتهي العرض خلال فترة قصيرة
            </span>
            <span class="alert-pill">
                <i class="fas fa-store"></i>
                جميع الفروع
            </span>
        </div>
    </div>

    <div class="alert-footer">
        <button class="alert-secondary" onclick="closePopup()">
            إغلاق
        </button>
        <button class="alert-primary" onclick="closePopup()">
            شوف التفاصيل
        </button>
    </div>
</div>



    <div class="container">
      
      
      
    <!-- شعار دائري -->
   <div class="notification-container">
    <div class="logo-container" id="logo"> 
     <img src="images/logo.png" alt="Logo">
    </div>
    <div class="notification" id="notification">
        <div class="notification-text" id="notification-text"></div>
    </div>
</div>
    


<!-- شريط الأخبار -->
<div class="news-bar">
    <div class="breaking-news">🔥 تقنيات</div>
    <div class="news-ticker-container">
        <div class="news-ticker" id="newsTicker">جاري تحميل الأخبار...</div>
    </div>
</div>


        

      <div class="categories">
    <!-- زر أسعار بنمط الكروب -->
     <button class="new-category-btn" onclick="openLCDPage()"><i class="fas fa-list"></i> أسعار بنمط الكروب</button>
          <button class="category-btn tools-btn" onclick="openToolsPage()"><i class="fas fa-shopping-cart"></i> متجر عسل </button>
      <button class="category-btn" onclick="window.location.href='similarites.html'"><i class="fas fa-sync"></i> توافقات قطع الغيار  </button>
           <div class="slider-container">
    <button class="slider-btn prev-btn"><i class="fas fa-chevron-left"></i></button>
    <div class="slider" id="slider">
        <div class="category" onclick="filterCategory('LCD')">
            <i class="fas fa-tv"></i>
            <span>شاشات</span>
        </div>
        <div class="category" onclick="filterCategory('BATTERY')">
            <i class="fas fa-battery-full"></i>
            <span>بطاريات</span>
        </div>
        <div class="category" onclick="filterCategory('HOUSING')">
            <i class="fas fa-mobile-alt"></i>
            <span>شواصي</span>
        </div>
        <div class="category" onclick="filterCategory('BACK')">
            <i class="fas fa-tablet-alt"></i>
            <span>اظهر</span>
        </div>
        <div class="category" onclick="filterCategory('CAMERA')">
            <i class="fas fa-camera"></i>
            <span>كاميرا</span>
        </div>
        <div class="category" onclick="filterCategory('CHARGING')">
            <i class="fas fa-plug"></i>
            <span>شحن</span>
        </div>
        <div class="category" onclick="filterCategory('BUZZER')">
            <i class="fas fa-bell"></i>
            <span>جرس</span>
        </div>
        <div class="category" onclick="filterCategory('HEADPHONE')">
            <i class="fas fa-volume-up"></i>
            <span>سماعة</span>
        </div>


        <div class="category" onclick="filterCategory('FINGER')">
    <i class="fas fa-fingerprint"></i>
    <span>بصمة</span>
</div>



<div class="category" onclick="filterCategory('FLAT LCD')">
    <i class="fas fa-film"></i>
    <span>ش. شاشة</span>
</div>



<div class="category" onclick="filterCategory('POWER')">
    <i class="fas fa-power-off"></i>
    <span>ف. بور</span>
</div>


<div class="category" onclick="filterCategory('LENS')">
    <i class="fas fa-bullseye"></i>
    <span>عدسة</span>
</div>


<div class="category" onclick="filterCategory('VOLUME')">
    <i class="fas fa-sliders-h"></i>
    <span>ف. صوت</span>
</div>

<div class="category" onclick="filterCategory('SPEAKER')">
    <i class="fas fa-phone-volume"></i>
    <span>س. اتصال</span>
</div>


<div class="category" onclick="filterCategory('FLAT SPEAKER')">
    <i class="fas fa-phone-alt"></i>
    <span>ف. سماعة</span>
</div>


    </div>
    <button class="slider-btn next-btn"><i class="fas fa-chevron-right"></i></button>
</div>

</div>

        <div class="search-container">
    <input type="text" id="searchInput" placeholder="Search for items...">
    <button id="clearBtn" class="clear-btn" onclick="clearSearch()" style="display: none;"><i class="fas fa-times"></i></button>
    <button id="searchBtn" onclick="searchItems()"><i class="fas fa-search"></i></button>
</div>


        <div id="results" class="results"></div>

</div>




<footer>
    <p>&copy; 2025 Assal Office. All rights reserved.</p>
</footer>



    <script>
      




// دالة للتحكم في ظهور/إخفاء زر المسح
function toggleClearButton() {
    const searchInput = document.getElementById("searchInput");
    const clearBtn = document.getElementById("clearBtn");
    
    if (searchInput.value.trim().length > 0) {
        clearBtn.style.display = "flex"; // إظهار الزر عند الكتابة
    } else {
        clearBtn.style.display = "none"; // إخفاء الزر إذا الحقل فارغ
    }
}

// دالة لمسح حقل البحث
function clearSearch() {
    const searchInput = document.getElementById("searchInput");
    const resultsContainer = document.getElementById("results");
    
    searchInput.value = ""; // تفريغ الحقل
    resultsContainer.style.display = "none"; // إخفاء النتائج
    toggleClearButton(); // تحديث حالة زر المسح
    toggleScrollToTopButton(); // تحديث زر الرجوع لأعلى
}

// ربط حدث الكتابة بحقل البحث
document.getElementById("searchInput").addEventListener("input", toggleClearButton);

// التأكد من حالة الزر عند تحميل الصفحة
document.addEventListener("DOMContentLoaded", toggleClearButton);
      

// جعل الدائرة قابلة للسحب
const floatingBtn = document.getElementById("newItemsFloatingBtn");
let isDragging = false;
let isDraggingInitiated = false; // متغير لتتبع ما إذا حدث سحب
let baseX, baseY; // الموقع الأساسي عند بدء السحب
let startX, startY;
const dragThreshold = 5; // عتبة الحركة (بالبكسل)
let touchStartTime; // لتتبع وقت بدء اللمس


// إعداد الموقع الأولي بناءً على `left` و`bottom`

floatingBtn.style.left = "20px";
floatingBtn.style.bottom = "50px";


// تحديث القيم الأولية بناءً على الموقع الفعلي
const updateInitialPosition = () => {
    const rect = floatingBtn.getBoundingClientRect();
    baseX = rect.left; // الموقع الأساسي في بداية السحب
    baseY = rect.top;
};


updateInitialPosition(); // تهيئة القيم عند التحميل

floatingBtn.addEventListener("mousedown", startDragging);
floatingBtn.addEventListener("touchstart", startDragging);

function startDragging(e) {
    e.preventDefault();
    isDragging = true;
    isDraggingInitiated = false;
    updateInitialPosition(); // إعادة تحديث القيم الأولية عند بدء السحب
    if (e.type === "touchstart") {
        startX = e.touches[0].clientX;
        startY = e.touches[0].clientY;
        touchStartTime = Date.now(); // تسجيل وقت بدء اللمس
    } else {
        startX = e.clientX;
        startY = e.clientY;
    }
    floatingBtn.style.cursor = "grabbing";
    floatingBtn.style.transition = "none"; // إزالة أي انتقال (transition) أثناء السحب
}

document.addEventListener("mousemove", drag);
document.addEventListener("touchmove", drag);

function drag(e) {
    if (isDragging) {
        e.preventDefault();
        let newX, newY;
        if (e.type === "touchmove") {
            newX = e.touches[0].clientX;
            newY = e.touches[0].clientY;
        } else {
            newX = e.clientX;
            newY = e.clientY;
        }

        const deltaX = Math.abs(newX - startX);
        const deltaY = Math.abs(newY - startY);
        if (deltaX > dragThreshold || deltaY > dragThreshold) {
            isDraggingInitiated = true;

            // حساب الموقع الجديد بناءً على الفرق النسبي من الموقع الأساسي
            const offsetX = newX - startX;
            const offsetY = newY - startY;
            let currentX = baseX + offsetX;
            let currentY = baseY + offsetY;

            const maxX = window.innerWidth - floatingBtn.offsetWidth;
            const maxY = window.innerHeight - floatingBtn.offsetHeight;
            currentX = Math.max(0, Math.min(currentX, maxX));
            currentY = Math.max(0, Math.min(currentY, maxY));

            floatingBtn.style.left = currentX + "px";
            floatingBtn.style.top = currentY + "px";
            floatingBtn.style.right = "auto";
            floatingBtn.style.bottom = "auto";
        }
    }
}

document.addEventListener("mouseup", stopDragging);
document.addEventListener("touchend", stopDragging);

function stopDragging(e) {
    if (isDragging) {
        isDragging = false;
        floatingBtn.style.cursor = "pointer";
        updateInitialPosition(); // تحديث الموقع الأساسي بعد انتهاء السحب

        // التحقق مما إذا كان النقر باللمس (tap) وليس سحب
        if (e.type === "touchend" && !isDraggingInitiated) {
            const touchEndTime = Date.now();
            const touchDuration = touchEndTime - touchStartTime;

            // إذا كانت مدة اللمس قصيرة (أقل من 300 مللي ثانية)، نعتبرها نقرة
            if (touchDuration < 300) {
                openModal();
            }
        }
    }
}

// متغير لتتبع حالة النافذة
let isModalOpen = false;

// فتح نافذة العناصر الجديدة
function openModal() {
    try {
        if (isModalOpen) return; // إذا مفتوحة لا تفتحها مرة ثانية

        const modal = document.getElementById("newItemsModal");
        const overlay = document.getElementById("overlay"); // نفس تظليل الإعلان

        // شغّل التظليل
        if (overlay) {
            overlay.style.display = "block";
        }

        // افتح النافذة مع الأنيميشن
        modal.style.display = "flex";
        modal.style.animation = "slideDownModal 0.5s ease-out forwards";

        isModalOpen = true;
        loadNewItems(); // مثل ما كان عندك
    } catch (error) {
        console.error("Error in openModal:", error);
    }
}



// إغلاق نافذة العناصر الجديدة
function closeNewItemsModal() {
    try {
        const modal   = document.getElementById("newItemsModal");
        const overlay = document.getElementById("overlay");
        const promo   = document.getElementById("promoPopup"); // إعلان الخصم

        // حركة الخروج
        modal.style.animation = "slideUpModal 0.5s ease-in forwards";

        setTimeout(() => {
            modal.style.display = "none";
            isModalOpen = false;

            if (overlay) {
                // إذا ماكو إعلان مفتوح حالياً، طفي التظليل
                if (!promo || promo.style.display !== "flex") {
                    overlay.style.display = "none";
                }
            }
        }, 500); // نفس وقت الأنيميشن

    } catch (error) {
        console.error("Error in closeNewItemsModal:", error);
        isModalOpen = false;

        // بحالة الخطأ نضمن نطفي التظليل
        const overlay = document.getElementById("overlay");
        if (overlay) overlay.style.display = "none";
    }
}

let isOffersModalOpen = false;
let offersCache = [];

function openOffersModal(){
    try{
        if (isOffersModalOpen) return;

        const modal = document.getElementById("offersModal");
        const overlay = document.getElementById("overlay"); // نفس overlay مالك

        if (overlay) overlay.style.display = "block";

        modal.style.display = "flex";
        modal.style.animation = "slideDownModal 0.5s ease-out forwards";

        isOffersModalOpen = true;
        loadOffers();
    }catch(err){
        console.error("Error in openOffersModal:", err);
    }
}

function closeOffersModal(){
    try{
        const modal   = document.getElementById("offersModal");
        const overlay = document.getElementById("overlay");
        const promo   = document.getElementById("promoPopup");
        const newItemsModal = document.getElementById("newItemsModal");

        modal.style.animation = "slideUpModal 0.5s ease-in forwards";

        setTimeout(() => {
            modal.style.display = "none";
            isOffersModalOpen = false;

            if (overlay) {
                const isPromoOpen = promo && promo.style.display === "flex";
                const isNewOpen = newItemsModal && newItemsModal.style.display === "flex";
                if (!isPromoOpen && !isNewOpen) overlay.style.display = "none";
            }
        }, 500);
    }catch(err){
        console.error("Error in closeOffersModal:", err);
        isOffersModalOpen = false;
        const overlay = document.getElementById("overlay");
        if (overlay) overlay.style.display = "none";
    }
}

function loadOffers(){
    const modal = document.getElementById("offersModal");
    const container = modal.querySelector(".offers-content");
    const chip = document.getElementById("offersCountChip");

    container.innerHTML = "";

    // نفس فكرة اللستة مالتك (وأضفت LENS + LNES حتى ما نضيع شي)
    const categories = ["LCD","HUAWEI","BATTERY","HOUSING","BACK","CAMERA","CHARGING","BUZZER","HEADPHONE","FINGER","FLAT LCD","POWER","LENS","LNES","VOLUME","SPEAKER","FLAT SPEAKER"];

    let offers = [];

    categories.forEach(category => {
        if (!database[category]) return;

        database[category].forEach(item => {
            const originalPriceRaw = item["Price"];
            const discountPriceRaw = item["Discount Price"];

            if (!originalPriceRaw || !discountPriceRaw) return;

            const pNum = parseFloat(String(originalPriceRaw).replace(/,/g,'').trim());
            const dNum = parseFloat(String(discountPriceRaw).replace(/,/g,'').trim());
            if (isNaN(pNum) || isNaN(dNum)) return;

            const saving = Math.max(0, pNum - dNum);
            offers.push({ item, category, saving });
        });
    });

    // رتب من الأعلى توفيراً
    offers.sort((a,b) => (b.saving - a.saving));

    offersCache = offers;

    chip.textContent = `${offers.length} عرض`;

    if (offers.length === 0){
        container.innerHTML = `
            <div style="padding:18px;text-align:center;color:#e5e7eb;font-family:'Cairo',sans-serif;">
                حالياً ماكو عروض مضافة 🙃
            </div>
        `;
        return;
    }

    renderOffers(offers);
}

function renderOffers(list){
    const modal = document.getElementById("offersModal");
    const container = modal.querySelector(".offers-content");

    let html = "";

    list.forEach(({item, category, saving}) => {
        const name = item["Item Name"] || item["Item"] || "بدون اسم";

        // نفس تنسيق عرض الأسعار عندك بـ displayResults :contentReference[oaicite:4]{index=4}
        const originalFormatted = item["Price"].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        const discountFormatted = item["Discount Price"].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

        const savingFormatted = saving.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

        const iconClass = (typeof getCategoryIcon === "function") ? getCategoryIcon(category) : "fas fa-tag";

        const priceHtml = `
            <div class="price-row">
                <p class="old-price-pill">
                    <span class="old-price-text">${originalFormatted} د.ع</span>
                </p>
                <p class="new-price-pill">
                    <span class="new-price-text new-price-label">عرض خاص</span>
                    <span class="new-price-text new-price-value">${discountFormatted} د.ع</span>
                </p>
            </div>
        `;

        html += `
            <div class="offer-card">
                <div class="offer-top">
                    <div class="offer-icon"><i class="${iconClass}"></i></div>
                    <div style="flex:1;min-width:0">
                        <div class="offer-title">${name}</div>
                        <div class="offer-meta">
                            <span class="offer-tag">${category}</span>
                            ${saving > 0 ? `<span class="offer-save">وفر ${savingFormatted} د.ع</span>` : ``}
                        </div>
                    </div>
                </div>

                <div class="offer-prices">
                    ${priceHtml}
                </div>
            </div>
        `;
    });

    container.innerHTML = html;
}

/* بحث داخل العروض */
document.addEventListener("DOMContentLoaded", () => {
    const input = document.getElementById("offersSearchInput");
    if (!input) return;

    input.addEventListener("input", () => {
        const q = input.value.trim().toLowerCase();
        const filtered = offersCache.filter(x => {
            const name = (x.item["Item Name"] || x.item["Item"] || "").toString().toLowerCase();
            return name.includes(q);
        });
        renderOffers(filtered);
    });

    input.addEventListener("keydown", (e) => {
        if (e.key === "Enter") e.preventDefault();
    });
});





// معالج النقر بالماوس
floatingBtn.addEventListener("click", (e) => {
    if (!isDraggingInitiated) {
        openModal();
    }
    isDraggingInitiated = false; // إعادة تعيين بعد النقر
});

      
 const notifications = [
    "شاشات KBS 👌 ضمان بعد الشد",
    "شاشات FLYCDI 🔥 ضمان بعد الشد",
    "تره أسعارنا الأرخص بالمحافظة 😉",
    "متانة وجودة ✨ وسعر يبرد الگلب",
    "مكتب عسل .. خبرة سنين بالقطع",
    "مو الوحيدين.. بس إحنا الأفضل 😎",
    "مكتب عسل اسم بالثقة والقطع",
    "شاشات قوية 💪 وياها ضمان كامل",
    "أرخص سعر 🔧 وأعلى جودة",
    "مكتب عسل الأول بالثقة 👍",
    "خبرتنا كفيلة ترضيك دومًا ✨",
    "FLYCDI شاشات ما إلها مثيل 🔥",
    "مكتبنا عنوان التميّز بالمحافظة",
    "أسعار تخلي الكل راضي 😍",
    "KBS الشاشات الأقوى بالسوق",
    "الجودة موجودة .. والتكلفة قليلة 💰"
];


function triggerAnimation() {
    const logo = document.getElementById("logo");
    const notification = document.getElementById("notification");
    const notificationText = document.getElementById("notification-text");
    const resultsContainer = document.getElementById("results");
    const searchInput = document.getElementById("searchInput");

    // إذا كانت النتائج معروضة أو يوجد نص في حقل البحث، نؤخر الانفجار
    if (!logo || !notification || !notificationText || 
        resultsContainer.style.display === "flex" || 
        searchInput.value.trim().length > 0) {
        setTimeout(triggerAnimation, 100); // تأخير بسيط جدًا
        return;
    }

    // اهتزاز اللوغو
    logo.style.animation = "shake 0.5s ease-in-out";
    setTimeout(() => {
        logo.style.animation = "none";
    }, 500);

    // انفجار اللوغو واختفاءه
    setTimeout(() => {
        logo.style.animation = "explode 0.5s ease-out";
        logo.style.opacity = "0";
    }, 800);

    // عرض الإشعار
    setTimeout(() => {
        const randomNotification = notifications[Math.floor(Math.random() * notifications.length)];
        notificationText.textContent = randomNotification;
        notification.classList.add("show");
    }, 1300);

    // اختفاء الإشعار بانيميشن GSAP
    setTimeout(() => {
        notification.classList.remove("show");
        gsap.to(notification, {
            scale: 0.8,
            opacity: 0,
            rotation: 180,
            duration: 0.8,
            ease: "power2.inOut",
            onComplete: () => {
                notification.style.transform = "scale(0)";
            }
        });
    }, 5000);

    // إعادة اللوغو من جديد (بدون دوران - يظهر فجأة)
    setTimeout(() => {
        gsap.set(logo, { scale: 0, opacity: 0 }); // ماكو rotation
        gsap.to(logo, {
            scale: 1,
            opacity: 1,
            duration: 1.2,
            ease: "bounce.out"
        });
    }, 5800);

    setTimeout(triggerAnimation, 8000);
}



      
    // ✅ قفل الصيانة: true = تظهر نافذة الصيانة وتمنع الدخول، false = طبيعي
let maintenanceLock = false;

// ✅ سماح مؤقت للأدمن (جلسة المتصفح الحالية فقط)
const maintenanceBypassKey = 'maintenanceBypass';

// ✅ كلمة أدمن الصيانة (لا تخليها 112233)
const MAINTENANCE_ADMIN_PASSWORD = '445566';


const activatedBackupKey = 'isActivatedBackup';





// ✅ يبقى محفوظ بالجهاز
const MAINTENANCE_BYPASS_TTL_HOURS = 24; // "بعد فترة" = 24 ساعة (غيّرها إذا تريد)

function getMaintenanceBypass() {
    // أولاً إذا موجود بالجلسة
    if (sessionStorage.getItem(maintenanceBypassKey) === 'true') return true;

    // ثانياً إذا محفوظ بالجهاز
    const raw = localStorage.getItem(maintenanceBypassKey);
    if (!raw) return false;

    try {
        const data = JSON.parse(raw);
        if (!data || data.ok !== true || !data.ts) return false;

        const age = Date.now() - data.ts;
        const maxAge = MAINTENANCE_BYPASS_TTL_HOURS * 60 * 60 * 1000;

        // انتهت الصلاحية -> لازم يطلب مرة ثانية
        if (age > maxAge) return false;

        return true;
    } catch (e) {
        return false;
    }
}

function setMaintenanceBypass() {
    const payload = { ok: true, ts: Date.now() };
    localStorage.setItem(maintenanceBypassKey, JSON.stringify(payload));
    sessionStorage.setItem(maintenanceBypassKey, 'true');
}

function clearMaintenanceBypass() {
    localStorage.removeItem(maintenanceBypassKey);
    sessionStorage.removeItem(maintenanceBypassKey);
}






      
      
 let showPromoPopup = true; // 🔥 يتحكم فقط في النافذة المنبثقة، false = تعطيل النافذة
let promoAlreadyShown = sessionStorage.getItem('promoShown') === 'true';

window.onload = function() {

    // ✅ إذا الصيانة مطفية: امسح bypass + رجّع التفعيل إذا كان محفوظ قبل الصيانة
    if (!maintenanceLock) {
        clearMaintenanceBypass();

        // ✅ Restore: إذا انمسح isActivated أثناء الصيانة، رجّعه من النسخة الاحتياطية
        if (localStorage.getItem('isActivated') !== 'true' &&
            localStorage.getItem(activatedBackupKey) === 'true') {
            localStorage.setItem('isActivated', 'true');
            localStorage.removeItem(activatedBackupKey);
        }
    }

    const bypass = getMaintenanceBypass();
    const isActivated = localStorage.getItem('isActivated') === 'true';

    // ✅ أول شرط: إذا صيانة شغالة وماكو أدمن => امنع الدخول للجميع (حتى لو مفعل سابقاً)
    if (maintenanceLock && !bypass) {

        // ✅ Backup: إذا المستخدم كان مفعل قبل الصيانة، خزّن نسخة حتى ما يضيع تفعيله
        if (localStorage.getItem('isActivated') === 'true') {
            localStorage.setItem(activatedBackupKey, 'true');
        }

        showMaintenancePopup();
        return;
    }

    // ✅ إذا مو مفعل وماكو bypass => نافذة 112233
    if (!isActivated && !bypass) {
        showActivationPopup();
        return;
    }

    // ✅ هنا طبيعي يدخل
    triggerAnimation();

    if (showPromoPopup && !promoAlreadyShown) {
        setTimeout(() => {
            let popup = document.getElementById('promoPopup');
            popup.style.display = 'flex';
            popup.style.animation = 'slideDown 0.6s ease-out forwards';
            document.getElementById('overlay').style.display = 'block';
        }, 500);
        sessionStorage.setItem('promoShown', 'true');
    }

    loadExcelFiles().then(result => {
        if (result.success) {
            console.log("تم تحميل البيانات بنجاح، جارٍ تحميل العناصر الجديدة.");
            loadNewItems();
        } else {
            console.warn("فشل تحميل البيانات:", result.message);
        }
    });
};








async function showActivationPopup() {
    // إذا التطبيق مفعّل مسبقاً، لا تفتح النافذة
    if (localStorage.getItem('isActivated') === 'true') {
        return;
    }

    let overlay = document.getElementById('activation-overlay');

    // أول مرة نجي، ننشئ هيكل النافذة
    if (!overlay) {
        const template = `
            <div id="activation-overlay" class="activation-overlay">
                <div class="activation-dialog" dir="rtl">
                    <div class="activation-logo">
                        <div class="activation-logo-ring">
                            <div class="activation-logo-core">
                                <!-- تقدر تخلي حرف A أو أيقونة قفل أو شعار مكتبك -->
                                <i class="fa-solid fa-lock"></i>
                            </div>
                        </div>
                    </div>

                    <div class="activation-header">
                        <div class="activation-label">Secure Access</div>
                        <div class="activation-title">تأكيد الدخول للتطبيق</div>
                        <div class="activation-subtitle">
                            الوصول مخصص لزبائن مكتب عسل فقط.
                        </div>
                    </div>

                    <div class="activation-body">
                        <p class="activation-text">
                            حتى نحافظ على سرّية الأسعار وشغل المكتب، الدخول للتطبيق يحتاج كلمة مرور
                            تستلمها مباشرة من مكتب عسل. اكتب الكلمة هنا وتوكل على الله.
                        </p>

                        <label class="activation-field-label" for="activation-password-input">
                            كلمة المرور
                        </label>

                        <div class="activation-input-row">
                            <input
                                id="activation-password-input"
                                type="password"
                                autocomplete="off"
                                placeholder="اكتب كلمة المرور هنا"
                            />
                            <button
                                type="button"
                                class="activation-toggle-password"
                                aria-label="إظهار / إخفاء كلمة المرور"
                            >
                                <i class="fa-regular fa-eye"></i>
                            </button>
                        </div>

                        <div class="activation-error" id="activation-error-row"></div>
                    </div>

                    <div class="activation-footer">
                        <button
                            type="button"
                            id="activation-confirm-btn"
                            class="activation-btn primary"
                        >
                            تأكيد الدخول
                        </button>

                        <button
                            type="button"
                            id="activation-cancel-btn"
                            class="activation-btn ghost"
                        >
                            إغلاق التطبيق
                        </button>
                    </div>
                </div>
            </div>
        `;

        document.body.insertAdjacentHTML('beforeend', template);
        overlay = document.getElementById('activation-overlay');

        const dialog        = overlay.querySelector('.activation-dialog');
        const passwordInput = document.getElementById('activation-password-input');
        const errorRow      = document.getElementById('activation-error-row');
        const confirmBtn    = document.getElementById('activation-confirm-btn');
        const cancelBtn     = document.getElementById('activation-cancel-btn');
        const toggleBtn     = overlay.querySelector('.activation-toggle-password');

        const focusNoScroll = () => {
            setTimeout(() => {
                try {
                    passwordInput.focus({ preventScroll: true });
                } catch (e) {
                    passwordInput.focus();
                }
            }, 50);
        };

        const setError = (msg) => {
            errorRow.textContent = msg || '';
            dialog.classList.remove('is-shaking');
            if (msg) {
                // نعيد تشغيل أنيميشن الاهتزاز
                void dialog.offsetWidth;
                dialog.classList.add('is-shaking');
            }
        };

        // زر العين – إظهار/إخفاء كلمة المرور
        toggleBtn.addEventListener('click', () => {
            const isPassword = passwordInput.type === 'password';
            passwordInput.type = isPassword ? 'text' : 'password';
            toggleBtn.innerHTML = isPassword
                ? '<i class="fa-regular fa-eye-slash"></i>'
                : '<i class="fa-regular fa-eye"></i>';
            focusNoScroll(); // ✅ بدل focus العادي
        });

        // زر تأكيد الدخول
        confirmBtn.addEventListener('click', () => {
            const value = (passwordInput.value || '').trim();

            if (!value) {
                setError('رجاءً اكتب كلمة المرور أولاً.');
                focusNoScroll(); // ✅ بدل focus العادي
                return;
            }

            // نفس كلمة المرور القديمة بالضبط
            if (value === '112233') {
                // ✅ تفعيل التطبيق
                localStorage.setItem('isActivated', 'true');
                setError('');
                dialog.classList.remove('is-shaking');

                // 🎉 عرض شاشة نجاح عالمية داخل نفس النافذة
                dialog.classList.add('is-success');
                dialog.innerHTML = `
                    <div class="activation-success" dir="rtl">
                        <div class="activation-success-icon">
                            <div class="activation-success-inner">
                                <i class="fa-solid fa-check"></i>
                            </div>
                        </div>
                        <div class="activation-success-title">تم التفعيل بنجاح</div>
                        <div class="activation-success-text">
                            تم تفعيل تطبيق عسل لحسابك. خلال لحظات راح نفتح لك الواجهة الرئيسية
                            وتكمل شغلك براحتك.
                        </div>
                    </div>
                `;

                // بعد الأنيميشن نعيد تحميل الصفحة
                setTimeout(() => {
                    overlay.classList.remove('is-open');

                    // ✅ فتح السكرول قبل الريلود
                    document.documentElement.style.overflow = '';
                    document.body.style.overflow = '';

                    setTimeout(() => {
                        location.reload();
                    }, 150);
                }, 1600);
            } else {
                // كلمة مرور خاطئة
                setError('كلمة المرور غير صحيحة. تأكد منها وجرب مرة ثانية.');
                passwordInput.select();
            }
        });

        // زر إغلاق التطبيق (نفس فكرة "لازم تفعّل")
        cancelBtn.addEventListener('click', () => {
            setError('لا يمكنك استخدام التطبيق بدون تفعيل. راجع مكتب عسل للحصول على كلمة المرور.');
            focusNoScroll(); // ✅ بدل focus العادي
        });

        // إنتر = تأكيد
        passwordInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                confirmBtn.click();
            }
        });
    }

    // كل مرة ننادي showActivationPopup نعرض النافذة
    overlay.classList.add('is-open');

    // ✅ قفل السكرول أول ما تنفتح النافذة
    document.documentElement.style.overflow = 'hidden';
    document.body.style.overflow = 'hidden';

    const input = document.getElementById('activation-password-input');
    const error = document.getElementById('activation-error-row');

    if (error) error.textContent = '';
    if (input) {
        input.value = '';

        // ✅ فوكس بدون سكرول لتقليل وميض الموبايل
        setTimeout(() => {
            try {
                input.focus({ preventScroll: true });
            } catch (e) {
                input.focus();
            }
        }, 50);
    }
}





// ✅ حركة الخروج بنفس مسار النزول (لأعلى)
function closePopup() {
    let popup = document.getElementById('promoPopup');
    popup.style.animation = 'slideUp 0.6s ease-in forwards';

    setTimeout(() => {
        popup.style.display = 'none';
        document.getElementById('overlay').style.display = 'none';
    }, 600); // ⏳ وقت متزامن مع الأنيميشن لضمان خروج سلس
}



function showMaintenancePopup() {
    let overlay = document.getElementById('maintenance-overlay');

    if (!overlay) {
        const template = `
            <div id="maintenance-overlay" class="activation-overlay">
                <div class="activation-dialog" dir="rtl">
                    <div class="activation-logo">
                        <div class="activation-logo-ring">
                            <div class="activation-logo-core">
                                <i class="fa-solid fa-screwdriver-wrench"></i>
                            </div>
                        </div>
                    </div>

                    <div class="activation-header">
                        <div class="activation-label">Maintenance Mode</div>
                        <div class="activation-title">التطبيق تحت الصيانة</div>
                        <div class="activation-subtitle">الدخول فقط لكادر عسل</div>
                    </div>

                    <div class="activation-body">
                        <p class="activation-text">
                            حالياً التطبيق متوقف للصيانة والتحديثات.
                            إذا انت من الكادر، سجل دخول أدمن.
                        </p>

                        <label class="activation-field-label" for="maintenance-admin-input">
                            دخول أدمن
                        </label>

                        <div class="activation-input-row">
                            <input
                                id="maintenance-admin-input"
                                type="password"
                                autocomplete="off"
                                placeholder="اكتب كلمة الأدمن"
                            />
                            <button
                                type="button"
                                class="activation-toggle-password"
                                aria-label="إظهار / إخفاء كلمة المرور"
                                id="maintenance-toggle-btn"
                            >
                                <i class="fa-regular fa-eye"></i>
                            </button>
                        </div>

                        <div class="activation-error" id="maintenance-error-row"></div>
                    </div>

                    <div class="activation-footer">
                        <button type="button" id="maintenance-enter-btn" class="activation-btn primary">
                            دخول
                        </button>

                        <button type="button" id="maintenance-close-btn" class="activation-btn ghost">
                            إغلاق
                        </button>
                    </div>
                </div>
            </div>
        `;

        document.body.insertAdjacentHTML('beforeend', template);
        overlay = document.getElementById('maintenance-overlay');

        const dialog     = overlay.querySelector('.activation-dialog');
        const adminInput = document.getElementById('maintenance-admin-input');
        const errorRow   = document.getElementById('maintenance-error-row');
        const enterBtn   = document.getElementById('maintenance-enter-btn');
        const closeBtn   = document.getElementById('maintenance-close-btn');
        const toggleBtn  = document.getElementById('maintenance-toggle-btn');

        const setError = (msg) => {
            errorRow.textContent = msg || '';
            dialog.classList.remove('is-shaking');
            if (msg) {
                void dialog.offsetWidth;
                dialog.classList.add('is-shaking');
            }
        };

        toggleBtn.addEventListener('click', () => {
            const isPassword = adminInput.type === 'password';
            adminInput.type = isPassword ? 'text' : 'password';
            toggleBtn.innerHTML = isPassword
                ? '<i class="fa-regular fa-eye-slash"></i>'
                : '<i class="fa-regular fa-eye"></i>';
            adminInput.focus();
        });

        enterBtn.addEventListener('click', () => {
            const entered = (adminInput.value || '').trim();

            if (!entered) {
                setError('رجاءً اكتب كلمة الأدمن أولاً.');
                adminInput.focus();
                return;
            }

            // ✅ هنا كلمة الأدمن الخاصة بالصيانة فقط
            if (entered === MAINTENANCE_ADMIN_PASSWORD) {
                setMaintenanceBypass(); // ✅ التعديل: ينحفظ بالجهاز وما يطلبه كل مرة
                setError('');
                overlay.classList.remove('is-open');

                // ✅ فتح السكرول قبل الريلود
                document.documentElement.style.overflow = '';
                document.body.style.overflow = '';

                setTimeout(() => location.reload(), 150);
            } else {
                setError('كلمة الأدمن غير صحيحة.');
                adminInput.select();
            }
        });

        closeBtn.addEventListener('click', () => {
            setError('التطبيق تحت الصيانة. الدخول متاح فقط للأدمن.');
            adminInput.focus();
        });

        adminInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                enterBtn.click();
            }
        });
    }

    overlay.classList.add('is-open');

    // ✅ قفل السكرول أول ما تنفتح النافذة
    document.documentElement.style.overflow = 'hidden';
    document.body.style.overflow = 'hidden';

    const adminInput = document.getElementById('maintenance-admin-input');
    const error = document.getElementById('maintenance-error-row');

    if (error) error.textContent = '';
    if (adminInput) {
        adminInput.value = '';
        adminInput.focus();
    }
}







// إغلاق النافذة أو الإعلان عند الضغط على الخلفية الضبابية
document.addEventListener("DOMContentLoaded", () => {
    const overlay = document.getElementById("overlay");
    if (!overlay) return;

    overlay.addEventListener("click", () => {
        const modal = document.getElementById("newItemsModal");
        const promo = document.getElementById("promoPopup");

        if (modal && modal.style.display === "flex") {
            closeNewItemsModal();
        } else if (promo && promo.style.display === "flex") {
            // دالة الإعلان الموجودة عندك
            if (typeof closePopup === "function") {
                closePopup();
            }
        }
    });
});





const slider = document.getElementById('slider');
const prevBtn = document.querySelector('.prev-btn');
const nextBtn = document.querySelector('.next-btn');

prevBtn.addEventListener('click', () => {
    slider.scrollBy({ left: -100, behavior: 'smooth' });
});

nextBtn.addEventListener('click', () => {
    slider.scrollBy({ left: 100, behavior: 'smooth' });
});

function filterCategory(category) {
    alert("تم اختيار: " + category);
}

        
   const dropboxMainFile = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSZww_ZDcqXnX6pUjlKccZdFUkRR9Z_JmfmdvNsnGVYT_rq_RTsSB1ydTy6QVrrS_o4s_ml1DNBTnaQ/pub?output=xlsx&t=" + Date.now();

        let database = {};
        let currentCategory = null;

async function loadExcelFiles() {
    try {
        if (!dropboxMainFile) {
            console.error("رابط ملف Excel غير معرف.");
            Swal.fire({
                title: 'خطأ',
                html: '<p style="color: #ff4d4d;">رابط ملف Excel غير معرف. يرجى التحقق من الاتصال.</p>',
                iconHtml: '<i class="fas fa-exclamation-circle"></i>',
                confirmButtonText: 'موافق',
                customClass: {
                    popup: 'swal2-popup',
                    title: 'swal2-title',
                    htmlContainer: 'swal2-html-container',
                    confirmButton: 'swal2-confirm'
                }
            });
            return { success: true, hasData: false, message: "رابط ملف Excel غير معرف." };
        }

        console.log("جارٍ تحميل ملف Excel من:", dropboxMainFile);
        const mainResponse = await fetch(dropboxMainFile, { cache: 'no-store' });
        if (!mainResponse.ok) {
            console.error(`فشل تحميل ملف Excel: ${mainResponse.status} ${mainResponse.statusText}`);
            Swal.fire({
                title: 'خطأ في التحميل',
                html: `<p style="color: #ff4d4d;">فشل تحميل البيانات: ${mainResponse.status} - ${mainResponse.statusText}</p>`,
                iconHtml: '<i class="fas fa-exclamation-circle"></i>',
                confirmButtonText: 'موافق',
                customClass: {
                    popup: 'swal2-popup',
                    title: 'swal2-title',
                    htmlContainer: 'swal2-html-container',
                    confirmButton: 'swal2-confirm'
                }
            });
            return { success: true, hasData: false, message: `فشل تحميل ملف Excel: ${mainResponse.status}` };
        }

        const mainBuffer = await mainResponse.arrayBuffer();
        const mainWorkbook = XLSX.read(mainBuffer, { type: "array" });

        // تهيئة الكائن database
        database = {
            LCD: [],
            HUAWEI: [],
            BATTERY: [],
            HOUSING: [],
            BACK: [],
            CAMERA: [],
            CHARGING: [],
            BUZZER: [],
            HEADPHONE: [],
            FINGER: [],
            "FLAT LCD": [],
            POWER: [],
            LENS: [],
            VOLUME: [],
            SPEAKER: [],
            "FLAT SPEAKER": []
            
        };

        // تحميل البيانات من كل ورقة
        database.LCD = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["LCD"] || {}, { defval: null });
        database.HUAWEI = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["HUAWEI"] || {}, { defval: null });
        database.BATTERY = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["BATTERY"] || {}, { defval: null });
        database.HOUSING = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["HOUSING"] || {}, { defval: null });
        database.BACK = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["BACK"] || {}, { defval: null });
        database.CAMERA = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["CAMERA"] || {}, { defval: null });
        database.CHARGING = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["CHARGING"] || {}, { defval: null });
        database.BUZZER = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["BUZZER"] || {}, { defval: null });
        database.HEADPHONE = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["HEADPHONE"] || {}, { defval: null });
        database.FINGER = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["FINGER"] || {}, { defval: null });
        database["FLAT LCD"] = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["FLAT LCD"] || {}, { defval: null });
        database.POWER = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["POWER"] || {}, { defval: null });
        database.LENS = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["LENS"] || {}, { defval: null });
        database.VOLUME = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["VOLUME"] || {}, { defval: null });
        database.SPEAKER = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["SPEAKER"] || {}, { defval: null });
        database["FLAT SPEAKER"] = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["FLAT SPEAKER"] || {}, { defval: null });


        // تصحيح البيانات
        Object.keys(database).forEach(category => {
            console.log(`فئة ${category}: ${database[category].length} عنصر`, database[category]);
            if (database[category].length === 0) {
                console.warn(`لا توجد بيانات في ورقة ${category}`);
            } else {
                database[category].slice(0, 5).forEach(item => {
                    console.log(`عنصر في ${category}:`, {
                        name: item["Item Name"] || item["Item"],
                        price: item["Price"],
                        new: item["New"],
                        newType: typeof item["New"],
                        isNewEmpty: item["New"] === "" || item["New"] === undefined || item["New"] === null
                    });
                });
            }
        });

        const hasData = Object.values(database).some(items => items.length > 0);
        if (!hasData) {
            console.warn("ملف Excel لا يحتوي على بيانات صالحة (جميع الفئات فارغة).");
            Swal.fire({
                title: 'خطأ',
                html: '<p style="color: #ff4d4d;">ملف Excel لا يحتوي على بيانات صالحة.</p>',
                iconHtml: '<i class="fas fa-exclamation-circle"></i>',
                confirmButtonText: 'موافق',
                customClass: {
                    popup: 'swal2-popup',
                    title: 'swal2-title',
                    htmlContainer: 'swal2-html-container',
                    confirmButton: 'swal2-confirm'
                }
            });
            return { success: true, hasData: false, message: "ملف Excel لا يحتوي على بيانات صالحة." };
        }

        return { success: true, hasData: true };
    } catch (error) {
        console.error("خطأ في تحميل ملف Excel:", error.message, error.stack);
        Swal.fire({
            title: 'خطأ',
            html: `<p style="color: #ff4d4d;">حدث خطأ أثناء تحميل البيانات: ${error.message}</p>`,
            iconHtml: '<i class="fas fa-exclamation-circle"></i>',
            confirmButtonText: 'موافق',
            customClass: {
                popup: 'swal2-popup',
                title: 'swal2-title',
                htmlContainer: 'swal2-html-container',
                confirmButton: 'swal2-confirm'
            }
        });
        return { success: true, hasData: false, message: error.message };
    }
}



async function loadNewItems() {
    const modal = document.getElementById("newItemsModal");
    const modalContent = modal.querySelector(".modal-content");
    const newItemsCount = document.querySelector(".new-items-count");

    modalContent.innerHTML = "";
    const categories = ["LCD", "HUAWEI", "BATTERY", "HOUSING", "BACK", "CAMERA", "CHARGING", "BUZZER", "HEADPHONE", "FINGER", "FLAT LCD", "POWER", "LNES", "VOLUME", "SPEAKER", "FLAT SPEAKER"];
    let newItems = [];

    categories.forEach(category => {
        if (database[category]) {
            const items = database[category].filter(item => {
                const newField = item["New"] !== undefined ? item["New"] : 
                                item["new"] !== undefined ? item["new"] : 
                                item["NEW"] !== undefined ? item["NEW"] : null;
                const isNew = newField === "" || newField === undefined || newField === null || newField === " " || newField === "  ";
                const priceValue = item["Price"] ? String(item["Price"]).trim() : "";
                const hasPrice = priceValue && !isNaN(parseFloat(priceValue)) && !["❎", "xx"].includes(priceValue);
                return hasPrice && isNew;
            });
            items.forEach(item => newItems.push({ ...item, category }));
        }
    });

    console.log(`إجمالي العناصر الجديدة: ${newItems.length}`, newItems);
    newItemsCount.textContent = newItems.length;

    if (newItems.length === 0) {
        modalContent.innerHTML = `
            <p style="color: #fff; font-family: 'Cairo', sans-serif; text-align: center;">
                لا توجد عناصر جديدة حاليًا
            </p>
        `;
        return;
    }

    newItems.forEach(item => {
        const card = document.createElement("div");
        card.className = "new-item-card";
        const iconClass = getIconForCategory(item.category);
        card.innerHTML = `
            <div class="category-circle">${item.category}</div>
            <div class="item-details">
                <div class="new-badge">جديد</div>
                <h4><i class="${iconClass}"></i> ${item["Item Name"] || item["Item"]}</h4>
                <p>${item["Price"].toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")} د.ع</p>
            </div>
        `;
        modalContent.appendChild(card);
    });
}




/* =========================
   Toast دارك (فوك الهيدر)
========================= */
const AssalToast = Swal.mixin({
  toast: true,
  position: 'top',
  showConfirmButton: false,
  timer: 1700,
  timerProgressBar: true,
  customClass: { popup: 'assal-toast' },
  didOpen: (toast) => {
    toast.addEventListener('mouseenter', Swal.stopTimer);
    toast.addEventListener('mouseleave', Swal.resumeTimer);
  }
});

/* =========================
   Cart (LocalStorage)
========================= */
const CART_KEY = "assal_cart_v1";
let cart = [];
let lastDisplayedResults = []; // نحتاجها لزر "أضف للسلة" بالكروت

const BRANCHES = [
  { name: "عسل بعقوبة",    phone: "07728640560" },
  { name: "عسل التحرير",   phone: "07730080731" },
  { name: "عسل حي المعلمين", phone: "07711107595" },
  { name: "عسل بلدروز",    phone: "07755206020" }
];

function normalizeIQPhone(p){
  const digits = String(p).replace(/\D/g,'');
  return "964" + digits.replace(/^0/,''); // 077... => 96477...
}

function formatIQD(n){
  const x = Math.round(Number(n || 0));
  return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + " د.ع";
}

function parsePrice(raw){
  if(raw == null || raw === "") return 0;
  const digits = String(raw).replace(/[^\d]/g,'');
  return digits ? Number(digits) : 0;
}

function saveCart(){
  localStorage.setItem(CART_KEY, JSON.stringify(cart));
}

function loadCart(){
  try{
    const saved = localStorage.getItem(CART_KEY);
    cart = saved ? JSON.parse(saved) : [];
  }catch(e){
    cart = [];
  }
  updateCartBadge();
}

function cartCount(){
  return cart.reduce((s,it)=> s + (it.qty || 0), 0);
}

function updateCartBadge(){
  const el = document.getElementById("cartBadge");
  if(!el) return;
  const c = cartCount();
  el.textContent = c;
  el.style.display = c > 0 ? "flex" : "none";
}

/* استدعاء من كروت النتائج */
function addToCartFromResults(index){
  const item = lastDisplayedResults[index];
  if(!item) return;

  const name = item["Item Name"] || item["Item"] || "بدون اسم";
  const originalPriceRaw = item["Price"];
  const discountPriceRaw = item["Discount Price"];

  const price = discountPriceRaw ? parsePrice(discountPriceRaw) : parsePrice(originalPriceRaw);
  if(!price){
    AssalToast.fire({ icon: "error", title: "السعر غير متوفر" });
    return;
  }

  // نفس منطق الصورة عندك
  const normalizedCategory = (currentCategory || "UNKNOWN")
    .toLowerCase()
    .replace(/\s+/g, '-');

  const imgSrc = currentCategory === "SIMILARITES"
    ? 'images/default.png'
    : `images/${normalizedCategory}.png`;

  addToCart({
    name,
    category: currentCategory || "UNKNOWN",
    imgSrc,
    unitPrice: price,
    hasDiscount: !!discountPriceRaw
  });
}

function addToCart(payload){
  const key = `${payload.category}__${payload.name}__${payload.unitPrice}`;
  const found = cart.find(x => x.key === key);
  if(found){
    found.qty += 1;
  }else{
    cart.push({
      key,
      name: payload.name,
      category: payload.category,
      imgSrc: payload.imgSrc,
      unitPrice: payload.unitPrice,
      hasDiscount: payload.hasDiscount,
      qty: 1
    });
  }
  saveCart();
  updateCartBadge();
  AssalToast.fire({ icon: "success", title: "انضاف للسلة" });
}

function changeQty(i, delta){
  if(!cart[i]) return;
  cart[i].qty = Math.max(1, (cart[i].qty || 1) + delta);
  saveCart();
  updateCartBadge();
  renderCartInPopup();
}

function removeItem(i){
  cart.splice(i,1);
  saveCart();
  updateCartBadge();
  renderCartInPopup();
}

function clearCartManual(){
  cart = [];
  saveCart();
  updateCartBadge();
  renderCartInPopup();
}

function cartTotal(){
  return cart.reduce((s,it)=> s + (it.unitPrice * (it.qty||1)), 0);
}

/* =========================
   Cart UI (SweetAlert2)
========================= */
function cartHtml(){
  const rows = cart.map((it, i) => `
    <div class="cart-item">
      <img src="${it.imgSrc}" alt="">
      <div class="cart-meta">
        <div class="cart-name">${it.name}</div>
        <div class="cart-sub">
          <span>القسم: ${it.category}</span>
          <span>السعر: ${formatIQD(it.unitPrice)}</span>
        </div>
      </div>

      <div class="qty-box">
        <button class="qty-btn" data-act="minus" data-i="${i}">-</button>
        <div class="qty-num">${it.qty}</div>
        <button class="qty-btn" data-act="plus" data-i="${i}">+</button>
      </div>

      <button class="cart-remove" data-act="rm" data-i="${i}" title="حذف">
        <i class="fas fa-trash"></i>
      </button>
    </div>
  `).join("");

  const empty = `<div style="padding:14px;border:1px dashed rgba(255,255,255,.18);border-radius:14px;background:rgba(0,0,0,.18);text-align:center;">
    السلة فارغة حالياً
  </div>`;

  const whatsappBtns = BRANCHES.map((b, idx)=> `
    <button class="cart-action-btn" data-act="wa" data-idx="${idx}">
      <i class="fab fa-whatsapp"></i> ${b.name}
    </button>
  `).join("");

  return `
    <div class="cart-wrap" dir="rtl">
      <div class="cart-head">
        <div class="cart-title"><i class="fas fa-shopping-cart"></i> السلة</div>
        <div style="opacity:.85;font-size:12px;">عدد العناصر: ${cartCount()}</div>
      </div>

      <div class="cart-list">${cart.length ? rows : empty}</div>

      <div class="cart-foot">
        <div class="cart-total">
          <span>المجموع</span>
          <span>${formatIQD(cartTotal())}</span>
        </div>

        <div class="cart-actions">
          <button class="cart-action-btn danger" data-act="clear">
            <i class="fas fa-broom"></i> تفريغ السلة
          </button>
          <button class="cart-action-btn primary" data-act="save">
            <i class="fas fa-file-invoice"></i> حفظ فاتورة (صورة)
          </button>
        </div>

        <div class="cart-actions" style="gap:8px;">
          ${whatsappBtns}
        </div>
      </div>
    </div>
  `;
}

function openCart(){
  Swal.fire({
    title: "",
    html: cartHtml(),
    showConfirmButton: false,
    showCloseButton: true,
    customClass: { popup: "cart-popup" },
    didOpen: (popup) => {
      popup.addEventListener("click", (e) => {
        const btn = e.target.closest("[data-act]");
        if(!btn) return;
        const act = btn.dataset.act;

        if(act === "plus")  return changeQty(Number(btn.dataset.i), +1);
        if(act === "minus") return changeQty(Number(btn.dataset.i), -1);
        if(act === "rm")    return removeItem(Number(btn.dataset.i));
        if(act === "clear") return clearCartManual();
        if(act === "save")  return saveInvoiceImage();
        if(act === "wa")    return sendCartToWhatsApp(Number(btn.dataset.idx));
      });
    }
  });
}

function renderCartInPopup(){
  const popup = Swal.getPopup();
  if(!popup) return;
  const html = popup.querySelector(".cart-wrap");
  if(!html) return;
  popup.querySelector(".swal2-html-container").innerHTML = cartHtml();
}

/* =========================
   WhatsApp (يفتح المحادثة)
========================= */
function cartMessageText(){
  const lines = cart.map((it, i) => {
    const lineTotal = it.unitPrice * (it.qty||1);
    return `${i+1}) ${it.name} — ${it.qty} × ${formatIQD(it.unitPrice)} = ${formatIQD(lineTotal)}`;
  });

  return [
    "فاتورة مكتب عسل",
    "-------------------",
    ...lines,
    "-------------------",
    `المجموع: ${formatIQD(cartTotal())}`
  ].join("\n");
}

function openWhatsAppChat(phone, text){
  const p = normalizeIQPhone(phone);
  const msg = encodeURIComponent(text);

  // جرّب يفتح التطبيق مباشرة
  const scheme = `whatsapp://send?phone=${p}&text=${msg}`;
  const web = `https://wa.me/${p}?text=${msg}`;

  window.location.href = scheme;

  // fallback إذا المتصفح ما يدعم scheme
  setTimeout(() => {
    window.open(web, "_blank");
  }, 900);
}

function sendCartToWhatsApp(branchIndex){
  const b = BRANCHES[branchIndex];
  if(!b) return;
  if(!cart.length){
    AssalToast.fire({ icon:"info", title:"السلة فارغة" });
    return;
  }
  openWhatsAppChat(b.phone, cartMessageText());
}

/* =========================
   Invoice => صورة Landscape
========================= */
function invoiceHtml(){
  const now = new Date();
  const dateStr = now.toLocaleString("ar-IQ");

  const rows = cart.map((it, i) => {
    const lineTotal = it.unitPrice * (it.qty||1);
    return `
      <tr>
        <td style="width:50px;text-align:center;">${i+1}</td>
        <td>${it.name}</td>
        <td style="width:120px;text-align:center;">${it.category}</td>
        <td style="width:110px;text-align:center;">${it.qty}</td>
        <td style="width:160px;text-align:center;">${formatIQD(it.unitPrice)}</td>
        <td style="width:180px;text-align:center;font-weight:900;">${formatIQD(lineTotal)}</td>
      </tr>
    `;
  }).join("");

  const branches = BRANCHES.map(b => `${b.name}: ${b.phone}`).join(" — ");

  return `
    <div class="invoice-sheet" dir="rtl">
      <div class="invoice-top">
        <div class="invoice-brand">
          <div class="name">Assal Office — فاتورة</div>
          <div class="meta">تاريخ الإصدار: ${dateStr}</div>
          <div class="meta">ملاحظة: الأسعار قابلة للتحديث حسب السوق</div>
        </div>

        <div class="invoice-badge">
          <div style="font-weight:900;">مكتب عسل</div>
          <div style="opacity:.85;margin-top:6px;">فروع واتساب:</div>
          <div style="opacity:.85;margin-top:4px;line-height:1.6;">${branches}</div>
        </div>
      </div>

      <table class="invoice-table">
        <thead>
          <tr>
            <th>#</th>
            <th>الصنف</th>
            <th>القسم</th>
            <th>الكمية</th>
            <th>سعر الوحدة</th>
            <th>الإجمالي</th>
          </tr>
        </thead>
        <tbody>
          ${rows || `<tr><td colspan="6" style="text-align:center;padding:30px;">السلة فارغة</td></tr>`}
        </tbody>
      </table>

      <div class="invoice-bottom">
        <div class="invoice-note">
          * حفظ الفاتورة كصورة (Landscape) حتى ما تنضغط البيانات.  
          * إذا تحب تشارك الصورة مباشرة، بعض المتصفحات تحتاج مشاركة يدويّة بعد التنزيل.
        </div>

        <div class="invoice-sum">
          <div>عدد العناصر: ${cartCount()}</div>
          <div style="margin-top:6px;font-size:16px;">المجموع: ${formatIQD(cartTotal())}</div>
        </div>
      </div>
    </div>
  `;
}

async function saveInvoiceImage(){
  if(!cart.length){
    AssalToast.fire({ icon:"info", title:"السلة فارغة" });
    return;
  }

  // host مخفي حتى نصوّر الفاتورة وحدها
  const host = document.createElement("div");
  host.style.position = "fixed";
  host.style.left = "-99999px";
  host.style.top = "0";
  host.style.width = "1123px";
  host.style.height = "794px";
  host.innerHTML = invoiceHtml();
  document.body.appendChild(host);

  const sheet = host.querySelector(".invoice-sheet");

  try{
    const canvas = await html2canvas(sheet, { scale: 2, backgroundColor: "#0b1220" });
    const blob = await new Promise(res => canvas.toBlob(res, "image/png", 1));

    const a = document.createElement("a");
    const url = URL.createObjectURL(blob);
    a.href = url;
    a.download = `assal-invoice-${Date.now()}.png`;
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);

    AssalToast.fire({ icon:"success", title:"تم حفظ الفاتورة كصورة" });
  }catch(err){
    console.error(err);
    AssalToast.fire({ icon:"error", title:"صار خطأ بالحفظ" });
  }finally{
    host.remove();
  }
}

/* تشغيل تحميل السلة أول ما تفتح الصفحة */
document.addEventListener("DOMContentLoaded", () => {
  loadCart();
});




// دالة لاختيار الأيقونة بناءً على الفئة
function getIconForCategory(category) {
    const icons = {
        "LCD": "fas fa-tv",
        "HUAWEI": "fas fa-mobile-alt",
        "BATTERY": "fas fa-battery-full",
        "HOUSING": "fas fa-mobile-alt",
        "BACK": "fas fa-tablet-alt",
        "CAMERA": "fas fa-camera",
        "CHARGING": "fas fa-plug",
        "BUZZER": "fas fa-bell",
        "HEADPHONE": "fas fa-volume-up",
        "FINGER": "fas fa-fingerprint",
        "FLAT LCD": "fas fa-film",
        "POWER": "fas fa-power-off",
        "LENS": "fas fa-bullseye",
        "VOLUME": "fas fa-sliders-h",
        "SPEAKER": "fas fa-phone-volume",
        "FLAT SPEAKER": "fas fa-phone-alt",
        
        
        
        "UNKNOWN": "fas fa-question-circle"
    };
    return icons[category] || icons["UNKNOWN"];
}



        
        
        document.getElementById("searchInput").addEventListener("keydown", function(event) {
    if (event.key === "Enter") {
        event.preventDefault(); // 🔴 منع إعادة تحميل الصفحة
        searchItems(); // ✅ استدعاء البحث
    }
});




        
function filterCategory(category) {
    currentCategory = category;

    // إزالة الفئة "active" من جميع العناصر في القائمة السلايد
    document.querySelectorAll(".category").forEach(cat => cat.classList.remove("active"));

    // إضافة الفئة "active" للعنصر المختار
    const selectedCategory = document.querySelector(`.category[onclick="filterCategory('${category}')"]`);
    if (selectedCategory) {
        selectedCategory.classList.add("active");
    }
}





        function normalizeString(str) {
            return str.replace(/\s+/g, '').toLowerCase();
        }


function displayResults(results) {
    const resultsContainer = document.getElementById("results");
    resultsContainer.innerHTML = '';

    // ✅ نخزن آخر نتائج حتى زر "أضف للسلة" يشتغل
    lastDisplayedResults = results;

    if (results.length === 0) {
        resultsContainer.innerHTML = `
            <div class="no-results">
                هذا العنصر غير متوفر في الوقت الحالي
            </div>
        `;
    } else {
        let htmlContent = '';
        results.forEach((item, index) => {

            // جزء الصورة كما هو
            const normalizedCategory = currentCategory
                .toLowerCase()
                .replace(/\s+/g, '-');

            const imgSrc = currentCategory === "SIMILARITES"
                ? 'images/default.png'
                : `images/${normalizedCategory}.png`;

            // منطق الأسعار
            const originalPriceRaw  = item["Price"];
            const discountPriceRaw  = item["Discount Price"]; // عمود جديد في ملف الإكسل

            let priceHtml = '<p>غير متوفر</p>';

            if (originalPriceRaw) {
                const originalFormatted = originalPriceRaw
                    .toString()
                    .replace(/\B(?=(\d{3})+(?!\d))/g, ",");

                if (discountPriceRaw) {
                    const discountFormatted = discountPriceRaw
                        .toString()
                        .replace(/\B(?=(\d{3})+(?!\d))/g, ",");

                    // 👉 عند وجود تخفيض: مستطيل السعر القديم + مستطيل السعر الجديد
                    priceHtml = `
                        <div class="price-row">
                            <p class="old-price-pill">
                                <span class="old-price-text">${originalFormatted} د.ع</span>
                            </p>
                            <p class="new-price-pill">
                                <span class="new-price-text new-price-label">عرض خاص</span>
                                <span class="new-price-text new-price-value">${discountFormatted} د.ع</span>
                            </p>
                        </div>
                    `;
                } else {
                    // 👉 بدون تخفيض: نفس البادج القديم
                    priceHtml = `<p>${originalFormatted} د.ع</p>`;
                }
            }

            // ✅ زر اضافة للسلة (يتعطل إذا السعر غير متوفر)
            const addBtnDisabled = (!originalPriceRaw && !discountPriceRaw) ? "disabled" : "";
            const addBtnHtml = `
                <button class="add-to-cart-btn" ${addBtnDisabled} onclick="addToCartFromResults(${index})">
                    <i class="fas fa-cart-plus"></i>
                    <span>أضف للسلة</span>
                </button>
            `;

            htmlContent += `
                <div class="result-card">
                    <img src="${imgSrc}" alt="Item Image">
                    <h4>${item["Item Name"] || item["Item"]}</h4>
                    ${priceHtml}
                    ${addBtnHtml}
                </div>
            `;
        });

        resultsContainer.innerHTML = htmlContent;
    }

    requestAnimationFrame(() => {
        resultsContainer.style.display = "flex";
        resultsContainer.scrollIntoView({ behavior: "smooth", block: "start" });
        toggleScrollToTopButton();
    });
}










// إخفاء الحاوية عند تفريغ حقل البحث
function searchItems() {
    const searchInput = document.getElementById("searchInput").value.trim();
    const resultsContainer = document.getElementById("results");

    if (!searchInput) {
        resultsContainer.style.display = 'none';
        Swal.fire({
            title: 'حقل فارغ',
            html: '<p style="color: #dcdcdc;">يرجى كتابة اسم العنصر قبل المتابعة</p>',
            iconHtml: '<i class="fas fa-exclamation-circle"></i>',
            confirmButtonText: 'موافق',
            customClass: {
                popup: 'swal2-popup',
                title: 'swal2-title',
                htmlContainer: 'swal2-html-container',
                confirmButton: 'swal2-confirm'
            }
        });
        return;
    }

if (!currentCategory) {
    resultsContainer.style.display = 'none';

    Swal.fire({
        html: `
            <div class="exit-shell">
                <div class="exit-icon">
                    <i class="fas fa-list-alt"></i>
                </div>
                <h2 class="exit-title">اختيار الصنف أولًا</h2>
                <p class="exit-text">
                    قبل ما نبحث، لازم تختار نوع القطعة من الشريط العلوي
                    (شاشات، بطاريات، شواصي، ...).
                </p>
            </div>
        `,
        confirmButtonText: 'تمام، راح أختار الصنف',
        backdrop: 'rgba(2, 6, 23, 0.82)',
        allowOutsideClick: true,
        allowEscapeKey: true,
        customClass: {
            popup: 'swal2-popup exit-popup animate__animated animate__zoomIn',
            confirmButton: 'exit-confirm'
        },
        hideClass: {
            popup: 'animate__animated animate__zoomOut'
        }
    });

    return;
}


    if (!database || !database[currentCategory] || database[currentCategory].length === 0) {
        resultsContainer.style.display = 'none';
        Swal.fire({
            title: 'لا توجد بيانات',
            html: `<p style="color: #ff4d4d;">لا توجد بيانات متاحة لفئة ${currentCategory}. يرجى تحديث الصفحة أو التحقق من الاتصال.</p>`,
            iconHtml: '<i class="fas fa-exclamation-circle"></i>',
            confirmButtonText: 'موافق',
            customClass: {
                popup: 'swal2-popup',
                title: 'swal2-title',
                htmlContainer: 'swal2-html-container',
                confirmButton: 'swal2-confirm'
            }
        });
        return;
    }

    const query = normalizeString(searchInput);
    const results = database[currentCategory]?.filter(item => {
        const itemName = item["Item Name"] || item["Item"];
        if (!itemName) {
            console.warn(`عنصر بدون اسم في فئة ${currentCategory}:`, item);
            return false;
        }
        return normalizeString(itemName).includes(query);
    }) || [];

    if (results.length === 0) {
        console.log(`لا توجد نتائج مطابقة في فئة ${currentCategory} للبحث: ${query}`);
    } else {
        console.log(`تم العثور على ${results.length} نتيجة في فئة ${currentCategory}:`, results);
    }

    displayResults(results);
}


// دالة الرجوع لأعلى الصفحة
function scrollToTop() {
    window.scrollTo({
        top: 0,
        behavior: 'smooth' // تمرير سلس
    });
}

// التحكم بظهور الزر بناءً على التمرير وعدد النتائج
function toggleScrollToTopButton() {
    const scrollBtn = document.getElementById("scrollToTopBtn");
    const scrollPosition = window.scrollY; // موقع التمرير الحالي
    const results = document.getElementById("results");
    const resultCount = results.children.length; // عدد النتائج

    // الشرط: يظهر الزر إذا كانت هناك نتائج (حتى لو واحدة) وتم التمرير لأسفل أكثر من 100 بكسل
    if (resultCount > 0 && scrollPosition > 100) {
        scrollBtn.classList.add("show-scroll-btn");
    } else {
        scrollBtn.classList.remove("show-scroll-btn");
    }
}


// ربط الزر بالنقر
document.getElementById("scrollToTopBtn").addEventListener("click", scrollToTop);

// الاستماع لحدث التمرير
window.addEventListener("scroll", toggleScrollToTopButton);

// تحديث حالة الزر عند التحميل الأولي
document.addEventListener("DOMContentLoaded", toggleScrollToTopButton);

async function confirmExit() {
    const result = await Swal.fire({
        html: `
            <div class="exit-shell">
                <div class="exit-icon">
                    <i class="fas fa-sign-out-alt"></i>
                </div>
                <h2 class="exit-title">تأكيد الخروج</h2>
                <p class="exit-text">
                    مكتب عسل يتمنّى لك يومًا جميلًا.
هل أنت متأكّد من الخروج؟ 
                </p>
            </div>
        `,
        showCancelButton: true,
        confirmButtonText: 'نعم، خروج',
        cancelButtonText: 'رجوع',
        focusCancel: true,
        backdrop: 'rgba(2, 6, 23, 0.82)',            // ✅ طبقة ظلال ناعمة خلف النافذة
        allowOutsideClick: false,
        allowEscapeKey: true,
        customClass: {
            popup: 'swal2-popup exit-popup animate__animated animate__zoomIn',
            confirmButton: 'exit-confirm',
            cancelButton: 'exit-cancel'
        },
        hideClass: {
            popup: 'animate__animated animate__zoomOut'
        },
        didOpen: () => {
            const popup = document.querySelector('.swal2-popup.exit-popup');
            if (popup) popup.style.zIndex = '10000';
        }
    });

    if (result.isConfirmed) {
        // إغلاق التطبيق / التبويب
        window.close();
    }
}



function openToolsPage() {
    window.location.href = 'tools.html'; // استبدل 'tools.html' بالرابط إلى الصفحة الجديدة
}


 // دالة لتحويل المستخدم إلى صفحة lcd.html
        function openLCDPage() {
            window.location.href = 'lcd.html';
        }



async function refreshData() {
    // 🌐 نافذة "جاري التحديث" – تصميم عالمي + ظل خلفي
    Swal.fire({
        html: `
            <div class="update-shell">
                <span class="update-chip">تحديث البيانات</span>

                <div class="update-ring">
                    <div class="update-ring-inner">
                        <i class="fas fa-database"></i>
                    </div>
                </div>

                <h2 class="update-title">نحدّث ملف المخزن الآن</h2>
                <p class="update-subtitle">
                    نسحب آخر نسخة من السيرفر ونحدث الأسعار،
                    ونرتّب العناصر الجديدة حتى تبقى كل بياناتك محدثة بدقة.
                </p>
            </div>
        `,
        showConfirmButton: false,
        allowOutsideClick: false,
        backdrop: 'rgba(2, 6, 23, 0.82)',   // ✅ طبقة ظلال قوية على الخلفية
        customClass: {
            popup: 'update-dialog animate__animated animate__fadeInDown'
        }
    });

    // نخلي المستخدم يحس أن أكو "شغل" حتى لو الملف قرأ بسرعة
    const loadingPromise   = new Promise(resolve => setTimeout(resolve, 3000));
    const loadFilesPromise = loadExcelFiles();

    const [_, loadResult] = await Promise.all([loadingPromise, loadFilesPromise]);

    if (!loadResult.hasData) {
        console.warn("لا توجد بيانات:", loadResult.message);
    }

    await loadNewItems();

    // نغلق نافذة التحميل (الأولى فقط)
    Swal.close();

    // ✅ نافذة "تم التحديث" – أنيقة + الظلال تبقى لحد إعادة تحميل الصفحة
    Swal.fire({
        html: `
            <div class="update-success-shell">
                <div class="update-success-icon">
                    <i class="fas fa-check"></i>
                </div>
                <h2 class="update-success-title">تم تحديث البيانات</h2>
                <p class="update-success-text">
                    كل شيء جاهز الآن. تم قراءة الملفات وتحديث المخزون
                    ويمكنك تكمل شغلك على أحدث نسخة من البيانات.
                </p>
            </div>
        `,
        showConfirmButton: false,
        allowOutsideClick: false,
        backdrop: 'rgba(2, 6, 23, 0.82)',   // نفس طبقة الظلال
        customClass: {
            popup: 'update-success-dialog animate__animated animate__fadeInUp'
        },
        // ملاحظة: ما نستخدم timer هنا، نتحكم يدويًا بالوقت تحت
        didOpen: () => {
            setTimeout(() => {
                // نخزّن حالة التحديث
                sessionStorage.setItem('hasUpdated', true);
                console.log('Data updated and session state saved successfully.');

                // نعيد تحميل الصفحة مباشرة
                // ⚠️ ما نستخدم Swal.close() هنا حتى لا يصير فرق بين الظلال والنافذة
                location.reload();
            }, 1700); // المدة اللي تبقى بيها نافذة النجاح ظاهرة
        }
    });
}



        
        loadExcelFiles();

 let newsInterval = null;

async function fetchTechNews() {
    const rssToJsonUrl = "https://api.rss2json.com/v1/api.json?rss_url=https://aitnews.com/feed/";
    const resultsContainer = document.getElementById("results");

    // إذا النتائج معروضة، لا تحدث الأخبار
    if (resultsContainer.style.display === "flex") {
        return;
    }

    try {
        const response = await fetch(rssToJsonUrl);
        const data = await response.json();
        let newsItems = [];

        if (data.items) {
            data.items.forEach(item => {
                let title = item.title;
                let link = item.link;
                let icon = "https://cdn-icons-png.flaticon.com/16/1041/1041916.png";
                newsItems.push(`<span><img src="${icon}" alt="📢"><a href="${link}" target="_blank">${title}</a></span>`);
            });
        }

        if (newsItems.length > 0) {
            document.getElementById("newsTicker").innerHTML = newsItems.join(" | ");
        } else {
            document.getElementById("newsTicker").textContent = "⚠️ لا توجد أخبار متاحة الآن";
        }
    } catch (error) {
        console.error("Error fetching news:", error);
        document.getElementById("newsTicker").textContent = "⚠️ تعذر تحميل الأخبار";
    }
}

function restartNewsTicker() {
    const ticker = document.querySelector(".news-ticker");
    const resultsContainer = document.getElementById("results");

    if (ticker && resultsContainer.style.display !== "flex") { // فقط إذا النتائج مو معروضة
        ticker.style.animation = "none";
        void ticker.offsetWidth;
        ticker.style.animation = "scrollText 60s linear infinite";
    }
}

function refreshNewsTicker() {
    const resultsContainer = document.getElementById("results");

    if (resultsContainer.style.display !== "flex") { // فقط إذا النتائج مو معروضة
        fetchTechNews(); // جلب الأخبار
        restartNewsTicker(); // إعادة تشغيل الحركة
    }
}

// دوال التحكم بالتحديث
function startNewsUpdates() {
    if (!newsInterval) {
        newsInterval = setInterval(fetchTechNews, 60000); // تحديث كل دقيقة
    }
}

function stopNewsUpdates() {
    if (newsInterval) {
        clearInterval(newsInterval);
        newsInterval = null;
    }
}

// التشغيل الأولي والتحكم
fetchTechNews(); // تحميل أولي
startNewsUpdates();

// ربط التحكم مع عرض النتائج
document.getElementById("results").addEventListener("transitionend", () => {
    if (document.getElementById("results").style.display === "flex") {
        stopNewsUpdates();
    } else {
        startNewsUpdates();
    }
});

// التعامل مع الأحداث الأخرى
document.addEventListener("click", function(event) {
    if (event.target.closest(".swal2-popup") || event.target.classList.contains("swal2-close") || 
        event.target.classList.contains("swal2-confirm") || event.target.classList.contains("swal2-cancel")) {
        setTimeout(refreshNewsTicker, 500); // تحديث الأخبار بعد إغلاق النافذة
    }
});

window.addEventListener("pageshow", function() {
    refreshNewsTicker(); // إعادة تشغيل الأخبار بعد العودة
});

window.addEventListener("load", function() {
    refreshNewsTicker(); // إعادة تشغيل الأخبار عند التحميل
});

        
    </script>
   
      
