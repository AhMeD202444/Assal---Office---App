<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Assal Office | Categories</title>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet" />

  <style>
    :root{
      --bg-0:#070A12;
      --bg-1:#0B1220;
      --glass: rgba(255,255,255,.08);
      --glass-2: rgba(255,255,255,.12);
      --stroke: rgba(255,255,255,.14);
      --txt: #EAF0FF;
      --muted: rgba(234,240,255,.72);
      --acc-1:#7C3AED; /* purple */
      --acc-2:#06B6D4; /* cyan */
      --acc-3:#22C55E; /* green */
      --danger:#EF4444;
      --shadow: 0 18px 50px rgba(0,0,0,.45);
      --radius: 22px;
    }

    *{ margin:0; padding:0; box-sizing:border-box; }
    body{
      font-family:"Cairo", sans-serif;
      color:var(--txt);
      min-height:100vh;
      background: radial-gradient(1200px 700px at 20% 10%, rgba(124,58,237,.25), transparent 55%),
                  radial-gradient(900px 600px at 90% 30%, rgba(6,182,212,.22), transparent 55%),
                  radial-gradient(900px 600px at 30% 90%, rgba(34,197,94,.14), transparent 55%),
                  linear-gradient(180deg, var(--bg-0), var(--bg-1));
      overflow-x:hidden;
      padding-top:72px;
      padding-bottom:72px;
    }

    /* subtle animated grain / blobs */
    .bg-blobs{
      position:fixed;
      inset:-20%;
      z-index:-1;
      filter: blur(22px);
      opacity:.75;
      animation: drift 14s ease-in-out infinite alternate;
      pointer-events:none;
      background:
        radial-gradient(300px 220px at 20% 35%, rgba(124,58,237,.40), transparent 70%),
        radial-gradient(320px 240px at 75% 30%, rgba(6,182,212,.35), transparent 70%),
        radial-gradient(360px 260px at 55% 80%, rgba(34,197,94,.22), transparent 70%);
    }
    @keyframes drift{
      from{ transform: translate3d(-1.5%, -1.0%, 0) scale(1.02); }
      to  { transform: translate3d( 1.5%,  1.2%, 0) scale(1.05); }
    }

    /* App Bar */
    header{
      position:fixed;
      top:0;
      left:0;
      right:0;
      height:64px;
      z-index:50;
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding: 0 14px;
      background: linear-gradient(90deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      backdrop-filter: blur(10px);
      border-bottom:1px solid rgba(255,255,255,.10);
    }

    .app-left{
      display:flex;
      align-items:center;
      gap:10px;
      min-width: 140px;
    }

    .brand-mini{
      width:40px;
      height:40px;
      border-radius:14px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 10px 26px rgba(0,0,0,.35);
      background: rgba(255,255,255,.06);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .brand-mini img{
      width:100%;
      height:100%;
      object-fit:cover;
    }

    .app-title{
      display:flex;
      flex-direction:column;
      line-height:1.1;
    }
    .app-title b{ font-size: 14px; letter-spacing:.2px; }
    .app-title span{ font-size: 12px; color: var(--muted); }

    .app-actions{
      display:flex;
      align-items:center;
      gap:10px;
    }

    .icon-btn{
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.08);
      color: var(--txt);
      width:42px;
      height:42px;
      border-radius:16px;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      transition: transform .18s ease, background .18s ease, border-color .18s ease;
      box-shadow: 0 10px 26px rgba(0,0,0,.25);
      overflow:hidden;
    }
    .icon-btn:hover{
      transform: translateY(-2px);
      background: rgba(255,255,255,.12);
      border-color: rgba(255,255,255,.22);
    }
    .icon-btn:active{
      transform: scale(.96);
    }
    .icon-btn.danger{
      border-color: rgba(239,68,68,.35);
      background: rgba(239,68,68,.12);
    }
    .icon-btn.danger:hover{
      background: rgba(239,68,68,.18);
    }

    /* Layout */
    .wrap{
      width:min(1100px, 92%);
      margin: 0 auto;
      display:flex;
      flex-direction:column;
      gap: 18px;
    }

    /* Hero */
    .hero{
      position:relative;
      border-radius: var(--radius);
      overflow:hidden;
      background: linear-gradient(135deg, rgba(255,255,255,.10), rgba(255,255,255,.04));
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: var(--shadow);
      padding: 18px;
    }

    .hero-inner{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 16px;
      flex-wrap: wrap;
    }

    .hero-brand{
      display:flex;
      align-items:center;
      gap: 14px;
      flex: 1 1 360px;
      min-width: 280px;
    }

    .logo-orb{
      width: 92px;      /* نفس الروح */
      height: 92px;     /* مربع */
      border-radius: 22px;
      padding: 8px;
      background:
        radial-gradient(80px 80px at 30% 30%, rgba(124,58,237,.45), transparent 70%),
        radial-gradient(90px 90px at 70% 70%, rgba(6,182,212,.35), transparent 70%),
        rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 18px 60px rgba(124,58,237,.20), 0 18px 60px rgba(6,182,212,.12);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .logo-orb img{
      width: 100%;
      height: 100%;
      border-radius: 18px;  /* مربع ناعم */
      object-fit: cover;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }

    .hero-text h1{
      font-size: clamp(18px, 3.6vw, 30px);
      margin-bottom: 4px;
      letter-spacing:.2px;
    }
    .hero-text p{
      color: var(--muted);
      font-size: 13.5px;
    }

    .hero-badges{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
      flex: 1 1 260px;
    }
    .badge{
      padding: 10px 12px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--txt);
      display:flex;
      align-items:center;
      gap:8px;
      box-shadow: 0 12px 30px rgba(0,0,0,.18);
      font-size: 13px;
      white-space:nowrap;
    }
    .badge i{ opacity:.95; }

    /* Categories */
    .panel{
      border-radius: var(--radius);
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .panel-head{
      padding: 14px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      background: linear-gradient(90deg, rgba(255,255,255,.10), rgba(255,255,255,.04));
      border-bottom:1px solid rgba(255,255,255,.10);
    }
    .panel-head b{
      font-size: 14px;
      letter-spacing:.2px;
    }
    .panel-head span{
      font-size: 12px;
      color: var(--muted);
    }

    .categories{
      padding: 14px;
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 12px;
    }

    .cat{
      position:relative;
      border-radius: 18px;
      padding: 14px 12px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      cursor:pointer;
      transition: transform .18s ease, background .18s ease, border-color .18s ease;
      display:flex;
      align-items:center;
      gap: 10px;
      min-height: 62px;
      overflow:hidden;
    }

    .cat::after{
      content:"";
      position:absolute;
      inset:auto -40% -60% -40%;
      height:120%;
      background: radial-gradient(circle at 30% 30%, rgba(124,58,237,.25), transparent 65%),
                  radial-gradient(circle at 70% 70%, rgba(6,182,212,.18), transparent 65%);
      transform: rotate(8deg);
      opacity:.65;
      pointer-events:none;
    }

    .cat:hover{
      transform: translateY(-3px);
      background: rgba(255,255,255,.10);
      border-color: rgba(255,255,255,.18);
    }
    .cat:active{
      transform: scale(.985);
    }

    .cat .ic{
      width:42px;
      height:42px;
      border-radius: 16px;
      display:flex;
      align-items:center;
      justify-content:center;
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.12);
      flex: 0 0 42px;
      z-index:1;
    }
    .cat .ic i{
      font-size: 18px;
    }
    .cat .txt{
      display:flex;
      flex-direction:column;
      z-index:1;
    }
    .cat .txt b{
      font-size: 14px;
    }
    .cat .txt span{
      font-size: 12px;
      color: var(--muted);
      margin-top: -2px;
    }

    /* Results */
    .results-wrap{
      display:none;
    }

    .results-head{
      padding: 14px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      border-bottom:1px solid rgba(255,255,255,.10);
      background: linear-gradient(90deg, rgba(255,255,255,.10), rgba(255,255,255,.04));
    }
    .results-head b{ font-size: 14px; }
    .results-head span{ font-size: 12px; color: var(--muted); }

    #results{
      padding: 14px;
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 14px;
    }

    .result-card{
      border-radius: 20px;
      padding: 14px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      box-shadow: 0 18px 40px rgba(0,0,0,.28);
      transition: transform .18s ease, border-color .18s ease, background .18s ease;
      cursor:pointer;
      display:flex;
      align-items:center;
      gap: 12px;
      min-height: 92px;
      overflow:hidden;
    }
    .result-card:hover{
      transform: translateY(-3px);
      background: rgba(255,255,255,.09);
      border-color: rgba(255,255,255,.20);
    }
    .result-card:active{
      transform: scale(.985);
    }

    .result-card img{
      width: 54px;
      height: 54px;
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      object-fit: cover;
      flex: 0 0 54px;
    }

    .meta{
      display:flex;
      flex-direction:column;
      gap: 8px;
      min-width: 0;
      flex:1;
    }
    .item-name{
      font-size: 13.5px;
      line-height: 1.25;
      color: var(--txt);
      text-shadow: 0 8px 20px rgba(0,0,0,.30);
      word-wrap:break-word;
      overflow:hidden;
      display:-webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }
    .price{
      align-self:flex-start;
      padding: 7px 10px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.14);
      background: linear-gradient(135deg, rgba(124,58,237,.24), rgba(6,182,212,.18));
      font-weight: 700;
      font-size: 12.5px;
      box-shadow: 0 14px 30px rgba(0,0,0,.22);
    }

    .no-results{
      grid-column: 1 / -1;
      border-radius: 18px;
      padding: 16px;
      background: rgba(255,255,255,.06);
      border:1px dashed rgba(255,255,255,.18);
      color: var(--muted);
      text-align:center;
    }

    /* Scroll to top */
    .scroll-to-top{
      position: fixed;
      bottom: 70px;
      left: 18px;
      width: 52px;
      height: 52px;
      border-radius: 20px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.10);
      backdrop-filter: blur(10px);
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
      display:none;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      z-index:60;
      transition: transform .18s ease, background .18s ease;
    }
    .scroll-to-top:hover{ transform: translateY(-3px); background: rgba(255,255,255,.14); }
    .scroll-to-top:active{ transform: scale(.96); }
    .scroll-to-top i{ font-size: 18px; }

    footer{
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 54px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap: 10px;
      z-index:50;
      background: linear-gradient(90deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      backdrop-filter: blur(10px);
      border-top:1px solid rgba(255,255,255,.10);
      color: var(--muted);
      font-size: 12.5px;
      text-align:center;
      padding: 0 12px;
    }

    @media (max-width: 520px){
      .brand-mini{ display:none; }
      .app-left{ min-width: 100px; }
      .hero-badges{ justify-content:flex-start; }
      .categories{ grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); }
    }
    
    
    /* === Mobile touch / highlight control === */
*{
  -webkit-tap-highlight-color: transparent; /* يمنع الهايلايت الافتراضي بكل الصفحة */
  -webkit-touch-callout: none;
}

body{
  user-select: none;              /* يمنع تحديد النص بالغلط بالموبايل */
  -webkit-user-select: none;
}

/* نرجّع الهايلايت بس للعناصر القابلة للنقر وبـ لون محدد */
.icon-btn, .cat, .result-card{
  -webkit-tap-highlight-color: rgba(6,182,212,.22); /* هايلايت Cyan خفيف */
  touch-action: manipulation; /* يقلل تأخير اللمس ويمنع حركات غير مرغوبة */
}

/* Outline نظيف عند الكيبورد/التركيز */
.icon-btn:focus-visible, .cat:focus-visible, .result-card:focus-visible{
  outline: 2px solid rgba(6,182,212,.55);
  outline-offset: 3px;
}

footer{
  letter-spacing: .2px;
}
footer i{
  margin-left: 6px;
  opacity: .9;
}


/* ==========================
   GLOBAL TOUCH / HIGHLIGHT
   ========================== */

/* يمنع أي تأثير لمس/هايلايت خارج العناصر القابلة للنقر */
html, body{
  -webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
}

/* يمنع تحديد النص باللمس بالغلط */
body{
  user-select: none;
  -webkit-user-select: none;
}

/* هايلايت محدد لكل العناصر القابلة للنقر بالصفحة */
:where(
  button,
  a,
  .icon-btn,
  .cat,
  .result-card,
  .scroll-to-top,
  .swal2-confirm,
  .swal2-cancel,
  .swal2-close
){
  -webkit-tap-highlight-color: rgba(6,182,212,.25); /* لون الهايلايت */
  touch-action: manipulation;
}

/* تأثير ضغط (Active) أنيق بدل “لمعة” سخيفة */
:where(.icon-btn, .cat, .result-card, .scroll-to-top, button, a):active{
  transform: scale(.985);
  filter: brightness(1.06);
}

/* فوكَس واضح للكيبورد/اكسسبيليتي */
:where(.icon-btn, .cat, .result-card, button, a, .swal2-confirm, .swal2-cancel):focus-visible{
  outline: 2px solid rgba(6,182,212,.55);
  outline-offset: 3px;
  border-radius: 16px;
}



/* ==========================
   SWEETALERT2 — GLOBAL TECH (NO SCROLL)
   ========================== */

.swal2-container.swal2-backdrop-show{
  background: radial-gradient(900px 650px at 20% 12%, rgba(6,182,212,.12), transparent 58%),
              radial-gradient(900px 650px at 86% 18%, rgba(124,58,237,.12), transparent 60%),
              rgba(0,0,0,.78) !important;
  backdrop-filter: blur(10px);
}

/* أهم شي: لا سكرول نهائياً داخل النافذة */
.swal2-popup.gt-popup{
  width: min(420px, 92vw) !important;
  max-height: calc(100vh - 28px) !important;
  overflow: hidden !important;
  border-radius: 22px !important;
  padding: 16px 16px 14px !important;

  background: rgba(10,14,24,.78) !important;
  border: 1px solid rgba(255,255,255,.10) !important;
  box-shadow: 0 32px 110px rgba(0,0,0,.78) !important;
  color: rgba(240,246,255,.92) !important;
  position: relative;
}

.swal2-title.gt-title{
  font-family:"Cairo",sans-serif !important;
  font-weight: 900 !important;
  letter-spacing: .3px;
  margin: 6px 0 0 !important;
}

.swal2-html-container.gt-html{
  margin: 10px 0 0 !important;
  overflow: hidden !important;      /* يمنع السكرول */
  max-height: none !important;      /* SweetAlert يسوي max-height أحياناً */
  padding: 0 !important;
  color: rgba(240,246,255,.72) !important;
  font-family:"Cairo",sans-serif !important;
  line-height: 1.55 !important;
}

/* محتوى مودال صغير ومضغوط حتى ما يحتاج سكرول */
.gt-wrap{
  position: relative;
  border-radius: 18px;
  padding: 12px;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.04);
  overflow: hidden;
}

/* شريط تقني متحرك */
.gt-scan{
  position:absolute;
  left:-20%;
  right:-20%;
  height: 46px;
  top: -60px;
  background: linear-gradient(180deg, transparent, rgba(6,182,212,.18), transparent);
  animation: gtScan 1.7s ease-in-out infinite;
  pointer-events:none;
  opacity: .9;
}
@keyframes gtScan{
  0%{ transform: translateY(0); opacity:0; }
  20%{ opacity:.95; }
  100%{ transform: translateY(210px); opacity:0; }
}

/* Header row */
.gt-row{
  display:flex;
  align-items:center;
  gap: 12px;
}

.gt-logo{
  width: 52px;
  height: 52px;
  border-radius: 14px;
  overflow:hidden;
  border: 1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.06);
  flex: 0 0 52px;
  box-shadow: 0 20px 55px rgba(0,0,0,.55);
}
.gt-logo img{ width:100%; height:100%; object-fit:cover; }

.gt-text{
  flex: 1;
  min-width: 0;
}
.gt-text .a{
  font-size: 13.7px;
  color: rgba(240,246,255,.88);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.gt-text .b{
  font-size: 12.3px;
  color: rgba(240,246,255,.62);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  margin-top: 2px;
}

/* Loader (تقني) - Rings */
.gt-loader{
  width: 82px;
  height: 82px;
  position: relative;
  flex: 0 0 82px;
  filter: drop-shadow(0 18px 45px rgba(0,0,0,.55));
}
.gt-ring{
  position:absolute;
  inset:0;
  border-radius: 50%;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.02);
  overflow:hidden;
}
.gt-ring::before{
  content:"";
  position:absolute;
  inset:-70%;
  background: conic-gradient(from 90deg,
    rgba(6,182,212,0),
    rgba(6,182,212,.65),
    rgba(124,58,237,.55),
    rgba(34,197,94,.28),
    rgba(6,182,212,0)
  );
  animation: gtSpin .95s linear infinite;
}
@keyframes gtSpin{ to{ transform: rotate(360deg);} }

.gt-ring::after{
  content:"";
  position:absolute;
  inset: 9px;
  border-radius: 50%;
  background: rgba(10,14,24,.92);
  border: 1px solid rgba(255,255,255,.08);
}

.gt-core{
  position:absolute;
  inset:0;
  margin:auto;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: rgba(6,182,212,.95);
  box-shadow: 0 0 24px rgba(6,182,212,.35);
  animation: gtPulse 1.05s ease-in-out infinite;
}
@keyframes gtPulse{
  0%,100%{ transform: scale(.85); opacity:.7; }
  50%{ transform: scale(1.25); opacity:1; }
}

/* شريط تقدم ناعم (بدون سكرول) */
.gt-bar{
  margin-top: 12px;
  height: 10px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.10);
  background: rgba(255,255,255,.04);
  overflow:hidden;
}
.gt-bar i{
  display:block;
  height:100%;
  width: 32%;
  background: linear-gradient(90deg,
    rgba(6,182,212,0),
    rgba(6,182,212,.55),
    rgba(124,58,237,.45),
    rgba(6,182,212,0)
  );
  animation: gtSweep 1.05s ease-in-out infinite;
}
@keyframes gtSweep{
  from{ transform: translateX(-160%); }
  to  { transform: translateX(380%); }
}

/* Success */
.gt-success{
  display:flex;
  align-items:center;
  gap: 12px;
  margin-top: 6px;
}
.gt-badge{
  width: 60px;
  height: 60px;
  border-radius: 16px;
  border: 1px solid rgba(34,197,94,.22);
  background: rgba(255,255,255,.05);
  position: relative;
  overflow:hidden;
  flex: 0 0 60px;
  box-shadow: 0 24px 70px rgba(0,0,0,.65);
}
.gt-badge::before{
  content:"";
  position:absolute;
  inset:-70%;
  background: conic-gradient(from 90deg,
    rgba(34,197,94,0),
    rgba(34,197,94,.55),
    rgba(6,182,212,.30),
    rgba(34,197,94,0)
  );
  animation: gtSpin 1.2s linear infinite;
  opacity:.75;
}
.gt-badge::after{
  content:"";
  position:absolute;
  inset: 9px;
  border-radius: 12px;
  background: rgba(10,14,24,.92);
  border: 1px solid rgba(255,255,255,.08);
}
.gt-badge svg{
  position:absolute;
  inset:0;
  margin:auto;
  width: 34px;
  height: 34px;
  z-index:2;
}
.gt-badge path{
  stroke: rgba(34,197,94,.95);
  stroke-width: 6.5;
  stroke-linecap: round;
  stroke-linejoin: round;
  fill:none;
  stroke-dasharray: 120;
  stroke-dashoffset: 120;
  animation: gtDraw .55s ease forwards .10s;
}
@keyframes gtDraw{ to{ stroke-dashoffset: 0; } }

/* ترتيب البادجات بشكل مرتب */
.hero-badges{
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr)); /* 3 بادجات صف واحد */
  gap: 10px;
  justify-content: stretch;
  align-items: stretch;
  flex: 1 1 100%;
}

.badge{
  justify-content: center;
  text-align: center;
  width: 100%;
  padding: 10px 10px;
  border-radius: 16px;
  min-height: 42px;        /* نفس طول موحد */
}

/* للموبايل: يصير 2 فوق + 1 تحت بالنص */
@media (max-width: 520px){
  .hero-badges{
    grid-template-columns: repeat(2, minmax(0, 1fr));
  }
  .hero-badges .badge:last-child{
    grid-column: 1 / -1;   /* الثالثة تاخذ سطر وحدها */
  }
}


.hero-brand{
  width: 100%;
  display:flex;
  align-items:center;
  justify-content: space-between;
  gap: 14px;
}

.hero-brand{
  flex-direction: row-reverse; /* يقلب ترتيب العناصر */
}


/* ==========================
   FIX: Mobile Tap Highlight + No Outside Press Glow
   (CSS ONLY - Apply Everywhere)
   ========================== */

/* 1) اقفل الهايلايت الأزرق بالموبايل */
html, body {
  -webkit-tap-highlight-color: transparent !important;
  -webkit-touch-callout: none !important;
}

/* 2) عمّمها على كل شي قابل للنقر عندك */
:where(
  button,
  a,
  input[type="button"],
  input[type="submit"],
  .header-btn,
  .category-btn,
  .new-category-btn,
  .tools-btn,
  .category,
  .slider-btn,
  .scroll-to-top,
  .no-results,
  .result-card,
  .close-modal-btn,
  .swal2-confirm,
  .swal2-cancel,
  .swal2-close
){
  -webkit-tap-highlight-color: transparent !important;
  outline: none !important;
  -webkit-appearance: none !important;
  appearance: none !important;

  /* 3) يمنع أي تأثير يطلع برّه العنصر */
  overflow: hidden !important;

  /* إذا العنصر مو دائري: قص مطابق للـ border-radius */
  clip-path: inset(0 0 0 0 round 18px) !important;
}

/* عناصر دائرية عندك لازم قص دائري (حتى ما يطلع تأثير خارج الدائرة) */
:where(.category, .slider-btn, .scroll-to-top, .close-modal-btn, .search-container button, .search-container .clear-btn){
  clip-path: circle(50% at 50% 50%) !important;
}

/* شيل أي Focus يظهر بعد الضغط (خصوصاً iOS/Android) */
:where(
  button, a,
  .header-btn, .category-btn, .new-category-btn, .tools-btn,
  .category, .slider-btn, .scroll-to-top, .no-results, .result-card,
  .swal2-confirm, .swal2-cancel, .swal2-close, .close-modal-btn
):focus,
:where(
  button, a,
  .header-btn, .category-btn, .new-category-btn, .tools-btn,
  .category, .slider-btn, .scroll-to-top, .no-results, .result-card,
  .swal2-confirm, .swal2-cancel, .swal2-close, .close-modal-btn
):focus-visible{
  outline: none !important;
  box-shadow: none !important;
}

/* فايرفوكس: يلغي الإطار الداخلي للأزرار */
:where(
  button,
  .header-btn,
  .swal2-confirm,
  .swal2-cancel
)::-moz-focus-inner{
  border: 0 !important;
}

/* (اختياري) يخلي الضغط “محترم” بدون وميض */
:where(.header-btn,.category-btn,.new-category-btn,.tools-btn,.category,.slider-btn,.scroll-to-top,.no-results,.result-card):active{
  filter: brightness(1.02);
}


/* ==========================
   FIX for Category Cards (.cat)
   ========================== */

/* طبق نفس الحماية على أزرار الأصناف عندك */
.cat{
  -webkit-tap-highlight-color: transparent !important;
  outline: none !important;
  -webkit-appearance: none !important;
  appearance: none !important;

  overflow: hidden !important;
  clip-path: inset(0 0 0 0 round 18px) !important;
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
}

/* مهم: طبقة اللمعة ::after عندك ممكن تاخذ اللمس */
.cat::after{
  pointer-events: none !important;  /* يخلي اللمس يروح للزر نفسه */
}

/* شيل أي focus */
.cat:focus,
.cat:focus-visible{
  outline: none !important;
  box-shadow: none !important;
}

/* يمنع قفزة السكرول بسبب fadeInUp أول مرة */
.results-wrap.no-jump {
  animation: none !important;
  transform: none !important;
  opacity: 1 !important;
}

/* أنيميشن بديل آمن (opacity فقط) بدون translateY */
.results-wrap.safe-reveal {
  animation: safeReveal .28s ease both;
}
@keyframes safeReveal {
  from { opacity: 0; }
  to   { opacity: 1; }
}

/* ==========================================
   SWEETALERT2 — PREMIUM GLOBAL THEME (WOW)
   - Animated icons per type
   - Strong shadows / glow layer
   - Smooth open/close animation
   - No weird scroll inside popup
   ========================================== */

/* Backdrop */
.swal2-container.swal2-backdrop-show{
  background:
    radial-gradient(900px 650px at 20% 12%, rgba(6,182,212,.14), transparent 58%),
    radial-gradient(900px 650px at 86% 18%, rgba(124,58,237,.14), transparent 60%),
    rgba(0,0,0,.78) !important;
  backdrop-filter: blur(10px);
}

/* Popup base */
.swal2-popup{
  width: min(440px, 92vw) !important;
  border-radius: 22px !important;
  padding: 18px 18px 16px !important;
  background: rgba(10,14,24,.82) !important;
  border: 1px solid rgba(255,255,255,.10) !important;

  /* طبقة ظلال قوية */
  box-shadow:
    0 34px 120px rgba(0,0,0,.78),
    0 0 0 1px rgba(255,255,255,.05) inset,
    0 0 60px rgba(6,182,212,.10),
    0 0 60px rgba(124,58,237,.08) !important;

  overflow: hidden !important; /* لا سكرول داخل النافذة */
  position: relative;
  color: rgba(240,246,255,.92) !important;
}

/* Glow layer inside */
.swal2-popup::before{
  content:"";
  position:absolute;
  inset:-55% -35%;
  background:
    radial-gradient(closest-side at 28% 32%, rgba(6,182,212,.18), transparent 65%),
    radial-gradient(closest-side at 72% 28%, rgba(124,58,237,.18), transparent 65%),
    radial-gradient(closest-side at 55% 82%, rgba(34,197,94,.10), transparent 70%);
  filter: blur(26px);
  opacity: .92;
  animation: swGlowMove 6.5s ease-in-out infinite alternate;
  pointer-events:none;
}
@keyframes swGlowMove{
  from{ transform: translate3d(-1.2%, -1.0%, 0) scale(1.02); }
  to  { transform: translate3d( 1.2%,  1.1%, 0) scale(1.06); }
}

/* Title & text */
.swal2-title{
  font-family: "Cairo", sans-serif !important;
  font-weight: 900 !important;
  letter-spacing: .2px;
  margin: 8px 0 2px !important;
}

.swal2-html-container{
  font-family: "Cairo", sans-serif !important;
  color: rgba(240,246,255,.72) !important;
  margin: 10px 0 0 !important;
  line-height: 1.65 !important;

  overflow: hidden !important;   /* لا سكرول */
  max-height: none !important;
}

/* Open / close animation */
.swal2-show{
  animation: swPopIn .22s ease-out both !important;
}
.swal2-hide{
  animation: swPopOut .18s ease-in both !important;
}
@keyframes swPopIn{
  from{ transform: translateY(10px) scale(.985); opacity: 0; }
  to  { transform: translateY(0) scale(1); opacity: 1; }
}
@keyframes swPopOut{
  from{ transform: translateY(0) scale(1); opacity: 1; }
  to  { transform: translateY(6px) scale(.985); opacity: 0; }
}

/* Actions */
.swal2-actions{
  margin-top: 14px !important;
  gap: 10px !important;
}

/* Buttons (confirm / cancel) */
.swal2-styled{
  border-radius: 14px !important;
  padding: 10px 18px !important;
  font-family: "Cairo", sans-serif !important;
  font-weight: 800 !important;
  letter-spacing: .2px !important;
  box-shadow: 0 18px 45px rgba(0,0,0,.45) !important;

  -webkit-tap-highlight-color: transparent !important;
  outline: none !important;
}

.swal2-confirm.swal2-styled{
  background: linear-gradient(135deg, rgba(6,182,212,.95), rgba(124,58,237,.90)) !important;
  color: rgba(10,14,24,.95) !important;
  border: 0 !important;
}
.swal2-cancel.swal2-styled{
  background: rgba(148,163,184,.14) !important;
  border: 1px solid rgba(148,163,184,.32) !important;
  color: rgba(240,246,255,.90) !important;
}

.swal2-styled:active{
  transform: scale(.98) !important;
  filter: brightness(1.05) !important;
}

/* Icon base */
.swal2-icon{
  width: 74px !important;
  height: 74px !important;
  margin: 10px auto 6px !important;
  border-width: 2px !important;

  box-shadow:
    0 18px 60px rgba(0,0,0,.55),
    0 0 26px rgba(255,255,255,.06) inset !important;

  animation: iconFloat 1.2s ease-in-out infinite;
}
@keyframes iconFloat{
  0%,100%{ transform: translateY(0); }
  50%{ transform: translateY(-2px); }
}

/* Per-type color & animation vibe */
.swal2-icon.swal2-success{
  border-color: rgba(34,197,94,.55) !important;
  filter: drop-shadow(0 0 18px rgba(34,197,94,.14));
}
.swal2-icon.swal2-error{
  border-color: rgba(239,68,68,.55) !important;
  filter: drop-shadow(0 0 18px rgba(239,68,68,.14));
  animation: iconShake .9s ease-in-out infinite;
}
@keyframes iconShake{
  0%,100%{ transform: translateY(0) rotate(0deg); }
  25%{ transform: translateY(-1px) rotate(-1.2deg); }
  50%{ transform: translateY(0) rotate(1.2deg); }
  75%{ transform: translateY(-1px) rotate(-.8deg); }
}
.swal2-icon.swal2-warning{
  border-color: rgba(245,158,11,.60) !important;
  filter: drop-shadow(0 0 18px rgba(245,158,11,.14));
}
.swal2-icon.swal2-info,
.swal2-icon.swal2-question{
  border-color: rgba(59,130,246,.60) !important;
  filter: drop-shadow(0 0 18px rgba(59,130,246,.14));
}

/* Animate success check draw */
.swal2-success .swal2-success-line-tip{
  animation: drawTip .45s ease forwards .10s !important;
  transform-origin: left center;
}
.swal2-success .swal2-success-line-long{
  animation: drawLong .55s ease forwards .10s !important;
  transform-origin: left center;
}
@keyframes drawTip{
  from{ transform: scaleX(0); opacity: 0; }
  to  { transform: scaleX(1); opacity: 1; }
}
@keyframes drawLong{
  from{ transform: scaleX(0); opacity: 0; }
  to  { transform: scaleX(1); opacity: 1; }
}

/* Animate error X draw */
.swal2-error .swal2-x-mark-line-left{
  animation: xLeft .45s ease forwards .10s !important;
  transform-origin: center;
}
.swal2-error .swal2-x-mark-line-right{
  animation: xRight .45s ease forwards .10s !important;
  transform-origin: center;
}
@keyframes xLeft{
  from{ transform: scale(.6) rotate(-35deg); opacity: 0; }
  to  { transform: scale(1) rotate(0deg); opacity: 1; }
}
@keyframes xRight{
  from{ transform: scale(.6) rotate(35deg); opacity: 0; }
  to  { transform: scale(1) rotate(0deg); opacity: 1; }
}

/* Animate info/question pulse */
.swal2-icon.swal2-info,
.swal2-icon.swal2-question{
  animation: infoPulse 1.1s ease-in-out infinite;
}
@keyframes infoPulse{
  0%,100%{ transform: scale(1); }
  50%{ transform: scale(1.05); }
}

/* Ensure buttons clickable (no accidental pointer-events none) */
.swal2-actions, .swal2-confirm, .swal2-cancel{
  pointer-events: auto !important;
}


/* منع تحديد النص */
html, body, * {
  -webkit-user-select: none !important;
  user-select: none !important;
  -webkit-touch-callout: none !important;
}

/* خَلّي الإدخال يظل طبيعي */
input, textarea, [contenteditable="true"] {
  -webkit-user-select: text !important;
  user-select: text !important;
}




    
    
  </style>
</head>

<body>
  <div class="bg-blobs"></div>

  <header>
    <div class="app-left">
      <div class="brand-mini">
        <img src="images/logo.png" alt="Logo" />
      </div>
      <div class="app-title">
        <b>مكتب عسل</b>
        <span>Spare Parts • Prices</span>
      </div>
    </div>

    <div class="app-actions">
      <button class="icon-btn" onclick="refreshData()" title="تحديث">
        <i class="fa-solid fa-arrows-rotate"></i>
      </button>
      <button class="icon-btn danger" onclick="goBack()" title="رجوع">
        <i class="fa-solid fa-arrow-right-from-bracket"></i>
      </button>
    </div>
  </header>

  <main class="wrap">
    <section class="hero animate__animated animate__fadeInUp">
   
   
   <div class="hero-inner">
  <div class="hero-brand">
    <div class="hero-text">
      <h1>قائمة الأصناف</h1>
      <p>اختار الشركة/القسم… والنتائج تطلع بشكل مرتب وسريع.</p>
    </div>

    <div class="logo-orb">
      <img src="images/logo.png" alt="Logo" />
    </div>
  </div>

  <div class="hero-badges">
    <div class="badge"><i class="fa-solid fa-bolt"></i> تحديث مباشر</div>
    <div class="badge"><i class="fa-solid fa-shield-halved"></i> عرض نظيف</div>
    <div class="badge"><i class="fa-solid fa-wand-magic-sparkles"></i> تصميم Premium</div>
  </div>
</div>

   
   
    </section>

    <section class="panel animate__animated animate__fadeInUp" style="animation-delay:.08s;">
      <div class="panel-head">
        <div>
          <b>الأقسام</b>
          <span>اضغط على القسم المطلوب</span>
        </div>
        <div style="display:flex; gap:8px; align-items:center; color:var(--muted); font-size:12px;">
          <i class="fa-solid fa-hand-pointer"></i>
          <span>Click</span>
        </div>
      </div>

      <div class="categories">
        <!-- LCD brands -->
        <div class="cat" onclick="filterLCDCategory(1, 'سامسونك')">
          <div class="ic"><i class="fas fa-mobile-alt"></i></div>
          <div class="txt"><b>سامسونك</b><span>LCD</span></div>
        </div>
        <div class="cat" onclick="filterLCDCategory(2, 'هواوي')">
          <div class="ic"><i class="fas fa-mobile-alt"></i></div>
          <div class="txt"><b>هواوي</b><span>LCD</span></div>
        </div>
        <div class="cat" onclick="filterLCDCategory(3, 'ايفون')">
          <div class="ic"><i class="fab fa-apple"></i></div>
          <div class="txt"><b>ايفون</b><span>LCD</span></div>
        </div>
        <div class="cat" onclick="filterLCDCategory(4, 'نوكيا')">
          <div class="ic"><i class="fas fa-mobile-alt"></i></div>
          <div class="txt"><b>نوكيا</b><span>LCD</span></div>
        </div>
        <div class="cat" onclick="filterLCDCategory(5, 'شاومي')">
          <div class="ic"><i class="fas fa-mobile-alt"></i></div>
          <div class="txt"><b>شاومي</b><span>LCD</span></div>
        </div>
        <div class="cat" onclick="filterLCDCategory(6, 'انفنكس')">
          <div class="ic"><i class="fas fa-mobile-alt"></i></div>
          <div class="txt"><b>انفنكس</b><span>LCD</span></div>
        </div>
        <div class="cat" onclick="filterLCDCategory(7, 'ريلمي')">
          <div class="ic"><i class="fas fa-mobile-alt"></i></div>
          <div class="txt"><b>ريلمي</b><span>LCD</span></div>
        </div>
        <div class="cat" onclick="filterLCDCategory(8, 'تكنو')">
          <div class="ic"><i class="fas fa-mobile-alt"></i></div>
          <div class="txt"><b>تكنو</b><span>LCD</span></div>
        </div>
        <div class="cat" onclick="filterLCDCategory(9, 'اوبو')">
          <div class="ic"><i class="fas fa-mobile-alt"></i></div>
          <div class="txt"><b>اوبو</b><span>LCD</span></div>
        </div>
        <div class="cat" onclick="filterLCDCategory(10, 'فيفو')">
          <div class="ic"><i class="fas fa-mobile-alt"></i></div>
          <div class="txt"><b>فيفو</b><span>LCD</span></div>
        </div>
        <div class="cat" onclick="filterLCDCategory(11, 'ايتل')">
          <div class="ic"><i class="fas fa-mobile-alt"></i></div>
          <div class="txt"><b>ايتل</b><span>LCD</span></div>
        </div>
        <div class="cat" onclick="filterLCDCategory(12, 'TCL')">
          <div class="ic"><i class="fas fa-mobile-alt"></i></div>
          <div class="txt"><b>TCL</b><span>LCD</span></div>
        </div>
        <div class="cat" onclick="filterLCDCategory(13, 'لينوفو')">
          <div class="ic"><i class="fas fa-mobile-alt"></i></div>
          <div class="txt"><b>لينوفو</b><span>LCD</span></div>
        </div>
        <div class="cat" onclick="filterLCDCategory(14, 'بلاك فيو')">
          <div class="ic"><i class="fas fa-mobile-alt"></i></div>
          <div class="txt"><b>بلاك فيو</b><span>LCD</span></div>
        </div>
        <div class="cat" onclick="filterLCDCategory(15, 'هايسنس')">
          <div class="ic"><i class="fas fa-mobile-alt"></i></div>
          <div class="txt"><b>هايسنس</b><span>LCD</span></div>
        </div>
        <div class="cat" onclick="filterLCDCategory(16, 'موتورلا')">
          <div class="ic"><i class="fas fa-mobile-alt"></i></div>
          <div class="txt"><b>موتورلا</b><span>LCD</span></div>
        </div>
        <div class="cat" onclick="filterLCDCategory(17, 'ZTE')">
          <div class="ic"><i class="fas fa-mobile-alt"></i></div>
          <div class="txt"><b>ZTE</b><span>LCD</span></div>
        </div>
        <div class="cat" onclick="filterLCDCategory(18, 'ALCATEL')">
          <div class="ic"><i class="fas fa-mobile-alt"></i></div>
          <div class="txt"><b>ALCATEL</b><span>LCD</span></div>
        </div>

        <!-- other sheets -->
        <div class="cat" onclick="filterHousingCategory()">
          <div class="ic"><i class="fas fa-tools"></i></div>
          <div class="txt"><b>شواصي</b><span>HOUSING</span></div>
        </div>
        <div class="cat" onclick="filterBatteryCategory()">
          <div class="ic"><i class="fas fa-battery-full"></i></div>
          <div class="txt"><b>بطاريات</b><span>BATTERY</span></div>
        </div>
        <div class="cat" onclick="filterBackCategory()">
          <div class="ic"><i class="fas fa-camera"></i></div>
          <div class="txt"><b>اظهر</b><span>BACK</span></div>
        </div>
        <div class="cat" onclick="filterCameraCategory()">
          <div class="ic"><i class="fas fa-camera"></i></div>
          <div class="txt"><b>كاميرات</b><span>CAMERA</span></div>
        </div>
        <div class="cat" onclick="filterChargingCategory()">
          <div class="ic"><i class="fas fa-charging-station"></i></div>
          <div class="txt"><b>بورد شحن</b><span>CHARGING</span></div>
        </div>
        <div class="cat" onclick="filterBuzzerCategory()">
          <div class="ic"><i class="fas fa-bell"></i></div>
          <div class="txt"><b>جرس</b><span>BUZZER</span></div>
        </div>
        <div class="cat" onclick="filterFingerCategory()">
          <div class="ic"><i class="fas fa-fingerprint"></i></div>
          <div class="txt"><b>بصمة</b><span>FINGER</span></div>
        </div>

        <!-- (مثل كودك القديم: سماعة/اخرى نفس الفنكشن) -->
        <div class="cat" onclick="filterFingerCategory()">
          <div class="ic"><i class="fas fa-volume-up"></i></div>
          <div class="txt"><b>سماعة</b><span>FINGER</span></div>
        </div>
        <div class="cat" onclick="filterFingerCategory()">
          <div class="ic"><i class="fas fa-bars"></i></div>
          <div class="txt"><b>اخرى</b><span>FINGER</span></div>
        </div>
      </div>
    </section>

    <section id="resultsWrap" class="panel results-wrap animate__animated animate__fadeInUp" style="animation-delay:.12s;">
      <div class="results-head">
        <b id="resultsTitle">النتائج</b>
        <span id="resultsCount">—</span>
      </div>
      <div id="results"></div>
    </section>
  </main>

  <div id="scrollToTop" class="scroll-to-top" onclick="scrollToTop()">
    <i class="fas fa-arrow-up"></i>
  </div>

  <footer>
  <span><i class="fa-solid fa-crown"></i> مكتب عسل • جميع الحقوق محفوظة © 2025</span>
</footer>



  <script>
    const dropboxMainFileBase =
      "https://docs.google.com/spreadsheets/d/e/2PACX-1vSZww_ZDcqXnX6pUjlKccZdFUkRR9Z_JmfmdvNsnGVYT_rq_RTsSB1ydTy6QVrrS_o4s_ml1DNBTnaQ/pub?output=xlsx&t=";

    let database = {};

    function getDropboxMainFile() {
      return dropboxMainFileBase + Date.now();
    }

async function loadExcelFiles() {
  try {
    const mainResponse = await fetch(getDropboxMainFile());
    if (!mainResponse.ok) throw new Error("Failed to fetch Excel file");

    const mainBuffer = await mainResponse.arrayBuffer();
    const mainWorkbook = XLSX.read(mainBuffer, { type: "array" });

    database.LCD = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["LCD"] || {});
    database.HOUSING = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["HOUSING"] || {});
    database.BATTERY = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["BATTERY"] || {});
    database.BACK = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["BACK"] || {});
    database.CAMERA = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["CAMERA"] || {});
    database.CHARGING = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["CHARGING"] || {});
    database.BUZZER = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["BUZZER"] || {});
    database.FINGER = XLSX.utils.sheet_to_json(mainWorkbook.Sheets["FINGER"] || {});

    console.log("Excel files loaded successfully");
    return true;
  } catch (error) {
    console.error("Error loading Excel files:", error);
    throw error;
  }
}


    function formatPrice(p) {
      if (p === undefined || p === null) return "غير متوفر";
      const s = p.toString();
      if (s.trim() === "" || s === "غير متوفر") return "غير متوفر";
      const num = Number(s);
      if (Number.isNaN(num)) return s;
      return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") + " دينار";
    }
    
    
    let __resultsOpenedOnce = false;

function scrollToResultsWrapStable() {
  const resultsWrap = document.getElementById("resultsWrap");
  const headerOffset = 72;
  const y = resultsWrap.getBoundingClientRect().top + window.pageYOffset - headerOffset - 8;
  window.scrollTo({ top: y, behavior: "smooth" });
}



    
    

async function displayResults(items, title) {
  const resultsWrap = document.getElementById("resultsWrap");
  const resultsContainer = document.getElementById("results");
  const resultsTitle = document.getElementById("resultsTitle");
  const resultsCount = document.getElementById("resultsCount");
  const scrollToTopBtn = document.getElementById("scrollToTop");

  resultsContainer.innerHTML = "";

  resultsTitle.textContent = "نتائج: " + title;
  resultsCount.textContent = items.length ? (items.length + " عنصر") : "0 عنصر";

  // ✅ أول مرة: نوقف fadeInUp اللي يسبب jump
  if (!__resultsOpenedOnce) {
    resultsWrap.classList.add("no-jump");
  }

  resultsWrap.style.display = "block";

  if (items.length === 0) {
    resultsContainer.innerHTML = `<div class="no-results">لا توجد بيانات لـ ${title} حالياً</div>`;
    scrollToTopBtn.style.display = "none";

    // ✅ سكرول ثابت
    setTimeout(() => {
      scrollToResultsWrapStable();

      // ✅ بعد ما ثبتنا السكرول: نرجع أنيميشن آمن
      if (!__resultsOpenedOnce) {
        resultsWrap.classList.remove("no-jump");
        resultsWrap.classList.add("safe-reveal");
        __resultsOpenedOnce = true;
      }
    }, 30);

    return;
  }

  items.sort((a, b) => {
    return (a["Item Name"] || a["Item"]).localeCompare(b["Item Name"] || b["Item"], "en");
  });

  items.sort((a, b) => {
    const baseNameA = (a["Item Name"] || a["Item"]).split("(")[0].trim();
    const baseNameB = (b["Item Name"] || b["Item"]).split("(")[0].trim();
    const priceA = parseFloat(a["Price"]) || 0;
    const priceB = parseFloat(b["Price"]) || 0;

    if (baseNameA === baseNameB) return priceB - priceA;
    return 0;
  });

  let htmlContent = "";
  items.forEach((item) => {
    htmlContent += `
      <div class="result-card">
        <img src="images/lcd.png" alt="Image">
        <div class="meta">
          <div class="item-name">${item["Item Name"] ?? item["Item"] ?? ""}</div>
          <div class="price">${formatPrice(item["Price"])}</div>
        </div>
      </div>
    `;
  });

  resultsContainer.innerHTML = htmlContent;
  scrollToTopBtn.style.display = "none";

  setTimeout(() => {
    scrollToResultsWrapStable();

    // ✅ بعد أول سكرول صحيح: نشيل no-jump ونشغل أنيميشن آمن
    if (!__resultsOpenedOnce) {
      resultsWrap.classList.remove("no-jump");
      resultsWrap.classList.add("safe-reveal");
      __resultsOpenedOnce = true;
    }
  }, 30);
}


    async function filterLCDCategory(categoryNumber, categoryName) {
      if (!database.LCD) {
        Swal.fire({
          icon: "warning",
          title: "تحذير",
          text: "البيانات لم يتم تحميلها بعد، اضغط تحديث!",
          background: "linear-gradient(135deg, rgba(26, 58, 71, 0.9), rgba(10, 21, 26, 0.9))",
          color: "#fff",
        });
        return;
      }
      const filteredItems = database.LCD.filter((item) => item["الصنف"] == categoryNumber);
      await displayResults(filteredItems, categoryName);
    }

    async function filterHousingCategory() {
      if (!database.HOUSING) return;
      await displayResults(database.HOUSING, "شواصي");
    }

    async function filterBatteryCategory() {
      if (!database.BATTERY) return;
      await displayResults(database.BATTERY, "بطاريات");
    }

    async function filterBackCategory() {
      if (!database.BACK) return;
      await displayResults(
        database.BACK.map((item) => ({
          "Item Name": item["Item Name"],
          "Price": item["Price"] ? item["Price"] : "غير متوفر",
        })),
        "اظهر"
      );
    }

    async function filterCameraCategory() {
      if (!database.CAMERA) return;
      await displayResults(
        database.CAMERA.map((item) => ({
          "Item Name": item["Item Name"],
          "Price": item["Price"] ? item["Price"] : "غير متوفر",
        })),
        "كاميرات"
      );
    }

    async function filterChargingCategory() {
      if (!database.CHARGING) return;
      await displayResults(
        database.CHARGING.map((item) => ({
          "Item Name": item["Item Name"],
          "Price": item["Price"] ? item["Price"] : "غير متوفر",
        })),
        "بورد شحن"
      );
    }

    async function filterBuzzerCategory() {
      if (!database.BUZZER) return;
      await displayResults(
        database.BUZZER.map((item) => ({
          "Item Name": item["Item Name"],
          "Price": item["Price"] ? item["Price"] : "غير متوفر",
        })),
        "جرس"
      );
    }

    async function filterFingerCategory() {
      if (!database.FINGER) return;
      await displayResults(
        database.FINGER.map((item) => ({
          "Item Name": item["Item Name"],
          "Price": item["Price"] ? item["Price"] : "غير متوفر",
        })),
        "بصمة"
      );
    }

const LOADING_MIN_MS = 6500; // ✅ زيد وقت نافذة التحميل (مثلاً 6.5 ث)
const SUCCESS_MS     = 3200; // ✅ زيد وقت نافذة النجاح (مثلاً 3.2 ث)

function delay(ms){ return new Promise(r => setTimeout(r, ms)); }

function openGlobalTechLoading(){
  Swal.fire({
    title: "تحديث البيانات",
    html: `
      <div class="gt-wrap">
        <div class="gt-scan"></div>

        <div class="gt-row">
          <div class="gt-logo"><img src="images/logo.png" alt="logo"></div>

          <div class="gt-text">
            <div class="a">جاري التحميل والمزامنة…</div>
            <div class="b" id="gtSub">Downloading workbook</div>
          </div>

          <div class="gt-loader">
            <div class="gt-ring"></div>
            <div class="gt-core"></div>
          </div>
        </div>

        <div class="gt-bar"><i></i></div>
      </div>
    `,
    showConfirmButton: false,
    allowOutsideClick: false,
    allowEscapeKey: false,
    heightAuto: false,               // ✅ يقلل مشاكل الارتفاع/السكرول
    scrollbarPadding: false,         // ✅ يمنع أي حركات padding
    customClass: {
      popup: "gt-popup",
      title: "gt-title",
      htmlContainer: "gt-html",
    }
  });
}

function setGlobalTechSub(t){
  const el = document.getElementById("gtSub");
  if (el) el.textContent = t;
}

function openGlobalTechSuccess(){
  Swal.fire({
    title: "تم التحديث",
    html: `
      <div class="gt-wrap">
        <div class="gt-scan"></div>

        <div class="gt-success">
          <div class="gt-badge">
            <svg viewBox="0 0 52 52" aria-hidden="true">
              <path d="M14 27 L23 35 L38 17"></path>
            </svg>
          </div>
          <div style="min-width:0;">
            <div style="color: rgba(240,246,255,.88); font-size:13.7px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">
              مزامنة مكتملة ✅
            </div>
            <div style="color: rgba(240,246,255,.62); font-size:12.3px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; margin-top:2px;">
              سيتم تحديث الواجهة خلال لحظات…
            </div>
          </div>
        </div>
      </div>
    `,
    showConfirmButton: false,
    timer: SUCCESS_MS,
    allowOutsideClick: false,
    allowEscapeKey: false,
    heightAuto: false,
    scrollbarPadding: false,
    customClass: {
      popup: "gt-popup",
      title: "gt-title",
      htmlContainer: "gt-html",
    },
    willClose: () => window.location.reload(true) // إذا تريد بدون Reload قولي وخليه false
  });
}

function openGlobalTechError(){
  Swal.fire({
    icon: "error",
    title: "فشل التحميل",
    text: "تعذّر تحميل البيانات… جرّب مرة ثانية.",
    confirmButtonText: "حاضر",
    heightAuto: false,
    scrollbarPadding: false,
    customClass: {
      popup: "gt-popup",
      title: "gt-title",
      htmlContainer: "gt-html",
      confirmButton: "holo-btn"
    }
  });
}

async function refreshData(){
  const start = Date.now();
  try{
    openGlobalTechLoading();       // ✅ بدون await حتى ما يعلگ
    setGlobalTechSub("Downloading workbook…");

    await loadExcelFiles();

    setGlobalTechSub("Parsing sheets…");

    // ✅ يضمن إن نافذة التحميل تبقى مدة أطول حتى لو التحميل سريع
    const elapsed = Date.now() - start;
    if (elapsed < LOADING_MIN_MS) await delay(LOADING_MIN_MS - elapsed);

    Swal.close();
    openGlobalTechSuccess();
  } catch(e){
    Swal.close();
    openGlobalTechError();
  }
}


    function goBack() {
      window.location.href = "index.html";
    }

    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    window.addEventListener("scroll", () => {
      const scrollToTopBtn = document.getElementById("scrollToTop");
      const resultsWrap = document.getElementById("resultsWrap");
      const isResultsVisible = resultsWrap && resultsWrap.style.display === "block";
      if (isResultsVisible && window.scrollY > 120) {
        scrollToTopBtn.style.display = "flex";
      } else {
        scrollToTopBtn.style.display = "none";
      }
    });

    loadExcelFiles();
    
    
    
    (function lockCopy() {
  const block = (e) => { e.preventDefault(); e.stopPropagation(); return false; };

  // منع النسخ/القص/اللصق + تحديد + كليك يمين + سحب
  ['copy','cut','paste','contextmenu','selectstart','dragstart'].forEach(ev => {
    document.addEventListener(ev, block, true);
  });

  // منع اختصارات لوحة المفاتيح
  document.addEventListener('keydown', (e) => {
    const k = (e.key || '').toLowerCase();

    // Ctrl + ...
    if (e.ctrlKey && ['c','x','v','a','s','u','p'].includes(k)) {
      e.preventDefault();
      e.stopPropagation();
      return false;
    }

    // F12 / DevTools shortcuts
    if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && ['i','j','c'].includes(k))) {
      e.preventDefault();
      e.stopPropagation();
      return false;
    }
  }, true);

  // منع long-press على الموبايل (بعض WebView)
  document.addEventListener('touchstart', (e) => {}, {passive: true});
})();
    
    
  </script>
</body>
</html>
